{
  "version": 3,
  "sources": ["angular:jit:template:src/components/sign-in-popup/sign-in-popup.html", "angular:jit:style:src/components/sign-in-popup/sign-in-popup.css", "src/components/sign-in-popup/sign-in-popup.ts"],
  "sourcesContent": ["<div class=\"backdrop\" (click)=\"closePopup()\" [class.mobile]=\"responsive.screen() === 'mobile'\"\n  [class.tablet]=\"responsive.screen() === 'tablet'\" [class.desktop]=\"responsive.screen() === 'desktop'\"></div>\n\n<div class=\"popup-container\" [class.mobile]=\"responsive.screen() === 'mobile'\"\n  [class.tablet]=\"responsive.screen() === 'tablet'\" [class.desktop]=\"responsive.screen() === 'desktop'\">\n\n  <div class=\"mobile-popup-container\">\n    <div class=\"mobile-header\">\n      <mat-icon (click)=\"closePopup()\">arrow_back</mat-icon>\n      <h1>Sign In</h1>\n    </div>\n\n    <div class=\"centered-content\">\n      <div class=\"popup-content\">\n        <button class=\"close-btn close\" (click)=\"closePopup()\">\n          <mat-icon>close</mat-icon>\n        </button>\n\n        <div class=\"header\">\n          <h1>Welcome back!</h1>\n          @if(generalError) { <p class=\"error\">{{ generalError }}</p> }\n          @else if(errors['email']) { <p class=\"error\">{{ errors['email'] }}</p> }\n          @else if(errors['password']) { <p class=\"error\">{{ errors['password'] }}</p> }\n          @else if(infoMessage) { <p class=\"info\">{{ infoMessage }}</p> }\n          @else{<p>Sign in to LUMO</p>}\n        </div>\n\n        <form class=\"form\" [formGroup]=\"form\" (ngSubmit)=\"onSubmit()\">\n          <FormField [error]=\"hasError('email')\" [control]=\"form.get('email')!\" placeholder=\"Email\" [type]=\"'text'\"\n            [title]=\"'Email'\"></FormField>\n          <FormField [error]=\"hasError('password')\" [control]=\"form.get('password')!\" placeholder=\"Password\"\n            [type]=\"'password'\" [title]=\"'Password'\" [showToggle]=\"true\"></FormField>\n          <p>\n            <button type=\"button\" class=\"click-text text-link\" (click)=\"onForgotPassword()\">Forgot password?</button>\n          </p>\n          <button type=\"submit\" class=\"button\">Sign In</button>\n        </form>\n\n        <div class=\"other-sign-up-methods\">\n          <p>or sign in with</p>\n          <a class=\"button generic\" (click)=\"signInWithGoogle()\">\n            <img class=\"google-logo\" src=\"assets/img/google-logo.webp\" height=\"20\" />\n          </a>\n        </div>\n\n        <p>\n          Don\u2019t have an account?\n          <span class=\"click-text\" (click)=\"goToSignUp()\">Sign Up</span>\n        </p>\n      </div>\n    </div>\n  </div>\n</div>\n", "/* src/components/sign-in-popup/sign-in-popup.css */\n.backdrop {\n  position: fixed;\n  inset: 0;\n  background: var(--modal-backdrop-color);\n  -webkit-backdrop-filter: blur(var(--modal-backdrop-blur));\n  backdrop-filter: blur(var(--modal-backdrop-blur));\n  z-index: var(--z-backdrop);\n}\n.popup-container.desktop {\n  position: fixed;\n  inset: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: var(--z-popup);\n}\n.popup-container.desktop .popup-content {\n  position: relative;\n  align-items: center;\n  width: 30%;\n  height: auto;\n  background: var(--modal-surface);\n  border-radius: var(--modal-radius);\n  padding: var(--spacing-2xl) 5%;\n  border: var(--modal-border);\n  display: flex;\n  flex-direction: column;\n  gap: var(--spacing-lg);\n}\n.popup-container.tablet,\n.popup-container.mobile {\n  position: fixed;\n  inset: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 100vw;\n  height: 100vh;\n  z-index: var(--z-popup);\n}\n.popup-container.tablet .popup-content,\n.popup-container.mobile .popup-content {\n  position: fixed;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-direction: column;\n  padding: var(--spacing-2xl);\n  height: 100%;\n  width: 100%;\n  background: var(--modal-surface);\n  border-radius: 0;\n  overflow-y: auto;\n  gap: var(--spacing-lg);\n  border: none;\n}\n.popup-container.mobile .mobile-popup-container,\n.popup-container.tablet .mobile-popup-container {\n  background-color: transparent;\n}\n.form {\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  gap: var(--spacing-lg);\n}\n.form * {\n  text-align: right;\n  width: 100%;\n}\n.text-link {\n  background: transparent;\n  border: none;\n  padding: 0;\n  font: inherit;\n}\n.close-btn {\n  background: none;\n  border: none;\n  color: #fff;\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.close-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n}\n.close {\n  position: absolute;\n  top: 20px;\n  right: 20px;\n}\n.header {\n  text-align: center;\n}\n.google-logo {\n  height: 20px;\n}\n.other-sign-up-methods {\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: var(--spacing-lg);\n}\n.other-sign-up-methods > * {\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: var(--spacing-lg);\n}\n.form-field.error {\n  border: 2px solid var(--color-error);\n}\n.error {\n  color: var(--color-error);\n}\n.info {\n  color: var(--color-accent);\n}\n.mobile-back,\n.mobile-header {\n  display: none;\n}\n.popup-container.mobile .mobile-header,\n.popup-container.tablet .mobile-header {\n  background-color: transparent;\n}\n@media (max-width: 767px) {\n  .popup-container.desktop {\n    display: none;\n  }\n  .popup-container.tablet,\n  .popup-container.mobile {\n    display: flex;\n  }\n  .popup-content {\n    padding: var(--spacing-2xl) var(--spacing-xl);\n    justify-content: flex-start;\n    align-items: center;\n    padding-top: 0;\n  }\n  .header h1 {\n    font-size: 32px;\n  }\n  .header p {\n    font-size: 18px;\n  }\n  .form {\n    gap: var(--spacing-xl);\n  }\n  .form button.button {\n    height: 60px;\n    font-size: 20px;\n    border-radius: var(--radius-lg);\n  }\n  .close,\n  .desktop-header,\n  .mobile-back {\n    display: none;\n  }\n  .mobile-header {\n    display: flex;\n  }\n}\n/*# sourceMappingURL=sign-in-popup.css.map */\n", "import { Component, EventEmitter, Output } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { ResponsiveService } from '../../services/responsive-service';\nimport { FormField } from '../form-field/form-field';\nimport { emailFormatValidator, strongPasswordValidator } from '../../validators/validators';\nimport { FormBuilder } from '@angular/forms';\nimport { AuthService } from '../../services/auth.service';\nimport { GoogleIdentityService } from '../../services/google-identity.service';\nimport { MatIconModule } from '@angular/material/icon';\nimport { CommonModule } from '@angular/common';\nimport { ReactiveFormsModule } from '@angular/forms';\n\n@Component({\n  selector: 'SignInPopup',\n  standalone: true,\n  imports: [FormField, MatIconModule, CommonModule, ReactiveFormsModule],\n  templateUrl: './sign-in-popup.html',\n  styleUrls: ['./sign-in-popup.css'],\n})\nexport class SignInPopup {\n  @Output() close = new EventEmitter<void>();\n  @Output() switchToSignUp = new EventEmitter<void>();\n  @Output() signInSuccess = new EventEmitter<{ id: string; name: string; email: string; profileImage?: string }>();\n\n  form: any;\n  errors: { [key: string]: string } = {};\n  generalError: string | null = null;\n  infoMessage: string | null = null;\n\n  constructor(\n    private fb: FormBuilder,\n    private auth: AuthService,\n    private googleIdentity: GoogleIdentityService,\n    private router: Router,\n    public responsive: ResponsiveService\n  ) {\n    this.form = this.fb.group({\n      email: ['', [emailFormatValidator]],\n      password: ['', [strongPasswordValidator]]\n    });\n  };\n\n  closePopup() {\n    this.close.emit();\n  }\n  goToSignUp() {\n    this.switchToSignUp.emit();\n  }\n\n  onSubmit() {\n    this.errors = {};\n    this.generalError = null;\n    this.infoMessage = null;\n\n    const controls = this.form.controls;\n\n    const emailErr = emailFormatValidator(controls['email']);\n    if (emailErr) this.errors['email'] = 'Email non valida.';\n\n    const passwordErr = strongPasswordValidator(controls['password']);\n    if (passwordErr) this.errors['password'] =\n      'La password deve avere almeno 8 caratteri, una maiuscola, un numero e un simbolo.';\n\n    if (Object.keys(this.errors).length > 0) return;\n\n    const payload = {\n      email: this.form.value.email,\n      password: this.form.value.password\n    };\n\n    this.auth.login(payload).subscribe({\n      next: (res) => {\n        this.errors = {};\n        this.generalError = null;\n        this.signInSuccess.emit({\n          id: res?.data?.id || '',\n          name: res?.data?.name || '',\n          email: res?.data?.email || payload.email,\n          profileImage: res?.data?.profileImage\n        });\n        localStorage.setItem('user', JSON.stringify({\n          id: res?.data?.id || '',\n          name: res?.data?.name || '',\n          email: res?.data?.email || payload.email,\n          profileImage: res?.data?.profileImage,\n          isAdmin: res?.data?.isAdmin\n        }));\n\n        if (res?.data?.isAdmin === 'true') {\n          this.router.navigate(['/admin']);\n        }\n\n        this.closePopup();\n      },\n      error: (err) => {\n        this.errors = {};\n        this.generalError = null;\n\n        if (err && typeof err === 'object' && 'error' in err) {\n          const body = err.error;\n\n          if (body && typeof body === 'object') {\n            if (body.data && typeof body.data === 'object') {\n              this.errors = body.data;\n              return;\n            }\n            if (body.error && typeof body.error === 'string') {\n              this.generalError = body.error;\n              return;\n            }\n          }\n\n          if (typeof err.error === 'string') {\n            this.generalError = err.error;\n            return;\n          }\n        }\n\n        if (typeof err === 'string') {\n          this.generalError = err;\n          return;\n        }\n\n        this.generalError = 'Unexpected error.';\n        console.warn('Unhandled error shape', err);\n      }\n    });\n  }\n\n  onForgotPassword() {\n    this.errors = {};\n    this.generalError = null;\n    this.infoMessage = null;\n\n    const controls = this.form.controls;\n    const emailErr = emailFormatValidator(controls['email']);\n    if (emailErr) {\n      this.errors['email'] = 'Email non valida.';\n      return;\n    }\n\n    const payload = { email: this.form.value.email };\n    this.auth.requestPasswordReset(payload).subscribe({\n      next: () => {\n        this.infoMessage = 'If the email exists, a reset link has been sent.';\n      },\n      error: (err) => {\n        const body = err?.error;\n        if (body?.data && typeof body.data === 'object') {\n          this.errors = body.data;\n          return;\n        }\n        if (typeof body?.error === 'string') {\n          this.generalError = body.error;\n          return;\n        }\n        if (typeof err?.error === 'string') {\n          this.generalError = err.error;\n          return;\n        }\n        if (typeof err === 'string') {\n          this.generalError = err;\n          return;\n        }\n        this.generalError = 'Unable to send reset email.';\n      }\n    });\n  }\n\n  async signInWithGoogle() {\n    this.errors = {};\n    this.generalError = null;\n    this.infoMessage = null;\n\n    try {\n      const code = await this.googleIdentity.getAuthCode();\n      this.auth.loginWithGoogleCode({ code }).subscribe({\n        next: (res) => {\n          this.signInSuccess.emit({\n            id: res?.data?.id || '',\n            name: res?.data?.name || '',\n            email: res?.data?.email || '',\n            profileImage: res?.data?.profileImage\n          });\n          localStorage.setItem('user', JSON.stringify(res.data));\n\n          if (res?.data?.isAdmin === 'true') {\n            this.router.navigate(['/admin']);\n          }\n\n          this.closePopup();\n        },\n        error: (err) => {\n          const body = err?.error;\n          if (body?.data && typeof body.data === 'object') {\n            this.errors = body.data;\n            return;\n          }\n          if (typeof body?.error === 'string') {\n            this.generalError = body.error;\n            return;\n          }\n          this.generalError = 'Google sign-in failed.';\n        }\n      });\n    } catch (e: any) {\n      if (e?.code === 'google_cancelled') {\n        return;\n      }\n      this.generalError = e?.message || 'Google sign-in failed.';\n    }\n  }\n\n  hasError(field: string): boolean {\n    return !!this.errors[field];\n  }\n}\n"],
  "mappings": "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",
  "names": ["sign_in_popup_default", "init_sign_in_popup", "SignInPopup"]
}
