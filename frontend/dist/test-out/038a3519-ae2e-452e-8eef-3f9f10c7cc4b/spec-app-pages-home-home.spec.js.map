{
  "version": 3,
  "sources": ["angular:jit:template:src/app/pages/home/home.html", "angular:jit:style:src/app/pages/home/home.css", "angular:jit:template:src/components/action-bar/action-bar.html", "angular:jit:style:src/components/action-bar/action-bar.css", "angular:jit:template:src/components/user-menu/user-menu.html", "angular:jit:style:src/components/user-menu/user-menu.css", "src/components/user-menu/user-menu.ts", "angular:jit:template:src/components/notification-menu/notification-menu.html", "angular:jit:style:src/components/notification-menu/notification-menu.css", "src/services/notification.service.ts", "src/components/notification-menu/notification-menu.ts", "angular:jit:template:src/components/my-events-modal/my-events-modal.html", "angular:jit:style:src/components/my-events-modal/my-events-modal.css", "angular:jit:template:src/components/event-chat-modal/event-chat-modal.html", "angular:jit:style:src/components/event-chat-modal/event-chat-modal.css", "src/services/chat.service.ts", "src/components/event-chat-modal/event-chat-modal.ts", "src/components/my-events-modal/my-events-modal.component.ts", "angular:jit:template:src/components/account-modal/account-modal.html", "angular:jit:style:src/components/account-modal/account-modal.css", "src/components/account-modal/account-modal.component.ts", "src/components/action-bar/action-bar.ts", "angular:jit:template:src/components/crop-image-popup/crop-image-popup.html", "angular:jit:style:src/components/crop-image-popup/crop-image-popup.css", "src/components/crop-image-popup/crop-image-popup.ts", "angular:jit:template:src/components/create-event-popup/create-event-popup.html", "angular:jit:style:src/components/create-event-popup/create-event-popup.css", "src/components/create-event-popup/create-event-popup.ts", "angular:jit:template:src/components/event-popup-card/event-popup-card.html", "angular:jit:style:src/components/event-popup-card/event-popup-card.css", "angular:jit:template:src/components/report-modal/report-modal.component.html", "angular:jit:style:src/components/report-modal/report-modal.component.css", "src/services/report.service.ts", "src/components/report-modal/report-modal.component.ts", "src/components/event-popup-card/event-popup-card.ts", "angular:jit:template:src/components/map-location-selector/map-location-selector.html", "angular:jit:style:src/components/map-location-selector/map-location-selector.css", "src/components/map-location-selector/map-location-selector.ts", "angular:jit:template:src/components/user-profile-modal/user-profile-modal.html", "angular:jit:style:src/components/user-profile-modal/user-profile-modal.css", "src/components/user-profile-modal/user-profile-modal.component.ts", "src/app/pages/home/home.ts", "src/app/pages/home/home.spec.ts"],
  "sourcesContent": ["<div class=\"home-container\">\n  @if (!loggedUser) {\n  <div class=\"top-bar\">\n    <a class=\"button\" (click)=\"openSignUp()\">Sign Up</a>\n    <a class=\"button\" (click)=\"openSignIn()\">Sign In</a>\n  </div>\n  } @else {\n  <app-action-bar [loggedUser]=\"loggedUser\" (action)=\"onMenuAction($event)\" (openProfile)=\"openUserProfile($event)\"\n    (openChatFromNotification)=\"onChatNotification($event)\"\n    (openEventFromNotification)=\"onUpcomingEventNotification($event)\"\n    (focusEvent)=\"onFocusEventFromMenu($event)\"></app-action-bar>\n\n  <!-- Hidden input for file selection triggered by menu -->\n  <input id=\"hiddenFileInput\" type=\"file\" (change)=\"onFileSelected($event)\" style=\"display: none\" accept=\"image/*\">\n  }\n\n  @if (showSignUp) {\n  <SignUpPopup (switchToSignIn)=\"switchToSignIn()\" (close)=\"closeAll()\"\n    (signUpSuccess)=\"openVerifyPopup($event.email, $event.token)\" (signInSuccess)=\"onSignInSuccess($event)\" />\n  }\n\n  @if (showVerifyPopup) {\n  <VerifyEmailPopup [email]=\"recentEmail\" [token]=\"recentToken\" [verified]=\"emailVerified\" (close)=\"closeAll()\"\n    (resendVerification)=\"resendEmail()\" />\n  }\n\n  @if (showSignIn) {\n  <SignInPopup (switchToSignUp)=\"switchToSignUp()\" (close)=\"closeAll()\" (signInSuccess)=\"onSignInSuccess($event)\" />\n  }\n\n  @if (showUserProfile) {\n  <app-user-profile-modal [userId]=\"selectedUserProfileId\"\n    [currentUserId]=\"loggedUser ? (loggedUser.id.toString()) : null\" (close)=\"closeAll()\"\n    (openProfile)=\"openUserProfile($event)\" (focusEvent)=\"onFocusEventFromProfile($event)\"></app-user-profile-modal>\n  }\n\n  <map-view [userId]=\"loggedUser ? loggedUser.id || '' : null\" (eventSelected)=\"openEventPopup($event)\"\n    (mapInteract)=\"closeEventPopup()\" (requestLogin)=\"openSignIn()\" (eventsUpdated)=\"onEventsUpdated($event)\"\n    (openUserProfile)=\"openUserProfile($event)\">\n  </map-view>\n\n  @if (showCropPopup && selectedImageFile) {\n  <CropImagePopup [imageFile]=\"selectedImageFile\" (close)=\"showCropPopup = false\"\n    (imageCropped)=\"onImageCropped($event)\">\n  </CropImagePopup>\n  }\n\n  @if (showCreateEventPopup) {\n  <create-event-popup #createEventPopup [style.display]=\"showLocationSelector ? 'none' : 'block'\"\n    (close)=\"showCreateEventPopup = false\" (eventCreated)=\"closeAll()\"\n    (openLocationSelector)=\"createEventPopupRef = createEventPopup; openLocationSelector()\">\n  </create-event-popup>\n  }\n\n  @if (showLocationSelector) {\n  <map-location-selector (locationSelected)=\"onLocationSelected($event)\" (close)=\"showLocationSelector = false\">\n  </map-location-selector>\n  }\n\n  @if (selectedEvent) {\n  <event-popup-card [event]=\"selectedEvent\" [eventPosition]=\"eventScreenPosition || undefined\"\n    (close)=\"closeEventPopup()\" (participate)=\"onParticipate($event)\" (toggleFavorite)=\"onToggleFavorite()\"\n    [organizerName]=\"selectedEvent.organizerName || ''\" [organizerImage]=\"selectedEvent.organizerImage\"\n    [currentUserId]=\"loggedUser ? (loggedUser.id ? loggedUser.id.toString() : null) : null\"\n    [creatorId]=\"selectedEvent.creatorId\" (openOrganizerProfile)=\"openUserProfile($event)\"\n    (leave)=\"onLeaveEvent($event)\" (deleteEvent)=\"onDeleteEvent($event)\" (shareEvent)=\"openShare($event)\"\n    (openChat)=\"openChat($event)\" />\n  }\n\n  @if (showChatModal && chatEvent) {\n  <event-chat-modal [event]=\"chatEvent\" [currentUserId]=\"loggedUser?.id?.toString() || null\" (close)=\"closeChat()\">\n  </event-chat-modal>\n  }\n</div>\n", "/* src/app/pages/home/home.css */\n.top-bar {\n  display: flex;\n  flex-direction: row;\n  position: absolute;\n  top: 20px;\n  right: 20px;\n  gap: 8px;\n  z-index: 1000;\n  background: var(--color-dark-gray);\n  padding: 8px;\n  border-radius: 16px;\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);\n  box-sizing: border-box;\n  border: 1px solid var(--color-light-gray);\n  align-items: center;\n}\n@media (max-width: 768px) {\n  .top-bar {\n    top: 20px;\n    bottom: auto;\n    right: auto;\n    left: 50%;\n    transform: translateX(-50%);\n    width: 90%;\n    justify-content: center;\n    background: rgba(26, 26, 26, 0.95);\n    -webkit-backdrop-filter: blur(10px);\n    backdrop-filter: blur(10px);\n  }\n  .top-bar .button {\n    flex: 1;\n    font-size: 14px;\n    height: 44px;\n  }\n}\n/*# sourceMappingURL=home.css.map */\n", "<div class=\"action-bar\">\n    <button class=\"add-event-btn button\" (click)=\"onAddEvent()\">Add Event</button>\n\n    <div class=\"icon-circle notification-icon\" (click)=\"toggleNotifications($event)\">\n        <mat-icon>notifications</mat-icon>\n        @if (hasUnread) {\n        <span class=\"unread-indicator\"></span>\n        }\n        @if (showNotifications) {\n        <notification-menu [userId]=\"loggedUser?.id || 0\" (click)=\"$event.stopPropagation()\"\n            (openChat)=\"onOpenChatFromNotification($event)\" (openEvent)=\"onOpenEventFromNotification($event)\"\n            (close)=\"showNotifications = false\"></notification-menu>\n        }\n    </div>\n\n    <div class=\"profile-trigger\" (click)=\"toggleUserMenu($event)\">\n        @if (loggedUser?.profileImage) {\n        <img [src]=\"loggedUser?.profileImage\" alt=\"Profile\" class=\"profile-image\">\n        } @else {\n        <div class=\"profile-placeholder\">{{ getInitials(loggedUser?.name || loggedUser?.email || '') }}</div>\n        }\n        @if (showUserMenu) {\n        <UserMenu (click)=\"$event.stopPropagation()\" (close)=\"showUserMenu = false\" (action)=\"onMenuAction($event)\">\n        </UserMenu>\n        }\n\n    </div>\n\n</div>\n\n@if (showMyEventsModal) {\n<app-my-events-modal [userId]=\"loggedUser?.id || 0\" (close)=\"showMyEventsModal = false\"\n    (focusLocal)=\"onFocusEvent($event)\"></app-my-events-modal>\n}\n\n@if (showAccountModal) {\n<app-account-modal [user]=\"loggedUser\" (close)=\"showAccountModal = false\" (changePhoto)=\"onChangePhotoFromAccount()\"\n    (openProfile)=\"onOpenProfileFromAccount($event)\">\n</app-account-modal>\n}\n", "/* src/components/action-bar/action-bar.css */\n.action-bar {\n  height: 72px;\n  position: absolute;\n  top: 20px;\n  right: 20px;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 10px;\n  background: var(--color-dark-gray);\n  padding: 12px;\n  border-radius: var(--radius-2xl);\n  box-shadow: var(--shadow-lg);\n  z-index: var(--z-action-bar);\n  width: auto;\n  box-sizing: border-box;\n  border: 1px solid var(--color-light-gray);\n}\n.action-bar .add-event-btn {\n  height: 44px;\n  cursor: pointer;\n  transition: transform 0.1s ease, filter 0.2s;\n}\n.add-event-btn:hover {\n  filter: brightness(1.1);\n  transform: scale(1.02);\n}\n.profile-trigger {\n  height: 44px;\n  width: 44px;\n  border-radius: var(--radius-full);\n  overflow: hidden;\n  cursor: pointer;\n  border: 1px solid transparent;\n  transition: border-color 0.2s;\n  background-color: var(--color-dark-gray);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.profile-trigger:hover {\n  border-color: var(--color-accent);\n}\n.profile-image {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n.profile-placeholder {\n  color: var(--color-white);\n  font-weight: var(--font-weight-semibold);\n  font-size: 16px;\n}\n.icon-circle {\n  width: 44px;\n  height: 44px;\n  background: rgba(255, 255, 255, 0.1);\n  border-radius: var(--radius-full);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  transition: background-color 0.2s, transform 0.2s;\n}\n.icon-circle mat-icon {\n  font-size: 24px;\n  width: 24px;\n  height: 24px;\n  color: var(--color-white);\n}\n.icon-circle:hover {\n  background: rgba(255, 255, 255, 0.2);\n}\n.notification-icon {\n  margin-right: 4px;\n  margin-left: 4px;\n  position: relative;\n}\n.unread-indicator {\n  position: absolute;\n  top: 10px;\n  right: 10px;\n  width: 10px;\n  height: 10px;\n  background-color: var(--color-accent);\n  border-radius: var(--radius-full);\n  border: 2px solid var(--color-dark-gray);\n  z-index: 10;\n}\nnotification-menu {\n  position: absolute;\n  top: 70px;\n  right: -70px;\n  z-index: var(--z-dropdown);\n}\n@media (max-width: 768px) {\n  .action-bar {\n    top: 20px;\n    bottom: auto;\n    right: 20px;\n    padding: 8px;\n    height: 60px;\n  }\n}\n/*# sourceMappingURL=action-bar.css.map */\n", "<div class=\"menu-backdrop\" (click)=\"close.emit()\"></div>\n<div class=\"menu-container\">\n  <div class=\"menu-header mobile-header\">\n    <mat-icon (click)=\"close.emit()\">arrow_back</mat-icon>\n    <h1>Menu</h1>\n  </div>\n  <div class=\"menu-item-container\">\n    <div class=\"menu-item\" (click)=\"onAction('account')\">\n      <i class=\"icon\">\uD83D\uDC64</i> Account\n    </div>\n\n    <div class=\"menu-item\" (click)=\"onAction('my-events')\">\n      <i class=\"icon\">\u2795</i> My events\n    </div>\n    <div class=\"menu-item logout\" (click)=\"onAction('logout')\">\n      <i class=\"icon\">\uD83D\uDEAA</i> Logout\n    </div>\n  </div>\n\n</div>\n", "/* src/components/user-menu/user-menu.css */\n:host {\n  display: contents;\n}\n.menu-backdrop {\n  position: fixed;\n  inset: 0;\n  background: transparent;\n}\n.menu-container {\n  position: absolute;\n  top: calc(100% + 10px);\n  right: 0;\n  width: 100%;\n  background: var(--color-dark-gray);\n  border-radius: var(--radius-lg);\n  box-shadow: var(--shadow-lg);\n  z-index: var(--z-dropdown);\n  animation: menuFadeIn 0.2s ease-out;\n  transform-origin: top right;\n  overflow: hidden;\n}\n@keyframes menuFadeIn {\n  from {\n    opacity: 0;\n    transform: scale(0.95) translateY(-10px);\n  }\n  to {\n    opacity: 1;\n    transform: scale(1) translateY(0);\n  }\n}\n.menu-item-container {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  width: 100%;\n  height: 100%;\n}\n.menu-item {\n  display: flex;\n  align-items: center;\n  padding: 16px 20px;\n  color: var(--color-white);\n  font-size: 15px;\n  font-weight: var(--font-weight-regular);\n  cursor: pointer;\n  width: 100%;\n  justify-content: center;\n  transition: all 0.2s ease;\n  border-bottom: 1px solid var(--color-bit-gray);\n}\n.menu-item:hover {\n  background: rgba(255, 255, 255, 0.05);\n  color: var(--color-white);\n}\n.menu-item:last-child {\n  border-bottom: none;\n}\n.menu-item .icon {\n  font-style: normal;\n  font-size: 16px;\n  display: none;\n}\n.menu-item.logout {\n  color: var(--color-error);\n}\n.menu-item.logout:hover {\n  background: rgba(255, 107, 107, 0.1);\n  color: var(--color-error);\n}\n.mobile-only {\n  display: none !important;\n}\n@media (max-width: 767px) {\n  .menu-container {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    border-radius: 0;\n    z-index: var(--z-popup);\n    padding-top: 0;\n    transform-origin: center;\n    background: var(--color-dark-gray);\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-start;\n    align-items: center;\n    background:\n      linear-gradient(\n        160deg,\n        rgba(20, 20, 20),\n        rgba(12, 12, 12));\n    overflow-y: auto;\n  }\n  .menu-item {\n    width: 100%;\n    padding: 24px 30px;\n    font-size: 28px;\n    border-bottom: 1px solid var(--color-bit-gray);\n    justify-content: center;\n  }\n  .mobile-only {\n    display: flex !important;\n  }\n}\n/*# sourceMappingURL=user-menu.css.map */\n", "import { Component, EventEmitter, Output } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MatIconModule } from '@angular/material/icon';\n\n@Component({\n    selector: 'UserMenu',\n    standalone: true,\n    imports: [CommonModule, MatIconModule],\n    templateUrl: './user-menu.html',\n    styleUrl: './user-menu.css'\n})\nexport class UserMenu {\n    @Output() close = new EventEmitter<void>();\n    @Output() action = new EventEmitter<string>();\n\n    onAction(actionName: string) {\n        this.action.emit(actionName);\n        this.close.emit();\n    }\n}\n", "<div class=\"notif-container\">\n    <div class=\"notif-header\">\n        <mat-icon (click)=\"close.emit()\" class=\"mobile-only back-arrow\">arrow_back</mat-icon>\n        <div class=\"title-wrap\">\n            <h1>Notifications</h1>\n        </div>\n        <div class=\"header-actions\">\n            <button class=\"pill-btn\" (click)=\"deleteRead()\" title=\"Delete read notifications\">\n                <mat-icon>delete_sweep</mat-icon>\n            </button>\n            <!-- Close button only on mobile if it's meant to be an X, but user asked for back arrow.\n                 Wrapping the old close button as per previous turn logic but keeping it hidden if back arrow is preferred. -->\n        </div>\n    </div>\n    <div class=\"notif-list\">\n        @if (notifications.length === 0) {\n        <div class=\"empty-state\">No notifications</div>\n        } @else {\n        @for (n of notifications; track n.id) {\n        <div class=\"notif-item\" [class.unread]=\"!n.isRead\" (click)=\"onNotificationClick(n)\">\n            <div class=\"icon-section\">\n                <mat-icon [style.color]=\"getIconColor(n.type)\">{{ getIcon(n.type) }}</mat-icon>\n            </div>\n\n            <div class=\"content-section\">\n                <div class=\"notif-top\">\n                    <span class=\"notif-title\">{{ n.title }}</span>\n                    <span class=\"notif-time\">{{ n.createdAt | date:'short' }}</span>\n                </div>\n\n                <div class=\"notif-msg\" [class.expanded]=\"expandedId === n.id\">\n                    {{ n.message }}\n                </div>\n\n                @if (n.type === 'PARTICIPATION_REQUEST') {\n                <div class=\"action-buttons\">\n                    <div class=\"btn-approve\" (click)=\"acceptRequest(n, $event)\" title=\"Accept\">\n                        <mat-icon>check</mat-icon>\n                    </div>\n                    <div class=\"btn-reject\" (click)=\"rejectRequest(n, $event)\" title=\"Reject\">\n                        <mat-icon>close</mat-icon>\n                    </div>\n                </div>\n                }\n\n                @if (n.type === 'REQUEST_ACCEPTED') {\n                <div class=\"status-msg success\">\n                    <mat-icon>check_circle</mat-icon> Accepted\n                </div>\n                }\n\n                @if (n.type === 'REQUEST_REJECTED') {\n                <div class=\"status-msg error\">\n                    <mat-icon>cancel</mat-icon> Rejected\n                </div>\n                }\n\n                @if (n.message.length > 100) {\n                <div class=\"expand-btn\" (click)=\"toggleExpand(n.id, $event)\">\n                    <mat-icon>{{ expandedId === n.id ? 'expand_less' : 'expand_more' }}</mat-icon>\n                </div>\n                }\n            </div>\n        </div>\n        }\n        }\n    </div>\n</div>\n", "/* src/components/notification-menu/notification-menu.css */\n.notif-container {\n  background:\n    linear-gradient(\n      160deg,\n      rgba(20, 20, 20, 0.96),\n      rgba(12, 12, 12, 0.98));\n  border: 1px solid rgba(255, 255, 255, 0.08);\n  width: 340px;\n  border-radius: 18px;\n  box-shadow: 0 18px 48px rgba(0, 0, 0, 0.45);\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  max-height: 460px;\n  color: var(--color-white);\n  font-family: var(--font-stack-headline);\n}\n.notif-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  column-gap: 12px;\n  height: 64px;\n  padding: 0 20px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.08);\n  background:\n    radial-gradient(\n      circle at 20% 20%,\n      rgba(252, 195, 36, 0.1),\n      transparent 38%);\n}\n.notif-header h1 {\n  margin: 0;\n  font-size: 22px;\n  font-weight: var(--font-weight-bold);\n  letter-spacing: 0.2px;\n  display: flex;\n  padding-bottom: 0;\n  align-items: center;\n  height: 40px;\n  line-height: 1;\n}\n.title-wrap {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex: 1;\n  height: 40px;\n  color: var(--color-white);\n}\n.header-actions {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  justify-content: flex-end;\n}\n.pill-btn {\n  width: 40px;\n  height: 40px;\n  display: grid;\n  place-items: center;\n  border-radius: 12px;\n  border: 1px solid rgba(255, 255, 255, 0.12);\n  background: rgba(255, 255, 255, 0.05);\n  color: var(--color-white);\n  cursor: pointer;\n  transition:\n    background 0.2s,\n    border-color 0.2s,\n    transform 0.1s,\n    color 0.2s;\n}\n.pill-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n  border-color: rgba(255, 255, 255, 0.2);\n  transform: translateY(-1px);\n}\n.pill-btn:active {\n  transform: translateY(0);\n}\n.pill-btn mat-icon {\n  font-size: 20px;\n}\n.notif-list {\n  overflow-y: auto;\n  max-height: 380px;\n  padding: 8px 4px 10px;\n}\n.notif-list::-webkit-scrollbar {\n  width: 6px;\n}\n.notif-list::-webkit-scrollbar-track {\n  background: var(--color-dark-gray);\n}\n.notif-list::-webkit-scrollbar-thumb {\n  background: var(--color-bit-gray);\n  border-radius: 3px;\n}\n.notif-list::-webkit-scrollbar-thumb:hover {\n  background: var(--color-light-gray);\n}\n.notif-item {\n  display: flex;\n  padding: 12px 14px;\n  margin: 6px 8px;\n  border-radius: 14px;\n  border: 1px solid rgba(255, 255, 255, 0.06);\n  transition:\n    background 0.2s,\n    border-color 0.2s,\n    transform 0.15s;\n  align-items: flex-start;\n  gap: var(--spacing-md);\n  position: relative;\n  background: rgba(255, 255, 255, 0.02);\n}\n.notif-item:hover {\n  background: rgba(255, 255, 255, 0.05);\n  border-color: rgba(255, 255, 255, 0.12);\n  transform: translateY(-1px);\n}\n.notif-item.unread {\n  background: rgba(252, 195, 36, 0.08);\n  border-color: rgba(252, 195, 36, 0.24);\n}\n.icon-section {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-top: 2px;\n}\n.content-section {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  min-width: 0;\n}\n.notif-top {\n  display: flex;\n  justify-content: space-between;\n  align-items: baseline;\n  margin-bottom: var(--spacing-xs);\n}\n.notif-title {\n  font-weight: var(--font-weight-semibold);\n  font-size: 14px;\n  color: var(--color-white);\n}\n.notif-time {\n  font-size: 10px;\n  opacity: 0.6;\n  margin-left: var(--spacing-sm);\n  white-space: nowrap;\n}\n.notif-msg {\n  font-size: 13px;\n  opacity: 0.82;\n  line-height: 1.45;\n  display: -webkit-box;\n  -webkit-line-clamp: 3;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  transition: max-height 0.3s ease;\n}\n.notif-msg.expanded {\n  -webkit-line-clamp: unset;\n  overflow: visible;\n}\n.expand-btn {\n  cursor: pointer;\n  opacity: 0.6;\n  transition: opacity 0.2s;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.expand-btn:hover {\n  opacity: 1;\n}\n.empty-state {\n  padding: 28px 18px 34px;\n  text-align: center;\n  opacity: 0.6;\n  font-style: italic;\n  font-size: 13px;\n}\n.action-buttons {\n  display: flex;\n  gap: var(--spacing-sm);\n  margin-left: auto;\n  align-items: center;\n  padding-left: var(--spacing-sm);\n  margin-top: 8px;\n}\n.btn-approve,\n.btn-reject {\n  width: 28px;\n  height: 28px;\n  border-radius: var(--radius-full);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  transition: transform 0.2s, background-color 0.2s;\n}\n.btn-approve {\n  background-color: rgba(76, 175, 80, 0.2);\n  color: #4caf50;\n}\n.btn-approve:hover {\n  background-color: rgba(76, 175, 80, 0.4);\n  transform: scale(1.1);\n}\n.btn-reject {\n  background-color: rgba(244, 67, 54, 0.2);\n  color: #f44336;\n}\n.btn-reject:hover {\n  background-color: rgba(244, 67, 54, 0.4);\n  transform: scale(1.1);\n}\n.btn-approve mat-icon,\n.btn-reject mat-icon {\n  font-size: 18px;\n  width: 18px;\n  height: 18px;\n}\n.status-msg {\n  display: flex;\n  align-items: center;\n  gap: var(--spacing-xs);\n  font-size: 12px;\n  font-weight: var(--font-weight-medium);\n  margin-left: auto;\n  padding-left: var(--spacing-sm);\n  white-space: nowrap;\n  margin-top: 5px;\n}\n.status-msg mat-icon {\n  font-size: 16px;\n  width: 16px;\n  height: 16px;\n}\n.status-msg.success {\n  color: #4caf50;\n}\n.status-msg.error {\n  color: #f44336;\n}\n@media (max-width: 768px) {\n  .notif-container {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    max-height: none;\n    border-radius: 0;\n    z-index: 100001;\n    background-color: var(--color-dark-gray);\n  }\n  .notif-header {\n    height: 70px;\n    position: relative;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    padding: 0 24px;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n  }\n  .title-wrap {\n    margin: 0;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    pointer-events: none;\n    z-index: 5;\n  }\n  .notif-header h1 {\n    font-size: 24px !important;\n    color: var(--color-accent) !important;\n    text-align: center;\n    margin: 0 !important;\n    width: auto !important;\n    height: 100% !important;\n    display: flex !important;\n    align-items: center !important;\n    justify-content: center !important;\n    line-height: normal !important;\n  }\n  .back-arrow {\n    position: absolute;\n    left: 24px;\n    font-size: 24px;\n    cursor: pointer;\n    color: var(--color-white);\n    display: flex !important;\n    align-items: center;\n    justify-content: center;\n    z-index: 10;\n    height: 100%;\n    top: 0;\n  }\n  .header-actions {\n    position: absolute;\n    right: 24px;\n    z-index: 10;\n    display: flex;\n    align-items: center;\n    height: 100%;\n    top: 0;\n  }\n  .notif-list {\n    max-height: none;\n    flex: 1;\n    padding-bottom: 20px;\n  }\n  .notif-item {\n    padding: var(--spacing-lg);\n  }\n  .notif-title {\n    font-size: 18px;\n  }\n  .notif-msg {\n    font-size: 16px;\n  }\n  .btn-approve,\n  .btn-reject {\n    width: 44px;\n    height: 44px;\n  }\n  .btn-approve mat-icon,\n  .btn-reject mat-icon {\n    font-size: 24px;\n    width: 24px;\n    height: 24px;\n  }\n}\n/*# sourceMappingURL=notification-menu.css.map */\n", "\nexport interface Notification {\n    id: number;\n    userId: number;\n    title: string;\n    message: string;\n    type: 'INFO' | 'SUCCESS' | 'WARNING' | 'ERROR' | 'APPROVED' | 'REJECTED' | 'FOLLOWUP' | 'PARTICIPATION_REQUEST' | 'PARTICIPATION_ACCEPTED' | 'PARTICIPATION_REJECTED' | 'REQUEST_ACCEPTED' | 'REQUEST_REJECTED' | 'CHAT_MESSAGE' | 'PARTICIPATION_REMOVED';\n    isRead: boolean;\n    createdAt: string;\n    relatedEventId?: number;\n    relatedUserId?: number;\n}\n\nimport { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable } from 'rxjs';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class NotificationService {\n    private apiUrl = 'http://localhost:8080/api/notifications';\n\n    constructor(private http: HttpClient) { }\n\n    getNotifications(userId: number | string): Observable<Notification[]> {\n        return this.http.get<Notification[]>(`${this.apiUrl}?userId=${userId}`);\n    }\n\n    markAsRead(notificationId: number): Observable<void> {\n        return this.http.post<void>(`${this.apiUrl}/${notificationId}/read`, {});\n    }\n\n    markAllAsRead(userId: number | string): Observable<void> {\n        return this.http.post<void>(`${this.apiUrl}/read-all?userId=${userId}`, {});\n    }\n\n    updateType(notificationId: number, newType: string): Observable<void> {\n        return this.http.post<void>(`${this.apiUrl}/${notificationId}/type?newType=${newType}`, {});\n    }\n\n    deleteNotification(notificationId: number): Observable<void> {\n        return this.http.delete<void>(`${this.apiUrl}/${notificationId}`);\n    }\n\n    deleteReadNotifications(userId: number | string): Observable<void> {\n        return this.http.delete<void>(`${this.apiUrl}/read?userId=${userId}`);\n    }\n}\n", "import { Component, Input, OnInit, ElementRef, Output, EventEmitter } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MatIconModule } from '@angular/material/icon';\nimport { Notification, NotificationService } from '../../services/notification.service';\nimport { EventService } from '../../services/event.service';\n\n@Component({\n    selector: 'notification-menu',\n    standalone: true,\n    imports: [CommonModule, MatIconModule],\n    templateUrl: './notification-menu.html',\n    styleUrls: ['./notification-menu.css']\n})\nexport class NotificationMenuComponent implements OnInit {\n    @Input() userId!: number | string;\n    @Output() close = new EventEmitter<void>();\n    @Output() openChat = new EventEmitter<number>();\n    @Output() openEvent = new EventEmitter<number>();\n    notifications: Notification[] = [];\n    expandedId: number | null = null;\n\n    constructor(private notifService: NotificationService, private eventService: EventService, private eRef: ElementRef) { }\n\n    ngOnInit() {\n        this.loadNotifications();\n    }\n\n    loadNotifications() {\n        if (!this.userId) return;\n        this.notifService.getNotifications(this.userId).subscribe(list => {\n            this.notifications = list.map(n => this.translateNotification(n));\n        });\n    }\n\n    translateNotification(n: Notification): Notification {\n        const quotedParts = (n.message || '').match(/[\"']([^\"']+)[\"']/g)?.map((m) => m.slice(1, -1)) || [];\n        const eventName = quotedParts.length ? quotedParts[quotedParts.length - 1] : '';\n        const firstQuoted = quotedParts[0] || '';\n\n        switch (n.type) {\n            case 'APPROVED':\n                n.title = 'Event Approved';\n                if (eventName) {\n                    n.message = `Your event '${eventName}' has been approved and is now visible!`;\n                } else {\n                    n.message = 'Your event has been approved and is now visible!';\n                }\n                break;\n            case 'REJECTED':\n                n.title = 'Event Rejected';\n                if (eventName) {\n                    n.message = `Your event '${eventName}' has been rejected.`;\n                } else {\n                    n.message = 'Your event has been rejected.';\n                }\n                break;\n            case 'PARTICIPATION_REQUEST':\n                n.title = 'Participation Request';\n                if (quotedParts.length >= 2) {\n                    n.message = `User '${firstQuoted}' wants to join event '${eventName}'.`;\n                } else if (eventName) {\n                    n.message = `A user wants to join event '${eventName}'.`;\n                } else {\n                    n.message = 'A user requested to join your event.';\n                }\n                break;\n            case 'PARTICIPATION_ACCEPTED':\n                n.title = 'Request Accepted';\n                n.message = 'Your request to join the event has been accepted!';\n                break;\n            case 'PARTICIPATION_REJECTED':\n                n.title = 'Request Rejected';\n                n.message = 'Your request to join the event has been rejected.';\n                break;\n            case 'PARTICIPATION_REMOVED':\n                n.title = 'Removed from Event';\n                if (eventName) {\n                    n.message = `You have been removed from the event '${eventName}'.`;\n                } else {\n                    n.message = 'You have been removed from the event.';\n                }\n                break;\n            case 'REQUEST_ACCEPTED':\n                n.title = 'Request Accepted';\n                break;\n            case 'REQUEST_REJECTED':\n                n.title = 'Request Rejected';\n                break;\n            case 'CHAT_MESSAGE':\n                n.title = 'New chat message';\n                break;\n        }\n        return n;\n    }\n\n    toggleExpand(id: number, event: Event) {\n        event.stopPropagation();\n        this.expandedId = this.expandedId === id ? null : id;\n    }\n\n    deleteRead() {\n        if (!this.userId) return;\n        this.notifService.deleteReadNotifications(this.userId).subscribe({\n            next: () => {\n                this.notifications = this.notifications.filter(n => !n.isRead);\n            },\n            error: (err) => console.error('Error deleting read notifications', err)\n        });\n    }\n\n    acceptRequest(n: Notification, event: Event) {\n        event.stopPropagation();\n        console.log('Attempting to accept request:', n);\n        if (n.relatedEventId && n.relatedUserId) {\n            console.log('IDs found, calling service...');\n            this.eventService.acceptParticipation(n.relatedEventId, n.relatedUserId).subscribe({\n                next: () => {\n                    console.log('Participation accepted successfully');\n                    this.notifService.updateType(n.id, 'REQUEST_ACCEPTED').subscribe(() => {\n                        this.notifService.markAsRead(n.id).subscribe(() => this.loadNotifications());\n                    });\n                },\n                error: (err) => console.error('Error accepting participation', err)\n            });\n        } else {\n            console.error('Missing relatedEventId or relatedUserId in notification:', n);\n        }\n    }\n\n    rejectRequest(n: Notification, event: Event) {\n        event.stopPropagation();\n        if (n.relatedEventId && n.relatedUserId) {\n            this.eventService.rejectParticipation(n.relatedEventId, n.relatedUserId).subscribe({\n                next: () => {\n                    this.notifService.updateType(n.id, 'REQUEST_REJECTED').subscribe(() => {\n                        this.notifService.markAsRead(n.id).subscribe(() => this.loadNotifications());\n                    });\n                },\n                error: (err) => console.error('Error rejecting participation', err)\n            });\n        }\n    }\n\n    delete(event: Event, n: Notification) {\n        event.stopPropagation();\n        this.notifService.deleteNotification(n.id).subscribe({\n            next: () => {\n                this.notifications = this.notifications.filter(item => item.id !== n.id);\n            },\n            error: (err) => console.error('Error deleting notification', err)\n        });\n    }\n\n    onNotificationClick(n: Notification) {\n        if (n.type === 'CHAT_MESSAGE') {\n            if (!n.relatedEventId) {\n                console.error('Missing relatedEventId in chat notification:', n);\n                return;\n            }\n            this.openChat.emit(n.relatedEventId);\n            this.close.emit();\n            return;\n        }\n\n        if (n.type === 'FOLLOWUP') {\n            if (!n.relatedEventId) {\n                console.error('Missing relatedEventId in followup notification:', n);\n                return;\n            }\n            this.openEvent.emit(n.relatedEventId);\n            this.close.emit();\n        }\n    }\n\n    getIcon(type: string): string {\n        switch (type) {\n            case 'APPROVED': return 'check_circle';\n            case 'REJECTED': return 'cancel';\n            case 'FOLLOWUP': return 'event_available';\n            case 'PARTICIPATION_REQUEST': return 'person_add';\n            case 'PARTICIPATION_ACCEPTED': return 'how_to_reg';\n            case 'PARTICIPATION_REJECTED': return 'person_remove';\n            case 'PARTICIPATION_REMOVED': return 'person_remove';\n            case 'REQUEST_ACCEPTED': return 'check_circle';\n            case 'REQUEST_REJECTED': return 'cancel';\n            case 'CHAT_MESSAGE': return 'chat';\n            case 'SUCCESS': return 'check_circle';\n            case 'ERROR': return 'error';\n            case 'WARNING': return 'warning';\n            default: return 'notifications';\n        }\n    }\n\n    getIconColor(type: string): string {\n        switch (type) {\n            case 'APPROVED': return 'var(--color-accent)';\n            case 'REJECTED': return '#ff4444';\n            case 'FOLLOWUP': return '#4caf50';\n            case 'PARTICIPATION_REQUEST': return '#2196f3';\n            case 'PARTICIPATION_ACCEPTED': return '#4caf50';\n            case 'PARTICIPATION_REJECTED': return '#ff4444';\n            case 'PARTICIPATION_REMOVED': return '#ff4444';\n            case 'CHAT_MESSAGE': return 'var(--color-accent)';\n\n            default: return 'white';\n        }\n    }\n}\n", "@if (!showChatModal) {\n<div class=\"backdrop\" (click)=\"close.emit()\"></div>\n\n<div class=\"modal-container\">\n    <div class=\"modal-header\">\n        <mat-icon (click)=\"onBack()\" class=\"back-arrow\">arrow_back</mat-icon>\n\n        <div class=\"tabs tablet-desktop-only\">\n            <button class=\"tab-btn\" [class.active]=\"activeTab === 'ORGANIZED'\" (click)=\"switchTab('ORGANIZED')\">\n                My Events\n            </button>\n            <button class=\"tab-btn\" [class.active]=\"activeTab === 'JOINED'\" (click)=\"switchTab('JOINED')\">\n                Joined Events\n            </button>\n            <button class=\"tab-btn\" [class.active]=\"activeTab === 'SAVED'\" (click)=\"switchTab('SAVED')\">\n                Saved Events\n            </button>\n        </div>\n\n        <div class=\"title-wrap mobile-only\">\n            <h2 class=\"yellow-title\">{{ getViewTitle() }}</h2>\n        </div>\n\n        <button class=\"close-btn tablet-desktop-only\" (click)=\"close.emit()\">\n            <mat-icon>close</mat-icon>\n        </button>\n    </div>\n\n    <!-- Mobile Tab Bar -->\n    <div class=\"mobile-tabs mobile-only\">\n        <button class=\"mobile-tab-btn\" [class.active]=\"activeTab === 'ORGANIZED'\" (click)=\"switchTab('ORGANIZED')\">\n            <mat-icon>event</mat-icon>\n            <span>My Events</span>\n        </button>\n        <button class=\"mobile-tab-btn\" [class.active]=\"activeTab === 'JOINED'\" (click)=\"switchTab('JOINED')\">\n            <mat-icon>group</mat-icon>\n            <span>Joined</span>\n        </button>\n        <button class=\"mobile-tab-btn\" [class.active]=\"activeTab === 'SAVED'\" (click)=\"switchTab('SAVED')\">\n            <mat-icon>bookmark</mat-icon>\n            <span>Saved</span>\n        </button>\n    </div>\n\n    <div class=\"modal-content\">\n        @if (loading) {\n        <div class=\"loading-state\">Loading...</div>\n        }\n\n        @if (!loading && activeTab === 'ORGANIZED') {\n        <div class=\"events-list\" [class.has-expanded-requests]=\"expandedEventRequestsId\">\n            @for (event of organizedEvents; track event.id) {\n            <div class=\"organized-event-item\" [class.expanded]=\"expandedEventRequestsId === event.id\">\n                <div class=\"event-summary\">\n                    <div class=\"event-info\">\n                        <h3>{{ event.title }}</h3>\n                        <span class=\"event-location\">{{ event.city }}</span>\n                        <span class=\"event-date\">{{ formatDateTime(event) }}</span>\n                        <span class=\"requests-badge\" *ngIf=\"event.pendingUsersList?.length\"\n                            (click)=\"toggleRequests(event.id)\">\n                            {{ event.pendingUsersList?.length }} Requests\n                        </span>\n                    </div>\n                    <div class=\"event-actions\">\n                        <button class=\"icon-btn chat\" (click)=\"openChat(event)\" title=\"Open chat\">\n                            <mat-icon>chat</mat-icon>\n                        </button>\n                        <button class=\"icon-btn danger\" (click)=\"deleteEvent(event)\" title=\"Delete event\">\n                            <mat-icon>delete</mat-icon>\n                        </button>\n                        <button class=\"icon-btn\" (click)=\"toggleRequests(event.id)\" title=\"Manage Requests\">\n                            <mat-icon>group</mat-icon>\n                        </button>\n                    </div>\n                </div>\n\n                <!-- Requests Section -->\n                @if (expandedEventRequestsId === event.id) {\n                <div class=\"requests-panel\">\n                    <!-- Event Overview Section -->\n                    <div class=\"event-overview-section\">\n                        <h4>Event Overview</h4>\n                        <div class=\"stats-card\">\n                            <div class=\"stat-item\">\n                                <span class=\"stat-label\">Accepted Participants</span>\n                                <span class=\"stat-value\">{{ event.acceptedUsersList?.length || 0 }}</span>\n                            </div>\n                            <div class=\"stat-item\">\n                                <span class=\"stat-label\">Capacity</span>\n                                <span class=\"stat-value\">\n                                    {{ event.acceptedUsersList?.length || 0 }} / {{ event.nPartecipants }}\n                                </span>\n                            </div>\n                        </div>\n\n                        @if (event.acceptedUsersList?.length) {\n                        <div class=\"participants-list\">\n                            <h5 class=\"section-subtitle\">Accepted People</h5>\n                            <div class=\"participants-grid\">\n                                @for (user of event.acceptedUsersList; track user.id) {\n                                <div class=\"participant-chip\">\n                                    <img [src]=\"user.profileImage || 'assets/placeholder-user.png'\"\n                                        class=\"participant-avatar\">\n                                    <span class=\"participant-name\">{{ user.name }} {{ user.surname }}</span>\n                                    <button class=\"participant-remove-btn\" type=\"button\"\n                                        (click)=\"removeParticipant(event, user)\" title=\"Remove participant\">\n                                        <mat-icon>person_remove</mat-icon>\n                                    </button>\n                                </div>\n                                }\n                            </div>\n                        </div>\n                        } @else {\n                        <p class=\"no-data-msg\">No participants accepted yet.</p>\n                        }\n                    </div>\n\n                    <!-- Pending Requests Section -->\n                    <div class=\"pending-requests-section\">\n                        <h4>Pending Requests ({{ event.pendingUsersList?.length || 0 }})</h4>\n                        @if (event.pendingUsersList?.length) {\n                        @for (user of event.pendingUsersList; track user.id) {\n                        <div class=\"request-item\">\n                            <div class=\"user-info\">\n                                <img [src]=\"user.profileImage || 'assets/placeholder-user.png'\" class=\"user-avatar\">\n                                <span>{{ user.name }} {{ user.surname }}</span>\n                            </div>\n                            <div class=\"request-actions\">\n                                <button class=\"accept-btn\" (click)=\"acceptRequest(event, user)\">Accept</button>\n                                <button class=\"reject-btn\" (click)=\"rejectRequest(event, user)\">Reject</button>\n                            </div>\n                        </div>\n                        }\n                        } @else {\n                        <p class=\"no-requests\">No pending requests.</p>\n                        }\n                    </div>\n                </div>\n                }\n            </div>\n            }\n            @empty {\n            <div class=\"empty-state\">No organized events found.</div>\n            }\n        </div>\n        }\n\n        @if (!loading && activeTab === 'JOINED') {\n        <div class=\"events-grid\">\n            @for (event of joinedEvents; track event.id) {\n            <div class=\"joined-event-item\">\n                <div class=\"joined-action-btns\">\n                    <button class=\"joined-action-btn joined-pin-btn\" (click)=\"goToEvent(event); $event.stopPropagation()\"\n                        title=\"View on map\">\n                        <mat-icon>place</mat-icon>\n                    </button>\n                    <button class=\"joined-chat-btn\" (click)=\"openChat(event); $event.stopPropagation()\"\n                        title=\"Open chat\">\n                        <mat-icon>chat</mat-icon>\n                    </button>\n                </div>\n                <app-event-card [title]=\"event.title\" [location]=\"event.city\" [dateTime]=\"formatDateTime(event)\"\n                    [id]=\"event.id!\" [isSaved]=\"!!event.isSaved\" [savedCount]=\"event.savedCount\"\n                    [isParticipating]=\"!!event.isParticipating\" [showDistance]=\"false\" [showActions]=\"false\"\n                    (shareEvent)=\"openShare(event)\" [showLocationPin]=\"false\">\n                </app-event-card>\n            </div>\n            }\n            @empty {\n            <div class=\"empty-state\">You haven't joined any events yet.</div>\n            }\n        </div>\n        }\n\n        @if (!loading && activeTab === 'SAVED') {\n        <div class=\"events-grid\">\n            @for (event of savedEvents; track event.id) {\n            <app-event-card [title]=\"event.title\" [location]=\"event.city\" [dateTime]=\"formatDateTime(event)\"\n                [id]=\"event.id!\" [isSaved]=\"true\" [savedCount]=\"event.savedCount\"\n                [isParticipating]=\"!!event.isParticipating\" [showDistance]=\"false\" [showActions]=\"false\"\n                (shareEvent)=\"openShare(event)\" (focusLocation)=\"goToEvent(event)\" [showLocationPin]=\"true\">\n            </app-event-card>\n            }\n            @empty {\n            <div class=\"empty-state\">You haven't saved any events yet.</div>\n            }\n        </div>\n        }\n    </div>\n</div>\n@if (sharingEvent) {\n<app-event-share-modal [event]=\"sharingEvent\" (close)=\"sharingEvent = null\"></app-event-share-modal>\n}\n}\n\n@if (showChatModal && chatEvent) {\n<event-chat-modal [event]=\"chatEvent\" [currentUserId]=\"userId.toString()\" (close)=\"closeChat()\">\n</event-chat-modal>\n}\n", "/* src/components/my-events-modal/my-events-modal.css */\n.backdrop {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n  background: var(--modal-backdrop-color);\n  z-index: var(--z-backdrop);\n  -webkit-backdrop-filter: blur(var(--modal-backdrop-blur));\n  backdrop-filter: blur(var(--modal-backdrop-blur));\n}\n.modal-container {\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 90%;\n  max-width: 600px;\n  height: 80vh;\n  background: var(--modal-surface);\n  border-radius: var(--modal-radius);\n  z-index: var(--z-popup);\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  box-shadow: var(--modal-shadow);\n  border: var(--modal-border);\n}\n.modal-header {\n  padding: 16px 24px;\n  background: transparent;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  border-bottom: var(--modal-header-border);\n}\n.yellow-title {\n  color: var(--color-accent) !important;\n}\n.back-arrow {\n  cursor: pointer;\n  color: var(--color-white);\n  font-size: 24px;\n  margin-right: 16px;\n  transition: color 0.2s;\n}\n.back-arrow:hover {\n  color: var(--color-accent);\n}\n.tabs {\n  display: flex;\n  flex: 1;\n  justify-content: center;\n  align-items: center;\n  gap: 0;\n}\n.tab-btn {\n  flex: 1;\n  background: none;\n  border: none;\n  color: #888;\n  font-size: 16px;\n  font-weight: 600;\n  padding: 10px 24px;\n  cursor: pointer;\n  position: relative;\n  text-align: center;\n  border-left: 1px solid rgba(255, 255, 255, 0.12);\n  transition: color 0.3s;\n}\n.tab-btn:first-child {\n  border-left: none;\n}\n.tab-btn.active {\n  color: #fbce4e;\n}\n.tab-btn.active::after {\n  content: \"\";\n  position: absolute;\n  bottom: -17px;\n  left: 0;\n  width: 100%;\n  height: 3px;\n  background: #fbce4e;\n  border-radius: 3px 3px 0 0;\n}\n.close-btn {\n  background: none;\n  border: none;\n  color: #fff;\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.close-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n}\n.modal-content {\n  flex: 1;\n  overflow-y: auto;\n  padding: 24px;\n}\n.events-list {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n.organized-event-item {\n  background-color: var(--color-gray);\n  border-radius: var(--radius-md);\n  padding: 12px var(--spacing-md);\n  border: none;\n  color: var(--color-white);\n}\n.event-summary {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.event-actions {\n  display: flex;\n  gap: 8px;\n  align-items: center;\n}\n.icon-btn.chat {\n  background: rgba(252, 195, 36, 0.14);\n  color: var(--color-accent);\n  border: 1px solid rgba(252, 195, 36, 0.3);\n  width: 36px;\n  height: 36px;\n  border-radius: 8px;\n}\n.icon-btn.chat:hover {\n  background: rgba(252, 195, 36, 0.3);\n  color: #0b0b0b;\n}\n.event-info {\n  display: flex;\n  flex-direction: column;\n  gap: var(--spacing-xs);\n}\n.icon-btn.danger {\n  background: rgba(234, 67, 53, 0.1);\n  color: var(--color-danger);\n  border: 1px solid rgba(234, 67, 53, 0.2);\n  width: 36px;\n  height: 36px;\n  border-radius: 8px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s;\n}\n.icon-btn.danger:hover {\n  background: var(--color-danger);\n  color: white;\n}\n.icon-btn.danger mat-icon {\n  font-size: 20px;\n  width: 20px;\n  height: 20px;\n}\n.event-info h3 {\n  margin: 0;\n  font-size: 14px;\n  font-weight: var(--font-weight-medium);\n  color: var(--color-white);\n}\n.event-location {\n  display: block;\n  margin: 0;\n  font-size: 12px;\n  color: var(--color-accent);\n  font-weight: var(--font-weight-medium);\n}\n.event-date {\n  display: block;\n  margin: 0;\n  font-size: 10px;\n  color: #888888;\n}\n.requests-badge {\n  display: inline-block;\n  background: var(--color-accent);\n  color: #000;\n  font-size: 10px;\n  font-weight: bold;\n  padding: 2px 8px;\n  border-radius: 12px;\n  cursor: pointer;\n  align-self: flex-start;\n  margin-top: 4px;\n}\n.icon-btn {\n  width: 32px;\n  height: 32px;\n  border-radius: var(--radius-full);\n  background-color: var(--color-bit-gray);\n  border: none;\n  color: var(--color-light-gray);\n  padding: 0;\n  cursor: pointer;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  transition: background-color 0.2s;\n}\n.icon-btn mat-icon {\n  font-size: 18px;\n  width: 18px;\n  height: 18px;\n}\n.icon-btn:hover {\n  background-color: #555555;\n  color: var(--color-white);\n}\n.requests-panel {\n  margin-top: 16px;\n  padding-top: 16px;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n  animation: slideDown 0.3s ease-out;\n}\n@keyframes slideDown {\n  from {\n    opacity: 0;\n    transform: translateY(-10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n.requests-panel h4 {\n  margin: 0 0 12px 0;\n  color: #ddd;\n  font-size: 14px;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n.request-item {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 8px 0;\n}\n.user-info {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  color: #fff;\n}\n.user-avatar {\n  width: 32px;\n  height: 32px;\n  border-radius: 50%;\n  object-fit: cover;\n  background: #444;\n}\n.request-actions {\n  display: flex;\n  gap: 8px;\n}\n.accept-btn,\n.reject-btn {\n  border: none;\n  padding: 6px 12px;\n  border-radius: 6px;\n  font-size: 12px;\n  font-weight: 600;\n  cursor: pointer;\n}\n.accept-btn {\n  background: #4caf50;\n  color: white;\n}\n.reject-btn {\n  background: #f44336;\n  color: white;\n}\n.no-requests {\n  color: #888;\n  font-size: 14px;\n  font-style: italic;\n}\n.event-overview-section {\n  margin-bottom: 24px;\n  padding-bottom: 24px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n.pending-requests-section h4,\n.event-overview-section h4 {\n  margin: 0 0 16px 0;\n  color: #fbce4e;\n  font-size: 14px;\n  text-transform: uppercase;\n  letter-spacing: 1px;\n  font-weight: 700;\n}\n.stats-card {\n  display: flex;\n  gap: 16px;\n  margin-bottom: 20px;\n  background: rgba(255, 255, 255, 0.03);\n  padding: 16px;\n  border-radius: 12px;\n}\n.stat-item {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n}\n.stat-label {\n  color: #888;\n  font-size: 12px;\n  text-transform: uppercase;\n}\n.stat-value {\n  color: #fff;\n  font-size: 18px;\n  font-weight: 700;\n}\n.section-subtitle {\n  color: #ddd;\n  font-size: 14px;\n  margin: 0 0 12px 0;\n  font-weight: 600;\n}\n.participants-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));\n  gap: 10px;\n}\n.participant-chip {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  background: rgba(255, 255, 255, 0.05);\n  padding: 6px 10px;\n  border-radius: 20px;\n  border: 1px solid rgba(255, 255, 255, 0.05);\n}\n.participant-avatar {\n  width: 24px;\n  height: 24px;\n  border-radius: 50%;\n  object-fit: cover;\n}\n.participant-name {\n  color: #eee;\n  font-size: 12px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  flex: 1;\n  min-width: 0;\n}\n.participant-remove-btn {\n  margin-left: auto;\n  width: 22px;\n  height: 22px;\n  border-radius: 50%;\n  border: 1px solid rgba(244, 67, 54, 0.3);\n  background: rgba(244, 67, 54, 0.15);\n  color: #f44336;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n.participant-remove-btn mat-icon {\n  font-size: 14px;\n  width: 14px;\n  height: 14px;\n}\n.participant-remove-btn:hover {\n  background: #f44336;\n  color: #fff;\n}\n.no-data-msg {\n  color: #888;\n  font-size: 13px;\n  font-style: italic;\n}\n.events-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));\n  gap: 16px;\n}\n.joined-event-item {\n  position: relative;\n}\n.joined-action-btns {\n  position: absolute;\n  top: 50%;\n  right: 12px;\n  transform: translateY(-50%);\n  display: flex;\n  gap: 8px;\n  align-items: center;\n  z-index: 2;\n}\n.joined-action-btn {\n  width: 32px;\n  height: 32px;\n  border-radius: var(--radius-full);\n  background-color: var(--color-bit-gray);\n  border: none;\n  color: var(--color-light-gray);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  transition: background-color 0.2s, transform 0.1s ease;\n}\n.joined-action-btn:hover {\n  background-color: #555555;\n}\n.joined-action-btn:active {\n  transform: scale(0.9);\n}\n.joined-action-btn mat-icon {\n  font-size: 18px;\n  width: 18px;\n  height: 18px;\n  color: var(--color-light-gray);\n}\n.joined-chat-btn {\n  width: 36px;\n  height: 36px;\n  border-radius: 10px;\n  border: 1px solid rgba(252, 195, 36, 0.3);\n  background: rgba(252, 195, 36, 0.14);\n  color: var(--color-accent);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  transition:\n    background 0.2s,\n    color 0.2s,\n    border-color 0.2s;\n}\n.joined-chat-btn:hover {\n  background: rgba(252, 195, 36, 0.3);\n  color: #0b0b0b;\n}\n.joined-chat-btn mat-icon {\n  font-size: 18px;\n  width: 18px;\n  height: 18px;\n}\n.empty-state {\n  text-align: center;\n  color: #888;\n  margin-top: 40px;\n}\n.modal-content::-webkit-scrollbar {\n  width: 8px;\n}\n.modal-content::-webkit-scrollbar-track {\n  background: #1a1a1a;\n  border-radius: 4px;\n}\n.modal-content::-webkit-scrollbar-thumb {\n  background: #333;\n  border-radius: 4px;\n}\n.modal-content::-webkit-scrollbar-thumb:hover {\n  background: #444;\n}\n@media (max-width: 768px) {\n  .backdrop {\n    -webkit-backdrop-filter: none;\n    backdrop-filter: none;\n  }\n  .modal-container {\n    position: fixed;\n    top: 0;\n    left: 0;\n    transform: none;\n    width: 100%;\n    max-width: 100%;\n    height: 100%;\n    max-height: 100vh;\n    border-radius: 0;\n    border: none;\n  }\n  .modal-header {\n    height: 70px;\n    position: relative;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    padding: 0 24px;\n    border-bottom: var(--modal-header-border);\n    margin-bottom: 0;\n  }\n  .title-wrap {\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    margin: 0;\n    display: flex !important;\n    align-items: center;\n    justify-content: center;\n    pointer-events: none;\n    z-index: 5;\n  }\n  .modal-header h2 {\n    font-size: 24px !important;\n    color: var(--color-accent) !important;\n    text-align: center;\n    margin: 0 !important;\n    width: auto !important;\n    height: 100% !important;\n    display: flex !important;\n    align-items: center !important;\n    justify-content: center !important;\n    line-height: normal !important;\n  }\n  .back-arrow {\n    position: absolute;\n    left: 24px;\n    font-size: 24px;\n    cursor: pointer;\n    color: var(--color-white);\n    display: flex !important;\n    align-items: center;\n    justify-content: center;\n    z-index: 10;\n    height: 100%;\n    top: 0;\n  }\n  .modal-content {\n    padding: 16px;\n  }\n  .has-expanded-requests .organized-event-item:not(.expanded) {\n    display: none;\n  }\n  .has-expanded-requests .organized-event-item.expanded {\n    background: transparent !important;\n    padding: 0 !important;\n    border: none !important;\n  }\n  .has-expanded-requests .organized-event-item.expanded .event-summary {\n    display: none !important;\n  }\n  .has-expanded-requests .organized-event-item.expanded .requests-panel {\n    margin-top: 0 !important;\n    border-top: none !important;\n    padding-top: 0 !important;\n  }\n}\n.mobile-tabs {\n  display: none;\n  justify-content: space-around;\n  background: rgba(0, 0, 0, 0.3);\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n  padding: 8px 0;\n}\n.mobile-tab-btn {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 4px;\n  background: none;\n  border: none;\n  color: #888;\n  font-size: 11px;\n  cursor: pointer;\n  padding: 8px 0;\n  transition: color 0.2s;\n}\n.mobile-tab-btn mat-icon {\n  font-size: 20px;\n  width: 20px;\n  height: 20px;\n}\n.mobile-tab-btn.active {\n  color: var(--color-accent);\n}\n.mobile-tab-btn.active mat-icon {\n  color: var(--color-accent);\n}\n@media (max-width: 768px) {\n  .mobile-tabs {\n    display: flex !important;\n  }\n}\n/*# sourceMappingURL=my-events-modal.css.map */\n", "<div class=\"chat-backdrop\" (click)=\"onClose()\">\n  <div class=\"chat-container\" (click)=\"$event.stopPropagation()\">\n    <div class=\"chat-header\">\n      <div class=\"header-left\">\n        <mat-icon (click)=\"onClose()\" class=\"back-arrow\">arrow_back</mat-icon>\n        <div class=\"header-text\">\n          <span class=\"title\">Event Chat</span>\n          <span class=\"subtitle\">{{ event.title }}</span>\n        </div>\n      </div>\n      <button class=\"close-btn\" (click)=\"onClose()\" aria-label=\"Close chat\">\n        <mat-icon>close</mat-icon>\n      </button>\n    </div>\n\n    <div class=\"chat-body\">\n      <div class=\"chat-left\">\n        <!-- Single Pinned Item Bar -->\n        @if (pinnedItem) {\n        <div class=\"pinned-bar\" (click)=\"scrollToItem(pinnedId!, pinnedType!)\">\n          <mat-icon class=\"pin-icon\">push_pin</mat-icon>\n          <div class=\"pinned-content\">\n            <span class=\"pinned-sender\">{{ getPinnedSenderName() }}</span>\n            <span class=\"pinned-text\">{{ getPinnedDisplayText() }}</span>\n          </div>\n          <button class=\"unpin-btn\" *ngIf=\"isOrganizer\"\n            (click)=\"togglePin(pinnedItem, pinnedType!); $event.stopPropagation()\">\n            <mat-icon>close</mat-icon>\n          </button>\n        </div>\n        }\n        <div class=\"messages\" #messagesContainer (click)=\"closePinMenu()\">\n          <div class=\"info-message\" *ngFor=\"let info of infoMessages\" [attr.id]=\"info.anchorId\">\n            <div class=\"info-label\">{{ info.label }}</div>\n            <div class=\"info-content\">{{ info.content }}</div>\n            <a *ngIf=\"info.link\" class=\"info-link\" [href]=\"info.link\" target=\"_blank\" rel=\"noopener\">Open link</a>\n          </div>\n          <div class=\"timeline-item\" *ngFor=\"let item of timelineItems\">\n            @if (item.type === 'message' && item.message) {\n            <div class=\"message\" [attr.id]=\"getItemAnchorId(item.message.id, 'message')\"\n              [class.mine]=\"currentUserId && item.message.senderId.toString() === currentUserId\"\n              [class.pin-enabled]=\"isOrganizer\" (click)=\"openPinMenu(item.message, 'message', $event)\">\n              <div class=\"avatar\">\n                <img *ngIf=\"item.message.senderImage\" [src]=\"item.message.senderImage\" alt=\"Avatar\">\n                <div *ngIf=\"!item.message.senderImage\" class=\"placeholder\">\n                  {{ item.message.senderName.slice(0, 1) || '?' }}\n                </div>\n              </div>\n              <div class=\"content\">\n                <div class=\"meta\">\n                  <span class=\"name\">{{ item.message.senderName }}</span>\n                  <span class=\"time\">{{ formatTimestamp(item.message.createdAt) }}</span>\n                  @if (isOrganizer && activePinId === item.message.id && activePinType === 'message') {\n                  <div class=\"pin-menu\" (click)=\"$event.stopPropagation()\">\n                    <button class=\"pin-menu-btn\" type=\"button\"\n                      (click)=\"togglePinFromMenu(item.message, 'message', $event)\"\n                      [class.active]=\"isPinned(item.message.id, 'message')\"\n                      [class.unpin]=\"isPinned(item.message.id, 'message')\"\n                      [attr.aria-label]=\"isPinned(item.message.id, 'message') ? 'Unpin' : 'Pin message'\">\n                      <mat-icon>push_pin</mat-icon>\n                    </button>\n                  </div>\n                  }\n                </div>\n                <div class=\"text\">{{ item.message.content }}</div>\n              </div>\n            </div>\n            }\n            @if (item.type === 'poll' && item.poll) {\n            <div class=\"poll-message-card\" [attr.id]=\"getItemAnchorId(item.poll.id, 'poll')\"\n              [class.pin-enabled]=\"isOrganizer\" (click)=\"openPinMenu(item.poll, 'poll', $event)\">\n              <div class=\"poll-message-header\">\n                <div class=\"header-main\">\n                  <span class=\"poll-tag\">Sondaggio</span>\n                  <span class=\"time\">{{ formatTimestamp(item.poll.createdAt) }}</span>\n                </div>\n                @if (isOrganizer && activePinId === item.poll.id && activePinType === 'poll') {\n                <div class=\"pin-menu\" (click)=\"$event.stopPropagation()\">\n                  <button class=\"pin-menu-btn\" type=\"button\" (click)=\"togglePinFromMenu(item.poll, 'poll', $event)\"\n                    [class.active]=\"isPinned(item.poll.id, 'poll')\" [class.unpin]=\"isPinned(item.poll.id, 'poll')\"\n                    [attr.aria-label]=\"isPinned(item.poll.id, 'poll') ? 'Unpin' : 'Pin poll'\">\n                    <mat-icon>push_pin</mat-icon>\n                  </button>\n                </div>\n                }\n              </div>\n              <div class=\"poll-message-question\">{{ item.poll.question }}</div>\n              <div class=\"poll-bars\">\n                <div class=\"poll-bar-row\" *ngFor=\"let option of item.poll.options\"\n                  [class.selected]=\"pollSelections[item.poll.id]?.has(option.id)\" [class.closed]=\"item.poll.closed\"\n                  (click)=\"toggleVote(item.poll, option.id)\">\n                  <div class=\"poll-bar-label\">\n                    <span>{{ option.text }}</span>\n                    <span class=\"poll-bar-count\">{{ getPollOptionCount(option) }}</span>\n                  </div>\n                  <div class=\"poll-bar-track\">\n                    <div class=\"poll-bar-fill\" [style.width]=\"getPollBarWidth(item.poll, option)\"></div>\n                  </div>\n                </div>\n              </div>\n              <div class=\"poll-actions\">\n                <button *ngIf=\"isOrganizer\" class=\"pill ghost\" (click)=\"closePoll(item.poll)\"\n                  [disabled]=\"item.poll.closed\">\n                  Chiudi sondaggio\n                </button>\n              </div>\n              <div class=\"poll-total\">Totale voti: {{ getPollTotalVotes(item.poll) }}</div>\n            </div>\n            }\n          </div>\n          <div *ngIf=\"timelineItems.length === 0\" class=\"empty-state\">\n            Nessun messaggio ancora.\n          </div>\n        </div>\n\n        <div class=\"mute-banner\" *ngIf=\"isMuted\">\n          Sei stato mutato: puoi leggere ma non inviare messaggi.\n        </div>\n\n        <div class=\"message-input\">\n          <input [(ngModel)]=\"messageText\" placeholder=\"Scrivi un messaggio...\" (input)=\"messageError = ''\"\n            [disabled]=\"isMuted\" (keydown.enter)=\"sendMessage()\">\n          <button *ngIf=\"currentUserId\" class=\"add-btn\" (click)=\"openPollPopup()\" [disabled]=\"isMuted\">\n            <mat-icon>add</mat-icon>\n          </button>\n          <button class=\"send-btn\" (click)=\"sendMessage()\" [disabled]=\"isMuted || !messageText.trim()\">\n            <mat-icon>send</mat-icon>\n          </button>\n        </div>\n        <div class=\"message-error\" *ngIf=\"messageError\">{{ messageError }}</div>\n\n      </div>\n    </div>\n\n    @if (showPollPopup) {\n    <div class=\"poll-popup-backdrop\" (click)=\"closePollPopup()\">\n      <div class=\"poll-popup\" (click)=\"$event.stopPropagation()\">\n        <div class=\"poll-popup-header\">\n          <span>Crea sondaggio</span>\n          <button class=\"icon-btn\" (click)=\"closePollPopup()\">\n            <mat-icon>close</mat-icon>\n          </button>\n        </div>\n        <div class=\"poll-create\">\n          <input [(ngModel)]=\"pollQuestion\" placeholder=\"Domanda del sondaggio\" class=\"poll-question-input\">\n\n          <div class=\"poll-options-list\">\n            <div class=\"poll-option-row\" *ngFor=\"let option of pollOptions; let i = index; trackBy: trackByIndex\">\n              <input [(ngModel)]=\"pollOptions[i]\" [placeholder]=\"'Opzione ' + (i + 1)\">\n              <button class=\"remove-option-btn\" (click)=\"removePollOption(i)\" *ngIf=\"pollOptions.length > 2\">\n                <mat-icon>remove_circle_outline</mat-icon>\n              </button>\n            </div>\n          </div>\n\n          <button class=\"add-option-pill\" (click)=\"addPollOption()\" *ngIf=\"pollOptions.length < 5\">\n            <mat-icon>add</mat-icon>\n            Aggiungi opzione\n          </button>\n\n          <div class=\"poll-error\" *ngIf=\"pollError\">{{ pollError }}</div>\n          <button class=\"pill create-poll-btn\" (click)=\"createPoll()\">Crea sondaggio</button>\n        </div>\n      </div>\n    </div>\n    }\n  </div>\n</div>", "/* src/components/event-chat-modal/event-chat-modal.css */\n.chat-backdrop {\n  position: fixed;\n  inset: 0;\n  background: var(--modal-backdrop-color);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 2000;\n  padding: 16px;\n  -webkit-backdrop-filter: blur(var(--modal-backdrop-blur));\n  backdrop-filter: blur(var(--modal-backdrop-blur));\n}\n.chat-container {\n  width: 100%;\n  max-width: 760px;\n  max-height: 90vh;\n  background: var(--modal-surface);\n  border-radius: var(--modal-radius);\n  box-shadow: var(--modal-shadow);\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  border: var(--modal-border);\n  color: #f5f5f5;\n}\n.close-btn {\n  background: none;\n  border: none;\n  color: #fff;\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.close-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n}\n@media (max-width: 768px) {\n  .chat-backdrop {\n    padding: 0;\n  }\n  .chat-container {\n    width: 100vw;\n    height: 100vh;\n    max-height: 100vh;\n    border-radius: 0;\n  }\n  .mobile-only {\n    display: inline-flex;\n  }\n  .close-btn {\n    display: none;\n  }\n  .title {\n    color: var(--color-accent);\n  }\n  .chat-header {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    position: relative;\n    padding: 16px;\n  }\n  .header-left {\n    width: 100%;\n    justify-content: center;\n    gap: 0;\n  }\n  .back-arrow {\n    position: absolute;\n    left: 16px;\n    margin-right: 0;\n  }\n  .header-text {\n    align-items: center;\n    text-align: center;\n  }\n}\n.chat-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 16px 20px;\n  border-bottom: var(--modal-header-border);\n}\n.header-left {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n.header-text {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n}\n.title {\n  font-weight: 700;\n  font-size: 18px;\n  color: #facc15;\n}\n.subtitle {\n  color: #bdbdbd;\n  font-size: 14px;\n}\n.icon-btn {\n  background: transparent;\n  border: none;\n  cursor: pointer;\n  color: #f0f0f0;\n  width: 36px;\n  height: 36px;\n  border-radius: 10px;\n  border: 1px solid rgba(255, 255, 255, 0.12);\n  display: grid;\n  place-items: center;\n  transition: background-color 0.15s ease, border-color 0.15s ease;\n}\n.icon-btn:hover {\n  background: rgba(255, 255, 255, 0.08);\n  border-color: rgba(255, 255, 255, 0.2);\n}\n.back-arrow {\n  cursor: pointer;\n  color: #fff;\n  font-size: 24px;\n  margin-right: 4px;\n  transition: color 0.2s;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.back-arrow:hover {\n  color: var(--color-accent);\n}\n.chat-body {\n  display: grid;\n  grid-template-columns: 1fr;\n  gap: 16px;\n  padding: 16px;\n  overflow: hidden;\n  flex: 1;\n  min-height: 0;\n  justify-content: center;\n}\n.chat-left {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n  min-height: 0;\n  height: 100%;\n}\n.pinned-toggle {\n  width: 100%;\n  background: rgba(255, 255, 255, 0.04);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  color: #f3f3f3;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 8px 12px;\n  cursor: pointer;\n  border-radius: 12px;\n}\n.pinned-title {\n  display: inline-flex;\n  align-items: center;\n  gap: 8px;\n  font-weight: 600;\n  font-size: 14px;\n}\n.pinned-toggle .chevron {\n  transition: transform 0.2s ease;\n}\n.pinned-toggle .chevron.open {\n  transform: rotate(180deg);\n}\n.pinned-bar {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  background: rgba(252, 195, 36, 0.12);\n  border: 1px solid rgba(252, 195, 36, 0.25);\n  border-radius: 12px;\n  padding: 10px 12px;\n  cursor: pointer;\n  transition: background-color 0.15s ease;\n}\n.pinned-bar:hover {\n  background: rgba(252, 195, 36, 0.18);\n}\n.pinned-bar .pin-icon {\n  color: var(--color-accent);\n  font-size: 20px;\n  flex-shrink: 0;\n}\n.pinned-content {\n  display: flex;\n  flex-direction: column;\n  gap: 2px;\n  flex: 1;\n  min-width: 0;\n}\n.pinned-sender {\n  font-size: 12px;\n  font-weight: 700;\n  color: var(--color-accent);\n}\n.pinned-text {\n  font-size: 13px;\n  color: #e6e6e6;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.unpin-btn {\n  background: transparent;\n  border: none;\n  color: #888;\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: background-color 0.15s ease, color 0.15s ease;\n}\n.unpin-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n  color: #fff;\n}\n.unpin-btn mat-icon {\n  font-size: 18px;\n  width: 18px;\n  height: 18px;\n}\n.pinned-list {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  margin-top: 8px;\n  margin-bottom: 4px;\n}\n.pinned-item {\n  background: rgba(255, 255, 255, 0.04);\n  border: 1px solid rgba(255, 255, 255, 0.08);\n  color: #f0f0f0;\n  border-radius: 12px;\n  padding: 8px 10px;\n  display: flex;\n  flex-direction: column;\n  gap: 2px;\n  text-align: left;\n  cursor: pointer;\n}\n.pinned-item:hover {\n  border-color: rgba(255, 255, 255, 0.2);\n  background: rgba(255, 255, 255, 0.08);\n}\n.pin-label {\n  font-size: 11px;\n  letter-spacing: 0.2px;\n  text-transform: uppercase;\n  color: var(--color-accent);\n}\n.pin-preview {\n  font-size: 13px;\n  color: #e6e6e6;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.messages {\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 16px;\n  padding: 16px;\n  overflow-y: auto;\n  scroll-behavior: smooth;\n  flex: 1;\n  border: 1px solid rgba(255, 255, 255, 0.06);\n  scrollbar-width: none;\n  -ms-overflow-style: none;\n}\n.messages::-webkit-scrollbar {\n  display: none;\n}\n.timeline-item {\n  margin-bottom: 14px;\n}\n.message {\n  display: flex;\n  gap: 12px;\n  margin-bottom: 14px;\n  align-items: flex-start;\n  position: relative;\n}\n.message.pin-enabled {\n  cursor: pointer;\n}\n.message.mine {\n  flex-direction: row-reverse;\n}\n.message.mine .content {\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n}\n.message.mine .meta {\n  justify-content: flex-end;\n}\n.message.mine .text {\n  text-align: right;\n}\n.avatar img,\n.avatar .placeholder {\n  width: 100%;\n  height: 100%;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: rgba(255, 255, 255, 0.1);\n  font-weight: 600;\n  pointer-events: none;\n}\n.content {\n  flex: 1;\n  max-width: 70%;\n  position: relative;\n}\n.meta {\n  display: flex;\n  gap: 8px;\n  font-size: 12px;\n  color: #9a9a9a;\n  margin-bottom: 4px;\n  align-items: center;\n}\n.name {\n  font-weight: 600;\n  color: #f2f2f2;\n}\n.text {\n  background: rgba(255, 255, 255, 0.08);\n  border-radius: 12px;\n  padding: 10px 12px;\n  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);\n  border: 1px solid rgba(255, 255, 255, 0.06);\n  display: inline-block;\n  width: auto;\n  max-width: 100%;\n}\n.message.mine .text {\n  background: rgba(252, 195, 36, 0.18);\n  border-color: rgba(252, 195, 36, 0.35);\n  color: #fdf7e0;\n}\n.pin-menu {\n  position: static;\n  z-index: 1;\n  display: inline-flex;\n  align-items: center;\n  margin-left: 6px;\n}\n.message.mine .pin-menu {\n  margin-right: 6px;\n  margin-left: 0;\n}\n.pin-menu-btn {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  width: 34px;\n  height: 30px;\n  border-radius: 0;\n  border: none;\n  background: transparent;\n  color: #ffffff;\n  cursor: pointer;\n  position: relative;\n}\n.pin-menu-btn.active {\n  color: var(--color-accent);\n  border-color: rgba(252, 195, 36, 0.5);\n}\n.pin-menu-btn mat-icon {\n  font-size: 22px;\n}\n.pin-menu-btn.unpin::after {\n  content: \"\";\n  position: absolute;\n  width: 18px;\n  height: 3px;\n  background: #000000;\n  border-radius: 2px;\n  transform: rotate(-35deg);\n}\n.pin-menu-btn.unpin {\n  color: #ffffff;\n}\n.info-message {\n  border-radius: 12px;\n  border: 1px solid rgba(255, 255, 255, 0.08);\n  background: rgba(255, 255, 255, 0.04);\n  padding: 10px 12px;\n  margin-bottom: 10px;\n}\n.info-label {\n  font-size: 11px;\n  text-transform: uppercase;\n  letter-spacing: 0.3px;\n  color: var(--color-accent);\n  margin-bottom: 4px;\n  font-weight: 700;\n}\n.info-content {\n  font-size: 13px;\n  color: #e6e6e6;\n  white-space: pre-wrap;\n}\n.info-link {\n  display: inline-flex;\n  margin-top: 6px;\n  font-size: 12px;\n  color: var(--color-accent);\n  text-decoration: none;\n}\n.info-link:hover {\n  text-decoration: underline;\n}\n.poll-message-card {\n  border-radius: 14px;\n  padding: 12px;\n  background: rgba(255, 255, 255, 0.06);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  transition: background-color 0.2s, border-color 0.2s;\n  position: relative;\n}\n.poll-message-card.pin-enabled {\n  cursor: pointer;\n}\n.poll-message-card.pin-enabled:hover {\n  background: rgba(255, 255, 255, 0.1);\n  border-color: rgba(252, 195, 36, 0.4);\n}\n.poll-message-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  font-size: 12px;\n  color: #b8b8b8;\n  margin-bottom: 8px;\n}\n.poll-message-header .header-main {\n  display: flex;\n  flex-direction: column;\n  gap: 2px;\n}\n.poll-tag {\n  background: rgba(252, 195, 36, 0.2);\n  color: var(--color-accent);\n  padding: 2px 8px;\n  border-radius: 999px;\n  font-weight: 600;\n  font-size: 11px;\n}\n.poll-message-question {\n  font-size: 16px;\n  font-weight: 700;\n  color: var(--color-accent);\n  margin-bottom: 12px;\n}\n.poll-bars {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n}\n.poll-bar-row {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  padding: 10px;\n  border-radius: 10px;\n  cursor: pointer;\n  transition: background-color 0.2s ease, border-color 0.2s ease;\n  border: 1px solid transparent;\n  background: rgba(255, 255, 255, 0.04);\n}\n.poll-bar-row:hover:not(.closed) {\n  background: rgba(255, 255, 255, 0.08);\n  border-color: rgba(255, 255, 255, 0.1);\n}\n.poll-bar-row.selected {\n  background: rgba(252, 195, 36, 0.12);\n  border-color: rgba(252, 195, 36, 0.3);\n}\n.poll-bar-row.closed {\n  cursor: default;\n  opacity: 0.8;\n}\n.poll-bar-label {\n  display: flex;\n  justify-content: space-between;\n  font-size: 12px;\n  color: #d8d8d8;\n}\n.poll-bar-track {\n  height: 8px;\n  border-radius: 999px;\n  background: rgba(255, 255, 255, 0.08);\n  overflow: hidden;\n}\n.poll-bar-fill {\n  height: 100%;\n  background: var(--color-accent);\n  box-shadow: 0 4px 10px rgba(252, 195, 36, 0.3);\n}\n.poll-actions {\n  display: flex;\n  gap: 8px;\n  margin-top: 14px;\n}\n.poll-total {\n  margin-top: 10px;\n  font-size: 11px;\n  color: #b0b0b0;\n}\n.empty-state {\n  color: #b3b3b3;\n  font-size: 14px;\n  text-align: center;\n  padding: 16px 0;\n}\n.mute-banner {\n  background: rgba(255, 96, 96, 0.15);\n  color: #ffb3b3;\n  padding: 10px 12px;\n  border-radius: 12px;\n  font-size: 13px;\n  border: 1px solid rgba(255, 96, 96, 0.3);\n}\n.message-input {\n  display: flex;\n  gap: 8px;\n}\n.message-error {\n  color: #ffb3b3;\n  font-size: 12px;\n  margin-top: 4px;\n}\n.message-input input {\n  flex: 1;\n  border-radius: 12px;\n  border: 1px solid rgba(255, 255, 255, 0.12);\n  padding: 10px 12px;\n  background: rgba(255, 255, 255, 0.04);\n  color: #f4f4f4;\n}\n.send-btn {\n  background: var(--color-accent);\n  color: #ffffff;\n  border: none;\n  border-radius: 12px;\n  padding: 0 16px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  box-shadow: 0 10px 20px rgba(252, 195, 36, 0.25);\n}\n.add-btn {\n  background: rgba(255, 255, 255, 0.08);\n  color: #f5f5f5;\n  border: 1px solid rgba(255, 255, 255, 0.12);\n  border-radius: 12px;\n  width: 42px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n}\n.add-btn:hover {\n  background: rgba(255, 255, 255, 0.14);\n}\n.poll-create .poll-question-input {\n  width: 100%;\n  border-radius: 12px;\n  border: 1px solid rgba(255, 255, 255, 0.12);\n  padding: 10px 12px;\n  margin-bottom: 20px;\n  background: rgba(255, 255, 255, 0.04);\n  color: #f4f4f4;\n  font-weight: 600;\n}\n.poll-options-list {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n  margin-bottom: 16px;\n}\n.poll-option-row {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n}\n.poll-option-row input {\n  flex: 1;\n  border-radius: 12px;\n  border: 1px solid rgba(255, 255, 255, 0.12);\n  padding: 8px 12px;\n  background: rgba(255, 255, 255, 0.04);\n  color: #f4f4f4;\n  font-size: 14px;\n}\n.remove-option-btn {\n  background: transparent;\n  border: none;\n  color: #ef4444;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 4px;\n  opacity: 0.7;\n  transition: opacity 0.2s;\n}\n.remove-option-btn:hover {\n  opacity: 1;\n}\n.add-option-pill {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  background: rgba(252, 195, 36, 0.1);\n  color: var(--color-accent);\n  border: 1px dashed var(--color-accent);\n  border-radius: 12px;\n  padding: 8px 16px;\n  cursor: pointer;\n  font-size: 13px;\n  font-weight: 600;\n  width: 100%;\n  justify-content: center;\n  margin-bottom: 20px;\n  transition: background-color 0.2s;\n}\n.add-option-pill:hover {\n  background: rgba(252, 195, 36, 0.15);\n}\n.create-poll-btn {\n  width: 100%;\n  padding: 12px !important;\n  font-weight: 700 !important;\n  font-size: 15px !important;\n  margin-top: 10px;\n}\n.pill {\n  border-radius: 999px;\n  border: none;\n  background: var(--color-accent);\n  color: #ffffff;\n  padding: 8px 14px;\n  cursor: pointer;\n  font-size: 12px;\n  box-shadow: 0 8px 18px rgba(252, 195, 36, 0.18);\n}\n.pill.ghost {\n  background: transparent;\n  color: #f5f5f5;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  box-shadow: none;\n}\n.pill.danger {\n  background: #d43d3d;\n  color: #fff;\n  box-shadow: none;\n}\n.poll-popup-backdrop {\n  position: fixed;\n  inset: 0;\n  background: var(--modal-backdrop-color);\n  -webkit-backdrop-filter: blur(var(--modal-backdrop-blur));\n  backdrop-filter: blur(var(--modal-backdrop-blur));\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 60;\n}\n.poll-popup {\n  width: min(460px, 92vw);\n  background: var(--modal-surface);\n  border-radius: var(--modal-radius);\n  border: var(--modal-border);\n  padding: 16px;\n  box-shadow: var(--modal-shadow);\n}\n.poll-popup-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 16px;\n}\n.poll-popup-header span {\n  font-weight: 700;\n  color: var(--color-accent);\n  font-size: 18px;\n}\n.poll-error {\n  color: #ffb3b3;\n  font-size: 12px;\n  margin-bottom: 8px;\n}\n.mobile-only {\n  display: none;\n}\n.avatar {\n  flex: 0 0 auto;\n  width: 36px;\n  height: 36px;\n  flex-shrink: 0;\n  position: relative;\n  z-index: 1;\n  display: block;\n}\n/*# sourceMappingURL=event-chat-modal.css.map */\n", "import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { ChatMessage } from '../models/chat-message';\nimport { ChatMute } from '../models/chat-mute';\nimport { ChatPoll } from '../models/chat-poll';\n\n@Injectable({ providedIn: 'root' })\nexport class ChatService {\n  private baseUrl = 'http://localhost:8080/api/events';\n  private moderationUrl = 'http://localhost:8080/api/moderation';\n\n  constructor(private http: HttpClient) { }\n\n  getMessages(eventId: number, userId?: string | number, limit = 100): Observable<ChatMessage[]> {\n    const params = new URLSearchParams();\n    if (userId !== undefined && userId !== null) {\n      params.set('userId', String(userId));\n    }\n    params.set('limit', String(limit));\n    return this.http.get<ChatMessage[]>(\n      `${this.baseUrl}/${eventId}/chat/messages?${params.toString()}`\n    );\n  }\n\n  sendMessage(eventId: number, userId: string | number, content: string): Observable<ChatMessage> {\n    return this.http.post<ChatMessage>(\n      `${this.baseUrl}/${eventId}/chat/messages?userId=${userId}`,\n      { content }\n    );\n  }\n\n  connect(eventId: number, userId: string | number, onEvent: (type: string, payload: any) => void): EventSource {\n    const source = new EventSource(`${this.baseUrl}/${eventId}/chat/stream?userId=${userId}`);\n    const handler = (type: string) => (event: MessageEvent) => {\n      onEvent(type, JSON.parse(event.data));\n    };\n    source.addEventListener('message', handler('message'));\n    source.addEventListener('poll', handler('poll'));\n    source.addEventListener('poll-vote', handler('poll-vote'));\n    source.addEventListener('poll-close', handler('poll-close'));\n    source.addEventListener('mute', handler('mute'));\n    return source;\n  }\n\n  getMuteStatus(eventId: number, userId: string | number): Observable<{ muted: boolean }> {\n    return this.http.get<{ muted: boolean }>(\n      `${this.baseUrl}/${eventId}/chat/mute-status?userId=${userId}`\n    );\n  }\n\n  getMutes(eventId: number, userId: string | number): Observable<ChatMute[]> {\n    return this.http.get<ChatMute[]>(\n      `${this.baseUrl}/${eventId}/chat/mutes?userId=${userId}`\n    );\n  }\n\n  muteUser(eventId: number, userId: string | number, targetUserId: number, reason?: string | null): Observable<ChatMute> {\n    return this.http.post<ChatMute>(\n      `${this.baseUrl}/${eventId}/chat/mutes?userId=${userId}`,\n      { targetUserId, reason }\n    );\n  }\n\n  unmuteUser(eventId: number, userId: string | number, targetUserId: number): Observable<void> {\n    return this.http.delete<void>(\n      `${this.baseUrl}/${eventId}/chat/mutes/${targetUserId}?userId=${userId}`\n    );\n  }\n\n  getPolls(eventId: number, userId: string | number): Observable<ChatPoll[]> {\n    return this.http.get<ChatPoll[]>(\n      `${this.baseUrl}/${eventId}/chat/polls?userId=${userId}`\n    );\n  }\n\n  createPoll(eventId: number, userId: string | number, question: string, options: string[], endsAt: string): Observable<ChatPoll> {\n    return this.http.post<ChatPoll>(\n      `${this.baseUrl}/${eventId}/chat/polls/open?userId=${userId}`,\n      { question, options, endsAt }\n    );\n  }\n\n  votePoll(eventId: number, pollId: number, userId: string | number, optionIds: number[]): Observable<ChatPoll> {\n    return this.http.post<ChatPoll>(\n      `${this.baseUrl}/${eventId}/chat/polls/${pollId}/votes?userId=${userId}`,\n      { optionIds }\n    );\n  }\n\n  closePoll(eventId: number, pollId: number, userId: string | number): Observable<ChatPoll> {\n    return this.http.post<ChatPoll>(\n      `${this.baseUrl}/${eventId}/chat/polls/${pollId}/close?userId=${userId}`,\n      {}\n    );\n  }\n\n  getBannedWords(): Observable<string[]> {\n    return this.http.get<string[]>(\n      `${this.moderationUrl}/banned-words`\n    );\n  }\n\n  checkMessage(content: string): Observable<{ banned: boolean }> {\n    return this.http.post<{ banned: boolean }>(\n      `${this.moderationUrl}/check`,\n      { content }\n    );\n  }\n}\n", "import { Component, ElementRef, EventEmitter, Input, OnChanges, OnDestroy, OnInit, Output, SimpleChanges, ViewChild } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { MatIconModule } from '@angular/material/icon';\nimport { ChatService } from '../../services/chat.service';\nimport { ChatMessage } from '../../models/chat-message';\nimport { ChatPoll, ChatPollOption } from '../../models/chat-poll';\nimport { ChatMute } from '../../models/chat-mute';\nimport { Event as LumoEvent } from '../../models/event';\nimport { User } from '../../models/user';\n\n@Component({\n  selector: 'event-chat-modal',\n  standalone: true,\n  imports: [CommonModule, FormsModule, MatIconModule],\n  templateUrl: './event-chat-modal.html',\n  styleUrl: './event-chat-modal.css'\n})\nexport class EventChatModalComponent implements OnInit, OnChanges, OnDestroy {\n  @Input() event!: LumoEvent;\n  @Input() currentUserId: string | null = null;\n  @Output() close = new EventEmitter<void>();\n  @ViewChild('messagesContainer') messagesContainer?: ElementRef<HTMLDivElement>;\n\n  messages: ChatMessage[] = [];\n  polls: ChatPoll[] = [];\n  mutes: ChatMute[] = [];\n  mutedUserIds = new Set<number>();\n  isMuted = false;\n  isOrganizer = false;\n\n  messageText = '';\n  pollQuestion = '';\n  pollOptions: string[] = ['', '', ''];\n  pollSelections: Record<number, Set<number>> = {};\n  pollError = '';\n  showPollPopup = false;\n  pinnedId: number | null = null;\n  pinnedType: 'message' | 'poll' | null = null;\n  pinnedItem: ChatMessage | ChatPoll | null = null;\n  activePinId: number | null = null;\n  activePinType: 'message' | 'poll' | null = null;\n  bannedPatterns: RegExp[] = [];\n  bannedRaw: string[] = [];\n  messageError = '';\n  timelineItems: Array<{ type: 'message' | 'poll'; createdAt: string; message?: ChatMessage; poll?: ChatPoll }> = [];\n  infoMessages: Array<{\n    key: 'time' | 'place' | 'rules' | 'link';\n    label: string;\n    content: string;\n    anchorId: string;\n    link?: string;\n  }> = [];\n\n  private eventSource: EventSource | null = null;\n\n  constructor(private chatService: ChatService) { }\n\n  ngOnInit(): void {\n    this.initializeChat();\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes['event'] || changes['currentUserId']) {\n      this.initializeChat();\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.persistMessages();\n    this.eventSource?.close();\n  }\n\n  onClose() {\n    this.close.emit();\n  }\n\n  openPollPopup() {\n    this.pollQuestion = '';\n    this.pollOptions = ['', '', ''];\n    this.pollError = '';\n    this.showPollPopup = true;\n  }\n\n  closePollPopup() {\n    this.showPollPopup = false;\n    this.pollError = '';\n  }\n\n  addPollOption() {\n    if (this.pollOptions.length < 5) {\n      this.pollOptions.push('');\n    }\n  }\n\n  removePollOption(index: number) {\n    if (this.pollOptions.length > 2) {\n      this.pollOptions.splice(index, 1);\n    }\n  }\n\n  trackByIndex(index: number, obj: any): any {\n    return index;\n  }\n\n  sendMessage() {\n    if (!this.currentUserId || !this.messageText.trim()) return;\n    const content = this.messageText.trim();\n    this.messageText = '';\n    if (this.isBannedMessage(content)) {\n      this.messageError = 'Messaggio non consentito.';\n      return;\n    }\n    this.messageError = '';\n    this.chatService.checkMessage(content).subscribe({\n      next: (res) => {\n        if (res?.banned) {\n          this.messageError = 'Messaggio non consentito.';\n          return;\n        }\n        this.chatService.sendMessage(this.event.id, this.currentUserId as string, content).subscribe({\n          next: (message) => {\n            this.addMessage(message);\n          },\n          error: (err) => {\n            const apiError = err?.error?.data?.content || err?.error?.error;\n            if (apiError) {\n              this.messageError = apiError;\n            }\n            console.error('Error sending message', err);\n          }\n        });\n      },\n      error: (err) => {\n        this.messageError = 'Messaggio non consentito.';\n        console.error('Error checking message', err);\n      }\n    });\n  }\n\n  createPoll() {\n    if (!this.currentUserId || !this.pollQuestion.trim()) return;\n    const options = this.pollOptions\n      .map(line => line.trim())\n      .filter(Boolean);\n    if (options.length < 2) {\n      this.pollError = 'Inserisci almeno due opzioni.';\n      return;\n    }\n    if (options.length > 5) {\n      this.pollError = 'Massimo 5 opzioni consentite.';\n      return;\n    }\n    const futureDate = new Date(Date.now() + 1000 * 60 * 60 * 24 * 365 * 10);\n    const endsAtIso = futureDate.toISOString().split('.')[0];\n\n    this.chatService.createPoll(this.event.id, this.currentUserId, this.pollQuestion.trim(), options, endsAtIso)\n      .subscribe({\n        next: (poll) => {\n          this.upsertPoll(poll);\n          this.pollQuestion = '';\n          this.pollOptions = ['', '', ''];\n          this.showPollPopup = false;\n          this.pollError = '';\n          this.loadPolls();\n        },\n        error: (err) => {\n          console.error('Error creating poll', err);\n          this.pollError = 'Errore nella creazione del sondaggio.';\n        }\n      });\n  }\n\n  toggleVote(poll: ChatPoll, optionId: number) {\n    if (!this.currentUserId || poll.closed) return;\n\n    this.chatService.votePoll(this.event.id, poll.id, this.currentUserId, [optionId]).subscribe({\n      next: (updated) => this.upsertPoll(updated),\n      error: (err) => console.error('Error voting poll', err)\n    });\n  }\n\n\n  closePoll(poll: ChatPoll) {\n    if (!this.currentUserId) return;\n    this.chatService.closePoll(this.event.id, poll.id, this.currentUserId).subscribe({\n      next: (updated) => this.upsertPoll(updated),\n      error: (err) => console.error('Error closing poll', err)\n    });\n  }\n\n  muteUser(user: User) {\n    if (!this.currentUserId) return;\n    this.chatService.muteUser(this.event.id, this.currentUserId, user.id).subscribe({\n      next: (mute) => {\n        this.mutes = [...this.mutes.filter(m => m.userId !== mute.userId), mute];\n        this.mutedUserIds.add(mute.userId);\n      },\n      error: (err) => console.error('Error muting user', err)\n    });\n  }\n\n  unmuteUser(user: User) {\n    if (!this.currentUserId) return;\n    this.chatService.unmuteUser(this.event.id, this.currentUserId, user.id).subscribe({\n      next: () => {\n        this.mutes = this.mutes.filter(m => m.userId !== user.id);\n        this.mutedUserIds.delete(user.id);\n      },\n      error: (err) => console.error('Error unmuting user', err)\n    });\n  }\n\n  isUserMuted(userId: number): boolean {\n    return this.mutedUserIds.has(userId);\n  }\n\n  getParticipants(): User[] {\n    return this.event.acceptedUsersList || [];\n  }\n\n  formatTimestamp(value: string): string {\n    if (!value) return '';\n    const date = new Date(value);\n    return date.toLocaleTimeString('it-IT', { hour: '2-digit', minute: '2-digit' });\n  }\n\n  formatDateTime(value: string): string {\n    if (!value) return '';\n    const date = new Date(value);\n    return date.toLocaleString('it-IT', { day: '2-digit', month: 'short', hour: '2-digit', minute: '2-digit' });\n  }\n\n  getOptionVoters(option: ChatPollOption): string {\n    if (!option.voters || option.voters.length === 0) return '';\n    return option.voters.map(voter => voter.userName).join(', ');\n  }\n\n  private rebuildTimelineItems() {\n    const items: Array<{ type: 'message' | 'poll'; createdAt: string; message?: ChatMessage; poll?: ChatPoll }> = [];\n    this.messages.forEach(message => items.push({ type: 'message', createdAt: message.createdAt, message }));\n    this.polls.forEach(poll => items.push({ type: 'poll', createdAt: poll.createdAt, poll }));\n    this.timelineItems = items.sort((a, b) => new Date(a.createdAt).getTime() - new Date(b.createdAt).getTime());\n  }\n\n  getPollTotalVotes(poll: ChatPoll): number {\n    return poll.options.reduce((sum, option) => sum + (option.voters?.length || 0), 0);\n  }\n\n  getPollOptionCount(option: ChatPollOption): number {\n    return option.voters?.length || 0;\n  }\n\n  getPollBarWidth(poll: ChatPoll, option: ChatPollOption): string {\n    const total = this.getPollTotalVotes(poll);\n    if (!total) return '0%';\n    const count = this.getPollOptionCount(option);\n    return `${Math.round((count / total) * 100)}%`;\n  }\n\n  getPinnedSenderName(): string {\n    if (!this.pinnedItem) return '';\n    if (this.pinnedType === 'poll') return 'Sondaggio';\n    return (this.pinnedItem as ChatMessage).senderName || 'Utente';\n  }\n\n  getPinnedDisplayText(): string {\n    if (!this.pinnedItem) return '';\n    if (this.pinnedType === 'poll') return (this.pinnedItem as ChatPoll).question;\n    return (this.pinnedItem as ChatMessage).content;\n  }\n\n  isPinned(id: number, type: 'message' | 'poll'): boolean {\n    return this.pinnedId === id && this.pinnedType === type;\n  }\n\n  openPinMenu(item: ChatMessage | ChatPoll, type: 'message' | 'poll', event: MouseEvent) {\n    if (!this.isOrganizer) return;\n    event.stopPropagation();\n    this.activePinId = item.id;\n    this.activePinType = type;\n  }\n\n  closePinMenu() {\n    this.activePinId = null;\n    this.activePinType = null;\n  }\n\n  togglePinFromMenu(item: ChatMessage | ChatPoll, type: 'message' | 'poll', event: MouseEvent) {\n    event.stopPropagation();\n    this.togglePin(item, type);\n    this.activePinId = null;\n    this.activePinType = null;\n  }\n\n  togglePin(item: ChatMessage | ChatPoll, type: 'message' | 'poll') {\n    if (this.pinnedId === item.id && this.pinnedType === type) {\n      this.pinnedId = null;\n      this.pinnedType = null;\n      this.pinnedItem = null;\n    } else {\n      this.pinnedId = item.id;\n      this.pinnedType = type;\n      this.pinnedItem = item;\n    }\n    this.persistPinnedItem();\n  }\n\n  scrollToItem(id: number, type: 'message' | 'poll') {\n    this.scrollToAnchor(this.getItemAnchorId(id, type));\n  }\n\n  scrollToAnchor(anchorId: string) {\n    const container = this.messagesContainer?.nativeElement;\n    if (!container) return;\n    const target = container.querySelector<HTMLElement>(`#${anchorId}`);\n    if (!target) return;\n    const containerTop = container.getBoundingClientRect().top;\n    const targetTop = target.getBoundingClientRect().top;\n    container.scrollTo({\n      top: container.scrollTop + targetTop - containerTop - 12,\n      behavior: 'smooth'\n    });\n  }\n\n  getItemAnchorId(id: number, type: 'message' | 'poll'): string {\n    return `chat-${type}-${id}`;\n  }\n\n  getMessageAnchorId(id: number): string {\n    return this.getItemAnchorId(id, 'message');\n  }\n\n  loadBannedWords() {\n    this.chatService.getBannedWords().subscribe({\n      next: (words) => this.buildBannedPatterns(words),\n      error: (err) => console.error('Error loading banned words', err)\n    });\n  }\n\n  private loadData() {\n    if (!this.currentUserId) return;\n\n    this.chatService.getMessages(this.event.id).subscribe({\n      next: (messages) => {\n        if (messages.length === 0 && this.messages.length > 0) {\n          return;\n        }\n        this.messages = messages;\n        this.refreshPinnedItem();\n        this.persistMessages();\n        this.rebuildTimelineItems();\n        this.scrollToBottom();\n      },\n      error: (err) => console.error('Error loading messages', err)\n    });\n\n    this.loadPolls();\n\n    this.chatService.getMuteStatus(this.event.id, this.currentUserId).subscribe({\n      next: (res) => (this.isMuted = res.muted),\n      error: (err) => console.error('Error loading mute status', err)\n    });\n\n    if (this.isOrganizer) {\n      this.chatService.getMutes(this.event.id, this.currentUserId).subscribe({\n        next: (mutes) => {\n          this.mutes = mutes;\n          this.mutedUserIds = new Set(mutes.map(m => m.userId));\n        },\n        error: (err) => console.error('Error loading mutes', err)\n      });\n    }\n  }\n\n  private connectStream() {\n    if (!this.currentUserId) return;\n    this.eventSource?.close();\n    this.eventSource = this.chatService.connect(this.event.id, this.currentUserId, (type, payload) => {\n      if (type === 'message') {\n        this.addMessage(payload as ChatMessage);\n      }\n      if (type === 'poll' || type === 'poll-vote' || type === 'poll-close') {\n        this.upsertPoll(payload as ChatPoll);\n      }\n      if (type === 'mute') {\n        const data = payload as { userId: number; muted: boolean };\n        if (data.muted) {\n          this.mutedUserIds.add(data.userId);\n        } else {\n          this.mutedUserIds.delete(data.userId);\n        }\n        if (this.currentUserId && Number(this.currentUserId) === data.userId) {\n          this.isMuted = data.muted;\n        }\n      }\n    });\n  }\n\n  private loadPolls() {\n    if (!this.currentUserId) return;\n    this.chatService.getPolls(this.event.id, this.currentUserId).subscribe({\n      next: (polls) => {\n        this.polls = polls;\n        polls.forEach(poll => this.syncPollSelections(poll));\n        this.rebuildTimelineItems();\n        this.scrollToBottom();\n      },\n      error: (err) => console.error('Error loading polls', err)\n    });\n  }\n\n  private toIsoLocal(input: string): string | null {\n    if (!input) return null;\n    if (input.includes('T')) return input;\n    const trimmed = input.trim();\n    const match = trimmed.match(/^(\\d{2})\\/(\\d{2})\\/(\\d{4})\\s+(\\d{2}):(\\d{2})$/);\n    if (!match) return null;\n    const [, dd, mm, yyyy, hh, min] = match;\n    return `${yyyy}-${mm}-${dd}T${hh}:${min}`;\n  }\n\n  private upsertPoll(updated: ChatPoll) {\n    const existingIndex = this.polls.findIndex(p => p.id === updated.id);\n    const isNew = existingIndex < 0;\n\n    if (!isNew) {\n      const next = [...this.polls];\n      next[existingIndex] = updated;\n      this.polls = next;\n    } else {\n      this.polls = [updated, ...this.polls];\n    }\n\n    this.syncPollSelections(updated);\n    this.rebuildTimelineItems();\n\n    if (isNew) {\n      this.scrollToBottom();\n    }\n  }\n\n  private syncPollSelections(poll: ChatPoll) {\n    if (!this.currentUserId) return;\n    const selection = new Set<number>();\n    poll.options.forEach(option => {\n      const hasVote = option.voters?.some(voter => voter.userId === Number(this.currentUserId));\n      if (hasVote) {\n        selection.add(option.id);\n      }\n    });\n    this.pollSelections[poll.id] = selection;\n  }\n\n  private addMessage(message: ChatMessage) {\n    if (!this.messages.some(existing => existing.id === message.id)) {\n      this.messages = [...this.messages, message];\n      this.refreshPinnedItem();\n      this.persistMessages();\n      this.rebuildTimelineItems();\n      this.scrollToBottom();\n    }\n  }\n\n  private initializeChat() {\n    if (!this.event) return;\n    this.messages = this.getCachedMessages();\n    this.loadPinnedItem();\n    this.buildInfoMessages();\n    this.rebuildTimelineItems();\n    this.activePinId = null;\n    this.activePinType = null;\n    this.loadBannedWords();\n    if (!this.currentUserId) return;\n    this.isOrganizer = this.event.creatorId?.toString() === this.currentUserId;\n    this.loadData();\n    this.connectStream();\n  }\n\n  private getCacheKeys(): string[] {\n    if (!this.event?.id) return [];\n    const keys = [`chat-cache:${this.event.id}`];\n    if (this.currentUserId) {\n      keys.push(`chat-cache:${this.event.id}:${this.currentUserId}`);\n    }\n    return keys;\n  }\n\n  private getCachedMessages(): ChatMessage[] {\n    const keys = this.getCacheKeys();\n    if (keys.length === 0) return [];\n    const map = new Map<number, ChatMessage>();\n    for (const key of keys) {\n      const raw = localStorage.getItem(key);\n      if (!raw) continue;\n      try {\n        const parsed = JSON.parse(raw) as ChatMessage[];\n        if (!Array.isArray(parsed)) continue;\n        parsed.forEach(message => {\n          if (message && typeof message.id === 'number') {\n            map.set(message.id, message);\n          }\n        });\n      } catch {\n        continue;\n      }\n    }\n    return Array.from(map.values()).sort((a, b) =>\n      new Date(a.createdAt).getTime() - new Date(b.createdAt).getTime()\n    );\n  }\n\n  private persistMessages() {\n    const keys = this.getCacheKeys();\n    if (keys.length === 0) return;\n    const payload = JSON.stringify(this.messages);\n    keys.forEach(key => localStorage.setItem(key, payload));\n  }\n\n  private pinnedStorageKey(): string | null {\n    if (!this.event?.id) return null;\n    return `chat-pins:${this.event.id}`;\n  }\n\n  private loadPinnedItem() {\n    const key = this.pinnedStorageKey();\n    if (!key) return;\n    const raw = localStorage.getItem(key);\n    if (!raw) {\n      this.pinnedId = null;\n      this.pinnedType = null;\n      this.pinnedItem = null;\n      return;\n    }\n    try {\n      const parsed = JSON.parse(raw) as { id: number; type: 'message' | 'poll' };\n      if (parsed && typeof parsed.id === 'number') {\n        this.pinnedId = parsed.id;\n        this.pinnedType = parsed.type;\n        this.refreshPinnedItem();\n      } else {\n        this.pinnedId = null;\n        this.pinnedType = null;\n        this.pinnedItem = null;\n      }\n    } catch {\n      this.pinnedId = null;\n      this.pinnedType = null;\n      this.pinnedItem = null;\n    }\n  }\n\n  private persistPinnedItem() {\n    const key = this.pinnedStorageKey();\n    if (!key) return;\n    if (this.pinnedId !== null && this.pinnedType !== null) {\n      localStorage.setItem(key, JSON.stringify({ id: this.pinnedId, type: this.pinnedType }));\n    } else {\n      localStorage.removeItem(key);\n    }\n  }\n\n  private refreshPinnedItem() {\n    if (this.pinnedId === null || this.pinnedType === null) {\n      this.pinnedItem = null;\n      return;\n    }\n    if (this.pinnedType === 'message') {\n      this.pinnedItem = this.messages.find(m => m.id === this.pinnedId) || null;\n    } else {\n      this.pinnedItem = this.polls.find(p => p.id === this.pinnedId) || null;\n    }\n  }\n\n  private buildInfoMessages() {\n    const info: Array<{\n      key: 'time' | 'place' | 'link';\n      label: string;\n      content: string;\n      anchorId: string;\n      link?: string;\n    }> = [];\n    const time = this.formatEventTime();\n    if (time) {\n      info.push({\n        key: 'time',\n        label: 'Time',\n        content: time,\n        anchorId: 'chat-info-time'\n      });\n    }\n    const place = this.formatEventPlace();\n    if (place) {\n      info.push({\n        key: 'place',\n        label: 'Location',\n        content: place,\n        anchorId: 'chat-info-place'\n      });\n    }\n    const mapLink = this.getMapLink();\n    if (mapLink) {\n      info.push({\n        key: 'link',\n        label: 'Map Link',\n        content: mapLink,\n        anchorId: 'chat-info-link',\n        link: mapLink\n      });\n    }\n    this.infoMessages = info;\n  }\n\n  private formatEventTime(): string {\n    if (!this.event) return '';\n    const date = this.event.date ? new Date(`${this.event.date}T00:00:00`) : null;\n    const start = this.event.startTime ? this.event.startTime.slice(0, 5) : '';\n    const end = this.event.endTime ? this.event.endTime.slice(0, 5) : '';\n    const datePart = date\n      ? date.toLocaleDateString('it-IT', { weekday: 'short', day: '2-digit', month: 'short' })\n      : '';\n    const timePart = [start, end].filter(Boolean).join(' - ');\n    return [datePart, timePart].filter(Boolean).join(' ');\n  }\n\n  private formatEventPlace(): string {\n    if (!this.event) return '';\n    if (this.event.city) return this.event.city;\n    if (Number.isFinite(this.event.latitude) && Number.isFinite(this.event.longitude)) {\n      return `${this.event.latitude.toFixed(5)}, ${this.event.longitude.toFixed(5)}`;\n    }\n    return '';\n  }\n\n  private getMapLink(): string {\n    if (!this.event) return '';\n    if (Number.isFinite(this.event.latitude) && Number.isFinite(this.event.longitude)) {\n      return `https://www.google.com/maps/search/?api=1&query=${this.event.latitude},${this.event.longitude}`;\n    }\n    if (this.event.city) {\n      return `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(this.event.city)}`;\n    }\n    return '';\n  }\n\n  private scrollToBottom() {\n    // Attende pi frame per evitare layout incompleti.\n    requestAnimationFrame(() => {\n      this.doScrollToBottom();\n      setTimeout(() => this.doScrollToBottom(), 50);\n      setTimeout(() => this.doScrollToBottom(), 150);\n    });\n  }\n\n  private doScrollToBottom() {\n    const container = this.messagesContainer?.nativeElement;\n    if (!container) return;\n    container.scrollTop = container.scrollHeight;\n  }\n\n  private buildBannedPatterns(words: string[]) {\n    this.bannedPatterns = [];\n    this.bannedRaw = [];\n    if (!Array.isArray(words)) return;\n    words.forEach(word => {\n      const normalized = this.normalizeContent(word);\n      if (!normalized) {\n        if (word) this.bannedRaw.push(word);\n        return;\n      }\n      this.bannedPatterns.push(this.buildPhrasePattern(normalized));\n    });\n  }\n\n  private isBannedMessage(content: string): boolean {\n    if (!content) return false;\n    for (const raw of this.bannedRaw) {\n      if (raw && content.includes(raw)) {\n        return true;\n      }\n    }\n    const normalized = this.normalizeContent(content);\n    if (!normalized) return false;\n    return this.bannedPatterns.some(pattern => pattern.test(normalized));\n  }\n\n  private normalizeContent(input: string): string {\n    if (!input) return '';\n    const lower = input.toLowerCase();\n    const leet = this.replaceLeet(lower);\n    const noDiacritics = leet.normalize('NFD').replace(/[\\u0300-\\u036f]+/g, '');\n    const cleaned = noDiacritics.replace(/[^a-z0-9]+/g, ' ').trim();\n    return cleaned.replace(/\\s+/g, ' ');\n  }\n\n  private replaceLeet(input: string): string {\n    const map: Record<string, string> = {\n      '@': 'a',\n      '0': 'o',\n      '1': 'i',\n      '!': 'i',\n      '3': 'e',\n      '4': 'a',\n      '5': 's',\n      '$': 's',\n      '7': 't',\n      '8': 'b'\n    };\n    return input\n      .split('')\n      .map(char => map[char] ?? char)\n      .join('');\n  }\n\n  private buildPhrasePattern(normalizedPhrase: string): RegExp {\n    const tokens = normalizedPhrase.split(/\\s+/).filter(Boolean);\n    const tokenPatterns = tokens.map(token => this.buildTokenPattern(token));\n    const joined = tokenPatterns.join('\\\\s+');\n    return new RegExp(`(?:^|\\\\s)${joined}(?:\\\\s|$)`);\n  }\n\n  private buildTokenPattern(token: string): string {\n    return token\n      .split('')\n      .map(char => this.escapeRegex(char))\n      .join('\\\\s*');\n  }\n\n  private escapeRegex(value: string): string {\n    return value.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n  }\n}\n", "import { Component, EventEmitter, Input, Output, OnInit } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MatIconModule } from '@angular/material/icon';\nimport { Event } from '../../models/event';\nimport { EventService } from '../../services/event.service';\nimport { ConfirmationService } from '../../services/confirmation.service';\nimport { EventCardComponent } from '../event-card/event-card.component';\nimport { EventShareModalComponent } from '../event-share-modal/event-share-modal.component';\nimport { EventChatModalComponent } from '../event-chat-modal/event-chat-modal';\nimport { User } from '../../models/user';\n\n@Component({\n    selector: 'app-my-events-modal',\n    standalone: true,\n    imports: [CommonModule, MatIconModule, EventCardComponent, EventShareModalComponent, EventChatModalComponent],\n    templateUrl: './my-events-modal.html',\n    styleUrl: './my-events-modal.css'\n})\nexport class MyEventsModal implements OnInit {\n    @Input() userId!: string | number;\n    @Output() close = new EventEmitter<void>();\n    @Output() focusLocal = new EventEmitter<Event>();\n\n    view: 'organized' | 'joined' = 'organized';\n\n    getViewTitle(): string {\n        if (this.expandedEventRequestsId) return 'Manage Requests';\n        if (this.activeTab === 'ORGANIZED') return 'My Events';\n        if (this.activeTab === 'JOINED') return 'Joined Events';\n        return 'Saved Events';\n    }\n\n    onBack() {\n        if (this.expandedEventRequestsId) {\n            this.expandedEventRequestsId = null;\n        } else {\n            this.close.emit();\n        }\n    }\n    activeTab: 'ORGANIZED' | 'JOINED' | 'SAVED' = 'ORGANIZED';\n    organizedEvents: Event[] = [];\n    joinedEvents: Event[] = [];\n    savedEvents: Event[] = [];\n    loading = false;\n    sharingEvent: Event | null = null;\n\n    // Stato per la vista richieste partecipazione.\n    expandedEventRequestsId: number | null = null;\n    showChatModal = false;\n    chatEvent: Event | null = null;\n\n    constructor(\n        private eventService: EventService,\n        private confirmation: ConfirmationService\n    ) { }\n\n    ngOnInit() {\n        this.loadData();\n    }\n\n    loadData() {\n        this.loading = true;\n        this.eventService.getOrganizedEvents(this.userId).subscribe({\n            next: (events) => this.organizedEvents = events,\n            error: (err) => console.error('Error loading organized events', err)\n        });\n\n        this.eventService.getJoinedEvents(this.userId).subscribe({\n            next: (events) => {\n                this.joinedEvents = events;\n            },\n            error: (err) => {\n                console.error('Error loading joined events', err);\n            }\n        });\n\n        this.eventService.getSavedEvents(this.userId).subscribe({\n            next: (events) => {\n                this.savedEvents = events.filter(this.isFutureEvent);\n                this.loading = false;\n            },\n            error: (err) => {\n                console.error('Error loading saved events', err);\n                this.loading = false;\n            }\n        });\n    }\n\n    private isFutureEvent = (event: Event): boolean => {\n        if (!event.date) return true;\n        const end = event.endTime || event.startTime || '23:59';\n        const eventDateTime = new Date(`${event.date}T${end}`);\n        return eventDateTime.getTime() >= Date.now();\n    };\n\n    switchTab(tab: 'ORGANIZED' | 'JOINED' | 'SAVED') {\n        this.activeTab = tab;\n        this.expandedEventRequestsId = null;\n    }\n\n    toggleRequests(eventId: number) {\n        if (this.expandedEventRequestsId === eventId) {\n            this.expandedEventRequestsId = null;\n        } else {\n            this.expandedEventRequestsId = eventId;\n        }\n    }\n\n    async deleteEvent(event: Event) {\n        const confirmed = await this.confirmation.confirm({\n            title: 'Delete event',\n            message: 'Are you sure you want to delete this event?',\n            confirmText: 'Delete',\n            cancelText: 'Cancel',\n            tone: 'danger'\n        });\n        if (!confirmed) return;\n\n        this.eventService.deleteEvent(event.id).subscribe({\n            next: () => {\n                this.organizedEvents = this.organizedEvents.filter(e => e.id !== event.id);\n                if (this.expandedEventRequestsId === event.id) {\n                    this.expandedEventRequestsId = null;\n                }\n            },\n            error: (err) => console.error('Error deleting event', err)\n        });\n    }\n\n    openChat(event: Event) {\n        this.chatEvent = event;\n        this.showChatModal = true;\n    }\n\n    closeChat() {\n        this.showChatModal = false;\n        this.chatEvent = null;\n    }\n\n    acceptRequest(event: Event, user: User) {\n        this.eventService.acceptParticipation(event.id, user.id).subscribe({\n            next: () => {\n                if (event.pendingUsersList) {\n                    event.pendingUsersList = event.pendingUsersList.filter(u => u.id !== user.id);\n                }\n\n                if (!event.acceptedUsersList) {\n                    event.acceptedUsersList = [];\n                }\n                event.acceptedUsersList.push(user);\n\n                event.acceptedUsersList.sort((u1, u2) => (u1.name || '').localeCompare(u2.name || ''));\n\n                event.occupiedSpots = (event.occupiedSpots || 0) + 1;\n            },\n            error: (err) => console.error('Error accepting', err)\n        });\n    }\n\n    rejectRequest(event: Event, user: User) {\n        this.eventService.rejectParticipation(event.id, user.id).subscribe({\n            next: () => {\n                if (event.pendingUsersList) {\n                    event.pendingUsersList = event.pendingUsersList.filter(u => u.id !== user.id);\n                }\n            },\n            error: (err) => console.error('Error rejecting', err)\n        });\n    }\n\n    async removeParticipant(event: Event, user: User) {\n        const confirmed = await this.confirmation.confirm({\n            title: 'Remove participant',\n            message: `Remove ${user.name} ${user.surname} from this event?`,\n            confirmText: 'Remove',\n            cancelText: 'Cancel',\n            tone: 'danger'\n        });\n        if (!confirmed) return;\n\n        this.eventService.removeParticipant(event.id, user.id, this.userId).subscribe({\n            next: () => {\n                if (event.acceptedUsersList) {\n                    event.acceptedUsersList = event.acceptedUsersList.filter(u => u.id !== user.id);\n                }\n                event.occupiedSpots = Math.max(0, (event.occupiedSpots || 0) - 1);\n            },\n            error: (err) => console.error('Error removing participant', err)\n        });\n    }\n\n    openShare(event: Event) {\n        this.sharingEvent = event;\n    }\n\n    goToEvent(event: Event) {\n        this.focusLocal.emit(event);\n    }\n\n    formatDateTime(event: Event): string {\n        const date = event.date ? new Date(`${event.date}T00:00:00`) : null;\n        const start = event.startTime ? event.startTime.slice(0, 5) : '';\n        const datePart = date ? date.toLocaleDateString('en-US', { day: '2-digit', month: 'short' }) : '';\n        return `${datePart} | ${start}`;\n    }\n}\n", "<div class=\"modal-backdrop\" (click)=\"onClose()\">\n    <div class=\"modal-container\" (click)=\"$event.stopPropagation()\">\n        <div class=\"modal-header\">\n            <button class=\"back-arrow\" [class.back-arrow--profile]=\"view === 'profile'\" type=\"button\"\n                (click)=\"onBackOrClose()\" [attr.aria-label]=\"view === 'profile' ? 'Close' : 'Back'\">\n                <mat-icon>arrow_back</mat-icon>\n            </button>\n            <div class=\"title-wrap\">\n                <h2 [class.yellow-title]=\"view !== 'profile'\">{{ getViewTitle() }}</h2>\n            </div>\n            <button class=\"close-btn close tablet-desktop-only\" (click)=\"onClose()\" aria-label=\"Close\">\n                <mat-icon>close</mat-icon>\n            </button>\n        </div>\n\n        <div class=\"account-content\" *ngIf=\"view === 'profile'\">\n            <div class=\"content-row\">\n                <div class=\"content-col left-col\">\n                    <div class=\"profile-section\">\n                        <div class=\"avatar-container\">\n                            @if (user?.profileImage) {\n                            <img [src]=\"user?.profileImage\" alt=\"Profile\" class=\"profile-image\">\n                            } @else {\n                            <div class=\"profile-placeholder\">{{ getInitials(user?.name || '') }}</div>\n                            }\n                            <button class=\"edit-photo-btn\" (click)=\"onChangePhoto()\">\n                                <mat-icon>edit</mat-icon>\n                            </button>\n                        </div>\n                        <h3 class=\"user-name\">{{ user?.name }}</h3>\n                        <p class=\"user-email\">\n                            <mat-icon>mail_outline</mat-icon>\n                            {{ getDiscreteEmail(user?.email) }}\n                        </p>\n                        <p class=\"user-description\">{{ user?.description || 'Find The Glow' }}</p>\n\n                        <div class=\"stats-container\">\n                            <div class=\"stat-item clickable\" (click)=\"showFollowers()\">\n                                <span class=\"stat-value\">{{ user?.followersCount || 0 }}</span>\n                                <span class=\"stat-label\">Followers</span>\n                            </div>\n                            <div class=\"stat-divider\"></div>\n                            <div class=\"stat-item clickable\" (click)=\"showFollowing()\">\n                                <span class=\"stat-value\">{{ user?.followingCount || 0 }}</span>\n                                <span class=\"stat-label\">Following</span>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class=\"actions-section\">\n                        <button class=\"action-btn\" (click)=\"showEditProfile()\">\n                            <mat-icon>settings</mat-icon>\n                            Edit Profile\n                        </button>\n                    </div>\n                </div>\n\n                <div class=\"vertical-divider\"></div>\n\n                <div class=\"content-col right-col\">\n                    <div class=\"share-section-embedded\">\n                        <span class=\"share-header\">Share Profile</span>\n                        <div class=\"qr-code-wrapper\">\n                            <img [src]=\"getQrCodeUrl()\" alt=\"Profile QR Code\">\n                        </div>\n                        <div class=\"share-details\">\n                            <div class=\"mini-link-group\">\n                                <button class=\"mini-copy-btn\" (click)=\"copyShareLink()\">\n                                    <mat-icon>content_copy</mat-icon>\n                                    Copy Link\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <div class=\"edit-profile-view\" *ngIf=\"view === 'edit-profile'\">\n\n\n            <div class=\"edit-content-layout\">\n                <div class=\"edit-section left-section\">\n                    <h4>Personal Information</h4>\n                    <div class=\"form-group\">\n                        <label>Name</label>\n                        <input [(ngModel)]=\"editData.name\" placeholder=\"Name\">\n                    </div>\n                    <div class=\"form-group\">\n                        <label>Email</label>\n                        <input [value]=\"editData.email\" readonly disabled class=\"readonly-input\">\n                    </div>\n                    <div class=\"form-group\">\n                        <label>Description</label>\n                        <textarea [(ngModel)]=\"editData.description\" placeholder=\"Description (e.g. Find The Glow)\"\n                            rows=\"3\"></textarea>\n                    </div>\n                    <button class=\"button\" (click)=\"onSaveProfile()\">Update Details</button>\n                </div>\n\n                <div class=\"vertical-divider\"></div>\n\n                <div class=\"edit-section right-section\">\n                    <h4>Change Password</h4>\n                    <div class=\"form-group\">\n                        <label>Current Password</label>\n                        <input type=\"password\" [(ngModel)]=\"passwordData.old\" placeholder=\"Current Password\">\n                    </div>\n                    <div class=\"form-group\">\n                        <label>New Password</label>\n                        <input type=\"password\" [(ngModel)]=\"passwordData.new\" placeholder=\"New Password\">\n                    </div>\n                    <div class=\"form-group\">\n                        <label>Confirm New Password</label>\n                        <input type=\"password\" [(ngModel)]=\"passwordData.confirm\" placeholder=\"Confirm Password\">\n                    </div>\n                    <button class=\"button\" (click)=\"onChangePassword()\">Change Password</button>\n                </div>\n            </div>\n        </div>\n\n        <div class=\"user-list-view\" *ngIf=\"view !== 'profile' && view !== 'edit-profile'\">\n\n            <div class=\"user-list\" *ngIf=\"!loadingList; else loadingTemplate\">\n                <div class=\"user-item\" *ngFor=\"let u of userList\">\n                    <div class=\"user-info\" (click)=\"openProfileFromList(u)\">\n                        <img *ngIf=\"u.profileImage\" [src]=\"u.profileImage\" class=\"list-avatar\">\n                        <div *ngIf=\"!u.profileImage\" class=\"list-avatar-placeholder\">{{ getInitials(u.name) }}</div>\n                        <span class=\"list-username\">{{ u.name }}</span>\n                    </div>\n\n                    <button *ngIf=\"view === 'following' || (view === 'followers' && followingIds.has(u.id.toString()))\"\n                        class=\"unfollow-btn\" (click)=\"onUnfollow(u)\">\n                        Unfollow\n                    </button>\n\n                    <button *ngIf=\"view === 'followers' && !followingIds.has(u.id.toString())\" class=\"follow-btn\"\n                        (click)=\"onFollow(u)\">\n                        Follow\n                    </button>\n                </div>\n                <div *ngIf=\"userList.length === 0\" class=\"empty-list\">\n                    No users found.\n                </div>\n            </div>\n\n            <ng-template #loadingTemplate>\n                <div class=\"loading-spinner\">Loading...</div>\n            </ng-template>\n        </div>\n    </div>\n</div>\n", "/* src/components/account-modal/account-modal.css */\n.modal-backdrop {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: var(--modal-backdrop-color);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 99999;\n  -webkit-backdrop-filter: blur(var(--modal-backdrop-blur));\n  backdrop-filter: blur(var(--modal-backdrop-blur));\n}\n.modal-container {\n  background: var(--modal-surface);\n  width: 800px;\n  max-width: 95vw;\n  height: auto;\n  border-radius: var(--modal-radius);\n  padding: 24px;\n  border: var(--modal-border);\n  box-shadow: var(--modal-shadow);\n  animation: slideUp 0.3s ease-out;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  box-sizing: border-box;\n}\n.edit-profile-view {\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  min-height: 0;\n  overflow: hidden;\n}\n.edit-content-layout {\n  display: flex;\n  flex-direction: row;\n  gap: 24px;\n  flex: 1;\n  overflow-y: auto;\n  padding: 5%;\n}\n.edit-content-layout::-webkit-scrollbar {\n  width: 6px;\n}\n.edit-content-layout::-webkit-scrollbar-thumb {\n  background-color: var(--color-gray);\n  border-radius: 3px;\n}\n@keyframes slideUp {\n  from {\n    transform: translateY(20px);\n    opacity: 0;\n  }\n  to {\n    transform: translateY(0);\n    opacity: 1;\n  }\n}\n.modal-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n}\n.modal-header h2 {\n  margin: 0;\n  font-size: 24px;\n  font-weight: 700;\n}\n.yellow-title {\n  color: var(--color-accent) !important;\n}\n.back-arrow {\n  background: none;\n  border: none;\n  color: var(--color-white);\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.back-arrow--profile {\n  display: none;\n}\n.back-arrow mat-icon {\n  font-size: 24px;\n  width: 24px;\n  height: 24px;\n}\n@media (max-width: 768px) {\n  .modal-header {\n    height: 70px;\n    position: relative;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    padding: 0 24px;\n    border-bottom: var(--modal-header-border);\n    margin-bottom: 0;\n  }\n  .title-wrap {\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    margin: 0;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    pointer-events: none;\n    z-index: 5;\n  }\n  .modal-header h2 {\n    font-size: 24px !important;\n    color: var(--color-accent) !important;\n    text-align: center;\n    margin: 0 !important;\n    width: auto !important;\n    height: 100% !important;\n    display: flex !important;\n    align-items: center !important;\n    justify-content: center !important;\n    line-height: normal !important;\n  }\n  .back-arrow {\n    position: absolute;\n    left: 24px;\n    cursor: pointer;\n    color: var(--color-white);\n    display: flex !important;\n    align-items: center;\n    justify-content: center;\n    z-index: 10;\n    height: 100%;\n    top: 0;\n  }\n  .back-arrow.back-arrow--profile {\n    display: flex !important;\n  }\n  .close {\n    position: absolute;\n    right: 24px;\n    z-index: 10;\n    display: none !important;\n  }\n}\n.account-content {\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  height: 100%;\n}\n.content-row {\n  display: flex;\n  flex-direction: row;\n  flex: 1;\n  gap: 24px;\n  align-items: stretch;\n}\n.content-col {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n}\n.left-col {\n  justify-content: space-between;\n  padding-bottom: 10px;\n}\n.right-col {\n  align-items: center;\n  justify-content: center;\n}\n.profile-section {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  text-align: center;\n  margin-bottom: auto;\n}\n.share-section-embedded {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 15px;\n  background: rgba(255, 255, 255, 0.03);\n  border-radius: 12px;\n  padding: 24px;\n  border: 1px solid rgba(255, 255, 255, 0.05);\n  width: 100%;\n  box-sizing: border-box;\n  height: 100%;\n  justify-content: center;\n}\n.vertical-divider {\n  width: 1px;\n  background: rgba(255, 255, 255, 0.1);\n}\n.edit-section {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 15px;\n}\n.qr-code-wrapper img {\n  width: 160px;\n  height: 160px;\n  display: block;\n}\n.section-divider {\n  display: none;\n}\n.modal-header h2 {\n  margin: 0;\n  color: var(--color-accent);\n  font-size: 20px;\n  font-weight: 600;\n}\n.close-btn {\n  background: none;\n  border: none;\n  color: #fff;\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.close-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n}\n.profile-section {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  text-align: center;\n}\n.avatar-container {\n  position: relative;\n  margin-bottom: 8px;\n}\n.profile-image {\n  width: 70px;\n  height: 70px;\n  border-radius: 50%;\n  object-fit: cover;\n  border: 2px solid var(--color-accent);\n}\n.profile-placeholder {\n  width: 70px;\n  height: 70px;\n  border-radius: 50%;\n  background: var(--color-gray);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 28px;\n  font-weight: 600;\n  color: var(--color-white);\n  border: 2px solid var(--color-accent);\n}\n.edit-photo-btn {\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  background: var(--color-accent);\n  color: black;\n  border: none;\n  width: 32px;\n  height: 32px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);\n  transition: transform 0.2s;\n}\n.edit-photo-btn:hover {\n  transform: scale(1.1);\n}\n.edit-photo-btn mat-icon {\n  font-size: 18px;\n  width: 18px;\n  height: 18px;\n}\n.user-name {\n  margin: 4px 0 0 0;\n  color: var(--color-white);\n  font-size: 24px;\n  font-weight: 700;\n  letter-spacing: -0.5px;\n  line-height: 1.1;\n}\n.user-email {\n  margin: 4px 0 0 0;\n  color: rgba(255, 255, 255, 0.5);\n  font-size: 13px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 6px;\n  font-weight: 400;\n}\n.user-email mat-icon {\n  font-size: 14px;\n  width: 14px;\n  height: 14px;\n  opacity: 0.8;\n}\n.user-description {\n  margin: 8px 0 0 0;\n  color: #e0e0e0;\n  font-size: 14px;\n  font-weight: 400;\n  line-height: 1.4;\n  max-width: 90%;\n  opacity: 0.9;\n}\n.form-group textarea {\n  background: rgba(255, 255, 255, 0.05) !important;\n  border: 1px solid var(--color-gray);\n  border-radius: 8px;\n  padding: 10px;\n  color: var(--color-white) !important;\n  font-size: 14px;\n  font-family: inherit;\n  resize: none;\n  min-height: 80px;\n}\n.stats-container {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 20px;\n  margin-top: 10px;\n  padding: 8px 0;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n  width: 100%;\n}\n.stat-item {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n}\n.stat-value {\n  font-size: 18px;\n  font-weight: 700;\n  color: var(--color-white);\n}\n.stat-label {\n  font-size: 12px;\n  color: var(--color-light-gray);\n}\n.stat-divider {\n  width: 1px;\n  height: 30px;\n  background: rgba(255, 255, 255, 0.1);\n}\n.actions-section {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n  margin-top: 15px;\n}\n.action-btn {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  padding: 10px 16px;\n  border-radius: 12px;\n  border: 1px solid var(--color-gray);\n  background: rgba(255, 255, 255, 0.05);\n  color: var(--color-white);\n  font-size: 15px;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n.action-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n  border-color: var(--color-light-gray);\n}\n.action-btn mat-icon {\n  color: var(--color-accent);\n}\n.stat-item.clickable {\n  cursor: pointer;\n  transition: opacity 0.2s;\n}\n.stat-item.clickable:hover {\n  opacity: 0.8;\n}\n.user-list-view {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n.list-header {\n  display: flex;\n  align-items: center;\n  margin-bottom: 20px;\n  gap: 10px;\n}\n.list-header h3 {\n  margin: 0;\n  color: var(--color-white);\n  font-size: 20px;\n}\n.back-btn {\n  background: none;\n  border: none;\n  color: var(--color-light-gray);\n  cursor: pointer;\n  padding: 0;\n  display: flex;\n  align-items: center;\n}\n.back-btn:hover {\n  color: var(--color-white);\n}\n.user-list {\n  display: flex;\n  flex-direction: column;\n  gap: 15px;\n  overflow-y: auto;\n  flex: 1;\n  padding-right: 5px;\n  scrollbar-width: none;\n}\n.user-list::-webkit-scrollbar {\n  display: none;\n}\n.user-item {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 8px;\n  border-radius: 8px;\n  background: rgba(255, 255, 255, 0.05);\n}\n.user-info {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  cursor: pointer;\n}\n.list-avatar {\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  object-fit: cover;\n}\n.list-avatar-placeholder {\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  background: var(--color-gray);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: var(--color-white);\n  font-size: 14px;\n  font-weight: 600;\n}\n.list-username {\n  color: var(--color-white);\n  font-size: 16px;\n  font-weight: 500;\n}\n.unfollow-btn {\n  background: transparent;\n  border: 1px solid var(--color-error, #ff4444);\n  color: #ffffff;\n  padding: 6px 12px;\n  border-radius: 4px;\n  font-size: 12px;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n.unfollow-btn:hover {\n  background: var(--color-error, #ff4444);\n  color: white;\n}\n.empty-list {\n  color: var(--color-light-gray);\n  text-align: center;\n  padding: 20px;\n}\n.loading-spinner {\n  color: var(--color-accent);\n  text-align: center;\n  padding: 20px;\n}\n.follow-btn {\n  background: var(--color-accent);\n  border: 1px solid var(--color-accent);\n  color: black;\n  padding: 6px 12px;\n  border-radius: 4px;\n  font-size: 12px;\n  cursor: pointer;\n  font-weight: 600;\n  transition: all 0.2s;\n}\n.follow-btn:hover {\n  opacity: 0.9;\n  transform: scale(1.05);\n}\n.edit-section h4 {\n  color: var(--color-accent);\n  margin: 0 0 5px 0;\n  font-size: 16px;\n  font-weight: 600;\n}\n.form-group {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n.form-group label {\n  color: var(--color-light-gray);\n  font-size: 12px;\n}\n.form-group input {\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid var(--color-gray);\n  border-radius: 8px;\n  padding: 10px;\n  color: var(--color-white);\n  font-size: 14px;\n}\n.form-group input.readonly-input {\n  opacity: 0.6;\n  cursor: not-allowed;\n  background: rgba(255, 255, 255, 0.02);\n}\n.form-group input:focus {\n  outline: none;\n  border-color: var(--color-accent);\n}\n.form-group textarea {\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid var(--color-gray);\n  border-radius: 8px;\n  padding: 10px;\n  color: var(--color-white);\n  font-size: 14px;\n  font-family: inherit;\n  resize: none;\n}\n.form-group textarea:focus {\n  outline: none;\n  border-color: var(--color-accent);\n}\n@media (max-width: 768px) {\n  .modal-container {\n    width: 100%;\n    max-width: 100%;\n    height: 100%;\n    max-height: 100vh;\n    border-radius: 0;\n    border: none;\n    overflow-y: auto;\n    padding: 0 0 80px 0;\n  }\n  .content-row,\n  .edit-content-layout {\n    flex-direction: column;\n    gap: 24px;\n    background:\n      linear-gradient(\n        160deg,\n        rgba(20, 20, 20),\n        rgba(12, 12, 12));\n  }\n  .vertical-divider {\n    display: none;\n  }\n  .content-col,\n  .left-col,\n  .right-col,\n  .edit-section {\n    width: 100%;\n    flex: none;\n    padding: 24px;\n    box-sizing: border-box;\n  }\n  .share-section-embedded {\n    padding: 20px;\n  }\n  .qr-code-wrapper img {\n    width: 140px;\n    height: 140px;\n  }\n  .profile-section {\n    margin-bottom: 24px;\n    padding: 0 8px;\n  }\n  .edit-section {\n    padding: 0 8px;\n  }\n  .user-list {\n    padding: 24px;\n  }\n}\n.share-header {\n  color: var(--color-white);\n  font-size: 14px;\n  font-weight: 500;\n  opacity: 0.8;\n}\n.qr-code-wrapper {\n  background: white;\n  padding: 6px;\n  border-radius: 10px;\n  flex-shrink: 0;\n}\n.share-details {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 10px;\n  width: 100%;\n}\n.mini-link-group {\n  display: flex;\n  justify-content: center;\n  width: 100%;\n}\n.mini-copy-btn {\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid var(--color-accent);\n  color: var(--color-accent);\n  border-radius: 8px;\n  padding: 8px 16px;\n  font-size: 14px;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  cursor: pointer;\n  transition: all 0.2s;\n  width: 100%;\n  justify-content: center;\n}\n.mini-copy-btn mat-icon {\n  font-size: 18px;\n  width: 18px;\n  height: 18px;\n}\n.mini-copy-btn:hover {\n  background: var(--color-accent);\n  color: black;\n}\n/*# sourceMappingURL=account-modal.css.map */\n", "import { Component, EventEmitter, Input, Output } from '@angular/core';\nimport { UserService } from '../../services/user-service/user-service';\nimport { ConfirmationService } from '../../services/confirmation.service';\nimport { CircleIcon } from '../circle-icon/circle-icon';\nimport { CommonModule } from '@angular/common';\nimport { MatIconModule } from '@angular/material/icon';\nimport { MatSnackBar, MatSnackBarModule } from '@angular/material/snack-bar';\nimport { FormsModule } from '@angular/forms';\n\nimport * as QRCode from 'qrcode';\n\n@Component({\n    selector: 'app-account-modal',\n    standalone: true,\n    imports: [CommonModule, MatIconModule, MatSnackBarModule, FormsModule],\n    templateUrl: './account-modal.html',\n    styleUrl: './account-modal.css'\n})\nexport class AccountModalComponent {\n    private _user: { id: string; name: string; email: string; description?: string; profileImage?: string; followersCount?: number; followingCount?: number } | null = null;\n    qrCodeUrl: string = '';\n\n    @Input()\n    set user(value: { id: string; name: string; email: string; description?: string; profileImage?: string; followersCount?: number; followingCount?: number } | null) {\n        this._user = value;\n        this.generateQrCode();\n    }\n    get user() {\n        return this._user;\n    }\n\n    @Output() close = new EventEmitter<void>();\n    @Output() changePhoto = new EventEmitter<void>();\n    @Output() openProfile = new EventEmitter<string>();\n\n    view: 'profile' | 'followers' | 'following' | 'edit-profile' = 'profile';\n    userList: any[] = [];\n    followingIds: Set<string> = new Set();\n    loadingList = false;\n\n    editData = { name: '', email: '', description: '' };\n    passwordData = { old: '', new: '', confirm: '' };\n\n    constructor(\n        private userService: UserService,\n        private confirmation: ConfirmationService,\n        private snackBar: MatSnackBar\n    ) { }\n\n    onClose() {\n        this.view = 'profile';\n        this.close.emit();\n    }\n\n    onBack() {\n        if (this.view !== 'profile') {\n            this.view = 'profile';\n        }\n    }\n\n    onBackOrClose() {\n        if (this.view !== 'profile') {\n            this.onBack();\n            return;\n        }\n        this.onClose();\n    }\n\n    getViewTitle(): string {\n        switch (this.view) {\n            case 'edit-profile': return 'Edit Profile';\n            case 'followers': return 'Followers';\n            case 'following': return 'Following';\n            default: return 'Account';\n        }\n    }\n\n    onChangePhoto() {\n        this.changePhoto.emit();\n    }\n\n    getInitials(name: string): string {\n        if (!name) return '';\n        return name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);\n    }\n\n    getDiscreteEmail(email: string | undefined): string {\n        if (!email) return '';\n        if (email.length <= 25) return email;\n        const parts = email.split('@');\n        if (parts.length !== 2) return email;\n        const [user, domain] = parts;\n        return `...${user.slice(-3)}@${domain}`;\n    }\n\n    showFollowers() {\n        if (!this.user) return;\n        const userId = this.user.id;\n        this.view = 'followers';\n        this.loadingList = true;\n\n        this.userService.getFollowers(userId).subscribe({\n            next: (followers) => {\n                this.userList = followers;\n\n                this.userService.getFollowing(userId).subscribe({\n                    next: (following) => {\n                        this.followingIds = new Set(following.map((u: any) => u.id.toString()));\n                        this.loadingList = false;\n                    },\n                    error: (err) => {\n                        console.error('Error fetching following list', err);\n                        this.loadingList = false;\n                    }\n                });\n            },\n            error: (err) => {\n                console.error(err);\n                this.loadingList = false;\n            }\n        });\n    }\n\n    showFollowing() {\n        if (!this.user) return;\n        this.view = 'following';\n        this.loadingList = true;\n        this.userService.getFollowing(this.user.id).subscribe({\n            next: (users) => {\n                this.userList = users;\n                this.loadingList = false;\n            },\n            error: (err) => {\n                console.error(err);\n                this.loadingList = false;\n            }\n        });\n    }\n\n    onFollow(userToFollow: any) {\n        if (!this.user) return;\n        this.userService.followUser(this.user.id, userToFollow.id).subscribe({\n            next: () => {\n                this.followingIds.add(userToFollow.id.toString());\n                if (this.user) {\n                    this.user.followingCount = (this.user.followingCount || 0) + 1;\n                }\n                this.userService.notifyUserUpdate();\n            },\n            error: (err) => console.error(err)\n        });\n    }\n\n    async onUnfollow(userToUnfollow: any) {\n        if (!this.user) return;\n        const confirmed = await this.confirmation.confirm({\n            title: 'Unfollow user',\n            message: `Are you sure you want to unfollow ${userToUnfollow.name}?`,\n            confirmText: 'Unfollow',\n            cancelText: 'Cancel',\n            confirmClass: 'white-text'\n        });\n        if (!confirmed) return;\n\n        this.userService.unfollowUser(this.user.id, userToUnfollow.id).subscribe({\n            next: () => {\n                if (this.view === 'following') {\n                    this.userList = this.userList.filter(u => u.id !== userToUnfollow.id);\n                } else {\n                    this.followingIds.delete(userToUnfollow.id.toString());\n                }\n\n                if (this.user) {\n                    this.user.followingCount = (this.user.followingCount || 1) - 1;\n                }\n                this.userService.notifyUserUpdate();\n            },\n            error: (err) => console.error(err)\n        });\n    }\n\n    openProfileFromList(userToOpen: any) {\n        if (!userToOpen?.id) return;\n        this.view = 'profile';\n        this.openProfile.emit(userToOpen.id.toString());\n    }\n\n    showEditProfile() {\n        if (!this.user) return;\n        this.view = 'edit-profile';\n        this.editData = {\n            name: this.user.name,\n            email: this.user.email,\n            description: this.user.description || ''\n        };\n        this.passwordData = { old: '', new: '', confirm: '' };\n    }\n\n    onSaveProfile() {\n        if (!this.user) return;\n        this.userService.updateUser(this.user.id, this.editData).subscribe({\n            next: (updatedUser) => {\n                if (this.user) {\n                    this.user.name = updatedUser.name;\n                    this.user.email = updatedUser.email;\n                    this.user.description = updatedUser.description;\n                }\n                this.showToast('Profile updated successfully');\n                this.userService.notifyUserUpdate();\n            },\n            error: (err) => {\n                console.error(err);\n                this.showToast('Failed to update profile', 'error');\n            }\n        });\n    }\n\n    getShareLink(): string {\n        if (!this.user) return '';\n        const protocol = window.location.protocol;\n        const host = window.location.host;\n        return `${protocol}//${host}/?user=${this.user.id}`;\n    }\n\n    generateQrCode() {\n        if (!this.user) {\n            this.qrCodeUrl = '';\n            return;\n        }\n        const link = this.getShareLink();\n        QRCode.toDataURL(link, { width: 200, margin: 1, color: { dark: '#000000', light: '#ffffff' } })\n            .then(url => {\n                this.qrCodeUrl = url;\n            })\n            .catch(err => {\n                console.error('QR Code generation failed', err);\n                this.qrCodeUrl = '';\n            });\n    }\n\n    getQrCodeUrl(): string {\n        return this.qrCodeUrl;\n    }\n\n    copyShareLink() {\n        const link = this.getShareLink();\n        navigator.clipboard.writeText(link).then(() => {\n            this.showToast('Link copied to clipboard!');\n        }).catch(err => {\n            console.error('Failed to copy: ', err);\n            this.showToast('Unable to copy the link.', 'error');\n        });\n    }\n\n    onChangePassword() {\n        if (!this.user) return;\n        if (this.passwordData.new !== this.passwordData.confirm) {\n            this.showToast('New passwords do not match', 'error');\n            return;\n        }\n        if (!this.passwordData.old || !this.passwordData.new) {\n            this.showToast('Please fill in default fields', 'error');\n            return;\n        }\n\n        this.userService.changePassword(this.user.id, this.passwordData.old, this.passwordData.new).subscribe({\n            next: () => {\n                this.showToast('Password changed successfully');\n                this.passwordData = { old: '', new: '', confirm: '' };\n            },\n            error: (err) => {\n                console.error(err);\n                this.showToast('Failed to change password. Existing password may be incorrect.', 'error');\n            }\n        });\n    }\n\n    private showToast(message: string, tone: 'default' | 'error' = 'default') {\n        this.snackBar.open(message, undefined, {\n            duration: tone === 'error' ? 700 : 700,\n            horizontalPosition: 'center',\n            verticalPosition: 'top',\n            panelClass: tone === 'error' ? ['toast-snackbar', 'toast-snackbar--error'] : ['toast-snackbar']\n        });\n    }\n}\n", "import { Component, EventEmitter, Input, Output, ElementRef, HostListener, OnInit, OnDestroy, OnChanges, SimpleChanges } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MatIconModule } from '@angular/material/icon';\nimport { UserMenu } from '../user-menu/user-menu';\nimport { NotificationMenuComponent } from '../notification-menu/notification-menu';\nimport { NotificationService } from '../../services/notification.service';\nimport { interval, Subscription, switchMap } from 'rxjs';\nimport { MyEventsModal } from '../my-events-modal/my-events-modal.component';\nimport { AccountModalComponent } from '../account-modal/account-modal.component';\nimport { UserService } from '../../services/user-service/user-service';\nimport { Event as LumoEvent } from '../../models/event';\n\n@Component({\n    selector: 'app-action-bar',\n    standalone: true,\n    imports: [CommonModule, MatIconModule, UserMenu, NotificationMenuComponent, MyEventsModal, AccountModalComponent],\n    templateUrl: './action-bar.html',\n    styleUrl: './action-bar.css'\n})\nexport class ActionBarComponent implements OnInit, OnDestroy, OnChanges {\n    @Input() loggedUser: { id: string; name: string; email: string; profileImage?: string; followersCount?: number; followingCount?: number } | null = null;\n    @Output() action = new EventEmitter<string>();\n    @Output() openProfile = new EventEmitter<string>();\n    @Output() openChatFromNotification = new EventEmitter<number>();\n    @Output() openEventFromNotification = new EventEmitter<number>();\n    @Output() focusEvent = new EventEmitter<LumoEvent>();\n\n    showUserMenu = false;\n    showNotifications = false;\n    showMyEventsModal = false;\n    showAccountModal = false;\n    hasUnread = false;\n    private pollSubscription: Subscription | null = null;\n\n    constructor(\n        private notificationService: NotificationService,\n        private elementRef: ElementRef,\n        private userService: UserService\n    ) { }\n\n    ngOnInit() {\n        this.startPolling();\n    }\n\n    ngOnDestroy() {\n        this.stopPolling();\n    }\n\n    ngOnChanges() {\n        if (this.loggedUser) {\n            this.checkUnreadNotifications();\n            this.startPolling();\n        } else {\n            this.stopPolling();\n        }\n    }\n\n    private startPolling() {\n        if (this.pollSubscription) return;\n        if (!this.loggedUser) return;\n\n        this.pollSubscription = interval(5000).pipe(\n            switchMap(() => {\n                const requests = [];\n\n                if (this.loggedUser && !this.showNotifications) {\n                    requests.push(this.notificationService.getNotifications(this.loggedUser.id));\n                }\n\n                if (this.loggedUser) {\n                    this.userService.notifyUserUpdate();\n                }\n\n                if (requests.length > 0) {\n                    return this.notificationService.getNotifications(this.loggedUser!.id);\n                }\n                return [];\n            })\n        ).subscribe({\n            next: (notifications) => {\n                if (Array.isArray(notifications)) {\n                    this.hasUnread = notifications.some(n => !n.isRead);\n                }\n            },\n            error: (err) => console.error('Error polling notifications', err)\n        });\n    }\n\n    private stopPolling() {\n        if (this.pollSubscription) {\n            this.pollSubscription.unsubscribe();\n            this.pollSubscription = null;\n        }\n    }\n\n    @HostListener('document:click', ['$event'])\n    onClickOutside(event: MouseEvent) {\n        if (!this.elementRef.nativeElement.contains(event.target)) {\n            this.showUserMenu = false;\n            this.showNotifications = false;\n        }\n    }\n\n    checkUnreadNotifications() {\n        if (!this.loggedUser) return;\n        this.notificationService.getNotifications(this.loggedUser.id).subscribe({\n            next: (notifications) => {\n                this.hasUnread = notifications.some(n => !n.isRead);\n            },\n            error: (err) => console.error('Error fetching notifications status', err)\n        });\n    }\n\n    toggleUserMenu(event?: MouseEvent) {\n        if (event) event.stopPropagation();\n        this.showUserMenu = !this.showUserMenu;\n        this.showNotifications = false;\n    }\n\n    toggleNotifications(event: MouseEvent) {\n        event.stopPropagation();\n        this.showNotifications = !this.showNotifications;\n        this.showUserMenu = false;\n\n        if (this.showNotifications && this.loggedUser) {\n            this.notificationService.markAllAsRead(this.loggedUser.id).subscribe({\n                next: () => {\n                    this.hasUnread = false;\n                },\n                error: (err) => console.error('Error marking read', err)\n            });\n        } else if (!this.showNotifications && this.loggedUser) {\n            this.checkUnreadNotifications();\n        }\n    }\n\n    onMenuAction(actionName: string) {\n        if (actionName === 'my-events') {\n            this.showMyEventsModal = true;\n        } else if (actionName === 'account') {\n            this.showAccountModal = true;\n        } else {\n            this.action.emit(actionName);\n        }\n        this.showUserMenu = false;\n    }\n\n    onOpenProfileFromAccount(userId: string) {\n        this.showAccountModal = false;\n        this.openProfile.emit(userId);\n    }\n\n    onChangePhotoFromAccount() {\n        this.showAccountModal = false;\n        this.action.emit('change-photo');\n    }\n\n    onOpenChatFromNotification(eventId: number) {\n        this.showNotifications = false;\n        this.openChatFromNotification.emit(eventId);\n    }\n\n    onOpenEventFromNotification(eventId: number) {\n        this.showNotifications = false;\n        this.openEventFromNotification.emit(eventId);\n    }\n\n    onFocusEvent(event: LumoEvent) {\n        this.showMyEventsModal = false;\n        this.focusEvent.emit(event);\n    }\n\n    onAddEvent() {\n        this.action.emit('add-event');\n    }\n\n    getInitials(name: string): string {\n        if (!name) return '';\n        return name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);\n    }\n}\n", "<div class=\"crop-backdrop\">\n    <div class=\"crop-container\">\n        <div class=\"crop-header\">\n            <h3>Crop Image</h3>\n            <button class=\"close-btn\" (click)=\"close.emit()\">\n                <mat-icon>close</mat-icon>\n            </button>\n        </div>\n\n        <div class=\"canvas-wrapper\">\n            <canvas #canvas [width]=\"VIEWPORT_SIZE\" [height]=\"VIEWPORT_SIZE\" (mousedown)=\"onMouseDown($event)\"\n                (mousemove)=\"onMouseMove($event)\" (mouseup)=\"onMouseUp()\" (mouseleave)=\"onMouseUp()\"\n                (wheel)=\"onWheel($event)\">\n            </canvas>\n            <div class=\"overlay-guide\"></div>\n        </div>\n\n        <div class=\"controls\">\n            <span class=\"zoom-icon\" (click)=\"zoomOut()\" style=\"cursor: pointer\">\u2212</span>\n            <input type=\"range\" min=\"0.1\" max=\"5\" step=\"0.1\" [value]=\"scale\" (input)=\"onZoomChange($event)\">\n            <span class=\"zoom-icon\" (click)=\"zoomIn()\" style=\"cursor: pointer\">+</span>\n        </div>\n\n        <div class=\"actions\">\n            <button class=\"btn-cancel button\" (click)=\"close.emit()\">Cancel</button>\n            <button class=\"button\" (click)=\"crop()\">Save Photo</button>\n        </div>\n    </div>\n</div>\n", "/* src/components/crop-image-popup/crop-image-popup.css */\n.crop-backdrop {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n  background: var(--modal-backdrop-color);\n  -webkit-backdrop-filter: blur(var(--modal-backdrop-blur));\n  backdrop-filter: blur(var(--modal-backdrop-blur));\n  z-index: 1000;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  animation: fadeIn 0.2s ease-out;\n}\n.crop-container {\n  background: var(--modal-surface);\n  border-radius: var(--modal-radius);\n  padding: 24px;\n  width: 90%;\n  max-width: 400px;\n  border: var(--modal-border);\n  box-shadow: var(--modal-shadow);\n  display: flex;\n  flex-direction: column;\n  gap: 20px;\n  position: relative;\n}\n.crop-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.crop-header h3 {\n  margin: 0;\n  color: var(--color-white);\n  font-size: 18px;\n}\n.close-btn {\n  background: none;\n  border: none;\n  color: #fff;\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.close-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n}\n.canvas-wrapper {\n  position: relative;\n  width: 300px;\n  height: 300px;\n  margin: 0 auto;\n  border-radius: 12px;\n  overflow: hidden;\n  background: var(--color-gray);\n  cursor: move;\n}\n.overlay-guide {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  border: 1px solid var(--color-light-gray);\n  box-sizing: border-box;\n  pointer-events: none;\n  border-radius: 12px;\n}\n.controls {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  color: var(--color-light-gray);\n}\ninput[type=range] {\n  flex: 1;\n  accent-color: var(--color-accent);\n  height: 4px;\n  background: var(--color-light-gray);\n  border-radius: 2px;\n  appearance: none;\n}\ninput[type=range]::-webkit-slider-thumb {\n  -webkit-appearance: none;\n  width: 16px;\n  height: 16px;\n  background: var(--color-white);\n  border-radius: 50%;\n  cursor: pointer;\n}\n.actions {\n  display: flex;\n  justify-content: center;\n  gap: 12px;\n  margin-top: 10px;\n}\n.btn-cancel {\n  height: auto;\n  border: 1px solid var(--color-light-gray);\n  background: var(--color-dark-gray);\n}\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n    transform: scale(0.95);\n  }\n  to {\n    opacity: 1;\n    transform: scale(1);\n  }\n}\n/*# sourceMappingURL=crop-image-popup.css.map */\n", "import { Component, EventEmitter, Input, Output, ViewChild, ElementRef, AfterViewInit } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MatIconModule } from '@angular/material/icon';\n\n@Component({\n    selector: 'CropImagePopup',\n    standalone: true,\n    imports: [CommonModule, MatIconModule],\n    templateUrl: './crop-image-popup.html',\n    styleUrl: './crop-image-popup.css'\n})\nexport class CropImagePopup implements AfterViewInit {\n    @Input() imageFile!: File;\n    @Output() close = new EventEmitter<void>();\n    @Output() imageCropped = new EventEmitter<Blob>();\n\n    @ViewChild('canvas', { static: false }) canvasRef!: ElementRef<HTMLCanvasElement>;\n\n    private ctx!: CanvasRenderingContext2D;\n    private image = new Image();\n\n    scale = 1;\n    offsetX = 0;\n    offsetY = 0;\n    isDragging = false;\n    lastX = 0;\n    lastY = 0;\n\n    readonly VIEWPORT_SIZE = 300;\n    readonly OUTPUT_SIZE = 128;\n\n    ngAfterViewInit() {\n        const canvas = this.canvasRef.nativeElement;\n        this.ctx = canvas.getContext('2d')!;\n\n        const reader = new FileReader();\n        reader.onload = (e: any) => {\n            this.image.src = e.target.result;\n            this.image.onload = () => {\n                this.resetView();\n                this.draw();\n            };\n        };\n        reader.readAsDataURL(this.imageFile);\n    }\n\n    resetView() {\n        const scaleX = this.VIEWPORT_SIZE / this.image.width;\n        const scaleY = this.VIEWPORT_SIZE / this.image.height;\n        this.scale = Math.max(scaleX, scaleY);\n\n        this.offsetX = (this.VIEWPORT_SIZE - this.image.width * this.scale) / 2;\n        this.offsetY = (this.VIEWPORT_SIZE - this.image.height * this.scale) / 2;\n    }\n\n    draw() {\n        if (!this.ctx) return;\n\n        this.ctx.clearRect(0, 0, this.VIEWPORT_SIZE, this.VIEWPORT_SIZE);\n\n        this.ctx.fillStyle = '#000';\n        this.ctx.fillRect(0, 0, this.VIEWPORT_SIZE, this.VIEWPORT_SIZE);\n\n        this.ctx.save();\n        this.ctx.translate(this.offsetX, this.offsetY);\n        this.ctx.scale(this.scale, this.scale);\n        this.ctx.drawImage(this.image, 0, 0);\n        this.ctx.restore();\n    }\n\n    onMouseDown(e: MouseEvent) {\n        this.isDragging = true;\n        this.lastX = e.clientX;\n        this.lastY = e.clientY;\n    }\n\n    onMouseMove(e: MouseEvent) {\n        if (!this.isDragging) return;\n\n        const deltaX = e.clientX - this.lastX;\n        const deltaY = e.clientY - this.lastY;\n\n        this.offsetX += deltaX;\n        this.offsetY += deltaY;\n\n        this.lastX = e.clientX;\n        this.lastY = e.clientY;\n\n        this.draw();\n    }\n\n    onMouseUp() {\n        this.isDragging = false;\n    }\n\n    onWheel(e: WheelEvent) {\n        e.preventDefault();\n        const zoomSpeed = 0.001;\n        const newScale = this.scale - e.deltaY * zoomSpeed;\n\n        if (newScale > 0.1) {\n            this.scale = newScale;\n            this.draw();\n        }\n    }\n\n    onZoomChange(event: any) {\n        this.scale = parseFloat(event.target.value);\n        this.draw();\n    }\n\n    zoomIn() {\n        this.scale = Math.min(this.scale + 0.1, 5);\n        this.draw();\n    }\n\n    zoomOut() {\n        this.scale = Math.max(this.scale - 0.1, 0.1);\n        this.draw();\n    }\n\n    crop() {\n        const outputCanvas = document.createElement('canvas');\n        outputCanvas.width = this.OUTPUT_SIZE;\n        outputCanvas.height = this.OUTPUT_SIZE;\n        const outputCtx = outputCanvas.getContext('2d')!;\n\n        // Mappa la finestra di ritaglio da coordinate schermo a coordinate immagine.\n        const sourceX = (0 - this.offsetX) / this.scale;\n        const sourceY = (0 - this.offsetY) / this.scale;\n        const sourceWidth = this.VIEWPORT_SIZE / this.scale;\n        const sourceHeight = this.VIEWPORT_SIZE / this.scale;\n\n        outputCtx.drawImage(\n            this.image,\n            sourceX, sourceY, sourceWidth, sourceHeight,\n            0, 0, this.OUTPUT_SIZE, this.OUTPUT_SIZE\n        );\n\n        outputCanvas.toBlob((blob) => {\n            if (blob) {\n                this.imageCropped.emit(blob);\n            }\n        }, 'image/jpeg', 0.9);\n    }\n}\n", "<div class=\"backdrop\" (click)=\"onClose()\"></div>\n\n<div class=\"popup-container desktop\">\n    <div class=\"popup-content\">\n        <div class=\"mobile-header\">\n            <mat-icon (click)=\"onClose()\">arrow_back</mat-icon>\n            <h1>Create Event</h1>\n        </div>\n\n        <button class=\"close-btn close tablet-desktop-only\" (click)=\"onClose()\">\n            <mat-icon>close</mat-icon>\n        </button>\n\n        <div class=\"header desktop-header\">\n            <h1>Create Event</h1>\n            @if(generalError) {\n            <p class=\"error\">{{ generalError }}</p>\n            } @else if ((errors | keyvalue).length > 0) {\n            <p class=\"error\">{{ (errors | keyvalue)[0].value }}</p>\n            }\n        </div>\n\n        <form class=\"form\">\n            <div class=\"two-column single-column\">\n                <FormField [error]=\"hasError('title')\" [control]=\"$any(form.get('title'))\" [type]=\"'text'\"\n                    placeholder=\"Title\" />\n            </div>\n\n            <FormField [error]=\"hasError('description')\" [control]=\"$any(form.get('description'))\" [type]=\"'textarea'\"\n                placeholder=\"Description\" customClass=\"tall-field\" />\n\n            <div class=\"two-column\">\n                <FormField [error]=\"hasError('date')\" [control]=\"$any(form.get('date'))\" [type]=\"'date'\"\n                    placeholder=\"From\" />\n                <FormField [error]=\"hasError('endDate')\" [control]=\"$any(form.get('endDate'))\" [type]=\"'date'\"\n                    placeholder=\"To\" />\n            </div>\n\n            <div class=\"two-column\">\n                <FormField [error]=\"hasError('startTime')\" [control]=\"$any(form.get('startTime'))\" [type]=\"'time'\"\n                    placeholder=\"Start\" />\n                <FormField [error]=\"hasError('endTime')\" [control]=\"$any(form.get('endTime'))\" [type]=\"'time'\"\n                    placeholder=\"End\" />\n            </div>\n\n            <div class=\"two-column\">\n                <FormField [error]=\"hasError('nPartecipants')\" [control]=\"$any(form.get('nPartecipants'))\"\n                    [type]=\"'number'\" placeholder=\"Max Participants\" />\n                <FormField [error]=\"hasError('costPerPerson')\" [control]=\"$any(form.get('costPerPerson'))\"\n                    [type]=\"'number'\" [min]=\"0\" placeholder=\"Cost (\u20AC)\" />\n            </div>\n\n            <button type=\"button\" class=\"button location-btn\" (click)=\"selectLocationOnMap()\">\n                \uD83D\uDCCD {{ locationText }}\n            </button>\n\n            <button type=\"button\" class=\"button\" (click)=\"onSubmit()\">Create Event</button>\n        </form>\n    </div>\n</div>\n", "/* src/components/create-event-popup/create-event-popup.css */\n.backdrop {\n  position: fixed;\n  inset: 0;\n  background: var(--modal-backdrop-color);\n  -webkit-backdrop-filter: blur(var(--modal-backdrop-blur));\n  backdrop-filter: blur(var(--modal-backdrop-blur));\n  z-index: var(--z-backdrop);\n}\n.popup-container.desktop {\n  position: fixed;\n  inset: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: var(--z-popup);\n}\n.popup-container.desktop .popup-content {\n  position: relative;\n  align-items: center;\n  width: 45%;\n  max-height: 95vh;\n  background: var(--modal-surface);\n  border-radius: var(--modal-radius);\n  border: var(--modal-border);\n  display: flex;\n  flex-direction: column;\n  overflow: visible;\n}\n.close-btn {\n  background: none;\n  border: none;\n  color: #fff;\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.close-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n}\n.close {\n  position: absolute;\n  top: 20px;\n  right: 20px;\n}\n.header {\n  padding: 20px 0 10px 0;\n  text-align: center;\n  width: 100%;\n}\n.form {\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  gap: var(--spacing-lg);\n  padding: 0 8% 24px;\n  box-sizing: border-box;\n}\n.form > * {\n  width: 100%;\n}\n.two-column {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: var(--spacing-md);\n  width: 100%;\n}\n.single-column {\n  grid-template-columns: 1fr;\n}\n.three-column {\n  display: grid;\n  grid-template-columns: repeat(3, minmax(0, 1fr));\n  gap: var(--spacing-md);\n  width: 100%;\n}\n.tall-field {\n  min-height: 80px;\n}\n.tall-field > * {\n  height: 100%;\n}\n.description-row {\n  width: 100%;\n  min-height: 80px;\n}\n.description-row > * {\n  height: 100%;\n}\n.time-section {\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  gap: var(--spacing-sm);\n}\n.section-label {\n  font-size: 14px;\n  font-weight: var(--font-weight-semibold);\n  color: var(--color-light-gray);\n  margin: 0;\n}\n.time-inputs {\n  display: flex;\n  align-items: center;\n  gap: var(--spacing-md);\n  width: 100%;\n}\n.time-inputs > * {\n  flex: 1;\n}\n.time-separator {\n  font-size: 18px;\n  color: var(--color-light-gray);\n  padding: 0 var(--spacing-xs);\n}\n.location-section {\n  display: flex;\n  flex-direction: column;\n  gap: var(--spacing-sm);\n  width: 100%;\n}\n.location-btn {\n  background-color: var(--color-gray);\n  width: 100%;\n  border: 2px solid rgba(255, 255, 255, 0.12);\n  box-sizing: border-box;\n}\n.location-btn:hover {\n  filter: brightness(1.2);\n}\n.error {\n  color: var(--color-error);\n  font-size: 18px;\n  margin: 0;\n}\n.mobile-back,\n.mobile-header {\n  display: none;\n}\n@media (max-width: 767px) {\n  .popup-container.desktop {\n    width: 100vw;\n    height: 100vh;\n    max-width: none;\n    max-height: none;\n    border-radius: 0;\n    inset: 0;\n    z-index: var(--z-popup);\n  }\n  .popup-container.desktop .popup-content {\n    position: fixed;\n    width: 100%;\n    height: 100%;\n    max-width: none;\n    max-height: none;\n    border-radius: 0;\n    border: none;\n    justify-content: flex-start;\n    background: var(--modal-surface);\n    overflow-y: auto;\n  }\n  .three-column {\n    display: grid;\n    grid-template-columns: repeat(3, minmax(0, 1fr));\n    gap: var(--spacing-md);\n  }\n  .form-field input,\n  .form-field select,\n  .form-field textarea {\n    min-height: 50px;\n    font-size: 18px;\n  }\n  .button {\n    height: 60px;\n    font-size: 16px;\n  }\n  .close,\n  .desktop-header,\n  .mobile-back {\n    display: none;\n  }\n  .mobile-header {\n    display: flex;\n  }\n  .form {\n    background:\n      linear-gradient(\n        160deg,\n        rgba(20, 20, 20, 0.96),\n        rgba(12, 12, 12, 0.98));\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    gap: var(--spacing-lg);\n    padding: 0 10%;\n    height: 100%;\n  }\n  .two-column {\n    grid-template-columns: repeat(2, minmax(0, 1fr));\n    box-sizing: border-box;\n  }\n  .two-column > * {\n    min-width: 0;\n  }\n  .two-column.single-column {\n    grid-template-columns: 1fr;\n  }\n}\n/*# sourceMappingURL=create-event-popup.css.map */\n", "import { Component, EventEmitter, Output } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormBuilder, FormGroup, Validators, ReactiveFormsModule } from '@angular/forms';\nimport { FormField } from '../form-field/form-field';\nimport { HttpClient } from '@angular/common/http';\n\nimport { MatIconModule } from '@angular/material/icon';\nimport { MapboxService } from '../../services/mapbox.service';\n\n@Component({\n    selector: 'create-event-popup',\n    standalone: true,\n    imports: [CommonModule, FormField, ReactiveFormsModule, MatIconModule],\n    templateUrl: './create-event-popup.html',\n    styleUrl: './create-event-popup.css'\n})\nexport class CreateEventPopup {\n    @Output() close = new EventEmitter<void>();\n    @Output() eventCreated = new EventEmitter<any>();\n    @Output() openLocationSelector = new EventEmitter<void>();\n\n    form: FormGroup;\n    generalError = '';\n    errors: any = {};\n\n    latitude: number | null = null;\n    longitude: number | null = null;\n    locationText = 'Select position on map';\n    selectedCity: string | null = null;\n\n    constructor(private fb: FormBuilder, private http: HttpClient, private mapboxService: MapboxService) {\n        this.form = this.fb.group({\n            title: ['', Validators.required],\n            description: ['', Validators.required],\n            date: ['', Validators.required],\n            endDate: [''],\n            startTime: ['', Validators.required],\n            endTime: [''],\n            nPartecipants: ['', [Validators.required, Validators.min(1)]],\n            costPerPerson: ['', [Validators.min(0)]]\n        }, { validators: this.timeRangeValidator });\n    }\n\n    private timeRangeValidator(group: FormGroup) {\n        const start = group.get('startTime')?.value;\n        const end = group.get('endTime')?.value;\n\n        if (start && end) {\n            const [h1, m1] = start.split(':').map(Number);\n            const [h2, m2] = end.split(':').map(Number);\n\n            const startMinutes = h1 * 60 + m1;\n            const endMinutes = h2 * 60 + m2;\n\n            if (endMinutes <= startMinutes) {\n                return { timeOrder: true };\n            }\n\n            if (endMinutes - startMinutes < 60) {\n                return { minDuration: true };\n            }\n        }\n        return null;\n    }\n\n    onClose() {\n        this.close.emit();\n    }\n\n    submitAttempted = false;\n\n    hasError(field: string): boolean {\n        const control = this.form.get(field);\n        const isTimeField = field === 'startTime' || field === 'endTime';\n        const hasTimeError = this.form.errors?.['timeOrder'] || this.form.errors?.['minDuration'];\n\n        return !!(this.submitAttempted && (control?.invalid || (isTimeField && hasTimeError)));\n    }\n\n    selectLocationOnMap() {\n        this.openLocationSelector.emit();\n    }\n\n    setLocation(lat: number, lng: number) {\n        this.latitude = lat;\n        this.longitude = lng;\n        this.selectedCity = null;\n        this.locationText = 'Location selected';\n\n        this.mapboxService.reverseGeocode(lat, lng).subscribe({\n            next: (city) => {\n                if (!city) return;\n                this.selectedCity = city;\n                this.locationText = `Location: ${city}`;\n            },\n            error: (err) => console.error('Error reverse geocoding city', err)\n        });\n    }\n\n    onSubmit() {\n        this.submitAttempted = true;\n        this.errors = {};\n        this.generalError = '';\n\n        Object.keys(this.form.controls).forEach(key => {\n            this.form.get(key)?.markAsTouched();\n        });\n\n        const controls = this.form.controls;\n        if (controls['title'].invalid) this.errors.title = 'Title is required.';\n        if (controls['description'].invalid) this.errors.description = 'Description is required.';\n        if (controls['date'].invalid) this.errors.date = 'Date is required.';\n        if (controls['startTime'].invalid) this.errors.startTime = 'Start time is required.';\n        if (controls['nPartecipants'].invalid) {\n            if (controls['nPartecipants'].errors?.['required']) {\n                this.errors.nPartecipants = 'Number of participants is required.';\n            } else if (controls['nPartecipants'].errors?.['min']) {\n                this.errors.nPartecipants = 'Number of participants must be at least 1.';\n            }\n        }\n        if (controls['costPerPerson'].invalid) {\n            if (controls['costPerPerson'].errors?.['min']) {\n                this.errors.costPerPerson = 'Cost cannot be negative.';\n            } else {\n                this.errors.costPerPerson = 'Invalid cost.';\n            }\n        }\n\n        if (this.form.errors?.['timeOrder']) {\n            this.errors.time = 'Start time must be before end time.';\n        } else if (this.form.errors?.['minDuration']) {\n            this.errors.time = 'Event must last at least one hour.';\n        }\n\n        if (this.latitude === null || this.longitude === null) {\n            this.errors.location = 'Select a location on the map.';\n        } else if (!this.selectedCity) {\n            this.errors.location = 'Unable to detect city from selected location.';\n        }\n\n        if (Object.keys(this.errors).length > 0) {\n            return;\n        }\n\n        const formValue = this.form.value;\n        const eventData = {\n            title: formValue.title,\n            description: formValue.description,\n            city: this.selectedCity,\n            date: formValue.date,\n            endDate: formValue.endDate || null,\n            startTime: formValue.startTime,\n            endTime: formValue.endTime,\n            nPartecipants: parseInt(formValue.nPartecipants),\n            costPerPerson: formValue.costPerPerson !== null && formValue.costPerPerson !== ''\n                ? Math.max(0, parseFloat(formValue.costPerPerson))\n                : null,\n            latitude: this.latitude,\n            longitude: this.longitude\n        };\n\n        const userJson = localStorage.getItem('user');\n        const userId = userJson ? JSON.parse(userJson).id : null;\n\n        this.http.post(`http://localhost:8080/api/events?userId=${userId}`, eventData).subscribe({\n            next: (response) => {\n                this.eventCreated.emit(response);\n                this.onClose();\n            },\n            error: (err) => {\n                console.error('Error creating event:', err);\n                this.generalError = 'Error creating event';\n            }\n        });\n    }\n}\n", "<div class=\"card-container\">\n  <div class=\"card-content\">\n    <div class=\"header-row\">\n      <div class=\"title-block\">\n        <h1 class=\"title\">{{ event.title }}</h1>\n        @if (event.city) {\n        <p class=\"subtitle\">\n          <mat-icon class=\"inline-icon\">place</mat-icon>\n          <span>{{ event.city }}</span>\n        </p>\n        } @else {\n        <p class=\"subtitle\">{{ getSubtitle() }}</p>\n        }\n        <p class=\"accent-date\">\n          <mat-icon class=\"inline-icon\">event</mat-icon>\n          <span>{{ formatHeroDate() }}</span>\n        </p>\n      </div>\n      <div class=\"action-icons\">\n        @if (hasCoordinates()) {\n        <button type=\"button\" class=\"action-icon map-icon\" (click)=\"openInMaps($event)\"\n          aria-label=\"Open in Google Maps\">\n          <mat-icon>map</mat-icon>\n        </button>\n        }\n        @if (!event.isParticipating) {\n        <button class=\"action-icon favorite-icon\" [class.saved]=\"isSaved()\"\n          (click)=\"toggleFavorite.emit(); $event.stopPropagation()\" aria-label=\"Save event\">\n          <mat-icon>{{ isSaved() ? 'favorite' : 'favorite_border' }}</mat-icon>\n          @if (event.savedCount !== undefined && event.savedCount !== null) {\n          <span class=\"favorite-count\">{{ event.savedCount }}</span>\n          }\n        </button>\n        }\n        <button class=\"action-icon share-icon\" (click)=\"shareEvent.emit(event); $event.stopPropagation()\"\n          aria-label=\"Share event\">\n          <mat-icon>share</mat-icon>\n        </button>\n        @if (currentUserId && !isOrganizer()) {\n        <button class=\"action-icon report-icon\" (click)=\"openReportModal(); $event.stopPropagation()\"\n          aria-label=\"Report event\">\n          <mat-icon>flag</mat-icon>\n        </button>\n        }\n      </div>\n    </div>\n\n    <div class=\"chip-row\">\n      <span class=\"chip\">\n        <mat-icon>group</mat-icon>\n        <span>{{ getActualParticipants() }} participants</span>\n      </span>\n      <span class=\"chip\" *ngIf=\"event.occupiedSpots !== undefined\">\n        <mat-icon>event_available</mat-icon>\n        <span>{{ event.nPartecipants - (event.occupiedSpots || 0) }} spots left</span>\n      </span>\n      <span class=\"chip\">\n        <mat-icon>euro</mat-icon>\n        <span>{{ formatCost() }}</span>\n      </span>\n    </div>\n\n    <p class=\"description\" *ngIf=\"showDescription()\">{{ event.description }}</p>\n\n    <div class=\"eventer-section\">\n      <div class=\"eventer-info\">\n        <button class=\"eventer-hit\" type=\"button\" (click)=\"onOrganizerClick(); $event.stopPropagation()\">\n          @if (organizerImage) {\n          <img [src]=\"organizerImage\" alt=\"Eventer\" class=\"organizer-avatar\">\n          } @else {\n          <div class=\"organizer-avatar placeholder\">{{ getInitials(organizerName) }}</div>\n          }\n          <div class=\"eventer-text\">\n            <span class=\"eventer-label\">Eventer</span>\n            <span class=\"eventer-name\">{{ organizerName }}</span>\n          </div>\n        </button>\n      </div>\n\n      @if (currentUserId && (creatorId || event.creatorId)) {\n      @if (currentUserId.toString() === (creatorId || event.creatorId)?.toString()) {\n      <span class=\"is-organizer-badge\">You</span>\n      } @else {\n      @if (!isFollowing && !isLoadingFollowStatus) {\n      <button class=\"icon-circle follow-btn-popup\" (click)=\"followOrganizer(); $event.stopPropagation()\">\n        <mat-icon>person_add</mat-icon>\n      </button>\n      } @else if (isFollowing) {\n      <div class=\"notify-toggle\">\n        <button class=\"icon-circle bell-btn\" [class.active]=\"notificationsEnabled\" [disabled]=\"notificationsLoading\"\n          (click)=\"toggleNotifications($event)\">\n          <mat-icon>{{ notificationsEnabled ? 'notifications' : 'notifications_off' }}</mat-icon>\n        </button>\n      </div>\n      }\n      }\n      }\n    </div>\n\n    @if (isOrganizer()) {\n    <div class=\"owner-note\">You cannot join your own event</div>\n    <button class=\"button cancel-btn\" type=\"button\" (click)=\"onDeleteEvent()\">Delete event</button>\n    } @else {\n    @if (event.participationStatus === 'ACCEPTED') {\n    <div class=\"participation-actions\">\n      <button class=\"button partecipa-btn accepted\" disabled>Joined</button>\n      <button class=\"button chat-btn\" type=\"button\" (click)=\"onOpenChat()\">Chat</button>\n      <button class=\"button leave-btn\" type=\"button\" (click)=\"onLeave()\">Leave</button>\n    </div>\n    } @else if (event.participationStatus === 'PENDING') {\n    <button class=\"button partecipa-btn pending\" disabled>Pending</button>\n    } @else {\n    <button class=\"button partecipa-btn\" (click)=\"onParticipate()\">Request to join</button>\n    }\n    }\n  </div>\n</div>\n\n@if (showReportModal && event) {\n<app-report-modal [reporterId]=\"currentUserId\" [targetType]=\"'EVENT'\" [targetId]=\"event.id ? event.id.toString() : null\"\n  [targetLabel]=\"event.title\" (close)=\"closeReportModal()\" (submitted)=\"closeReportModal()\">\n</app-report-modal>\n}\n", "/* src/components/event-popup-card/event-popup-card.css */\n.card-container {\n  position: absolute;\n  z-index: 900;\n  pointer-events: none;\n}\n.card-content {\n  position: relative;\n  width: 380px;\n  max-width: calc(100vw - 32px);\n  background:\n    radial-gradient(\n      circle at 15% 20%,\n      rgba(252, 195, 36, 0.18),\n      transparent 34%),\n    linear-gradient(\n      160deg,\n      #1a1a1a 0%,\n      #101010 55%,\n      #060606 100%);\n  border-radius: 18px;\n  padding: 22px;\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n  pointer-events: all;\n  box-shadow: 0 12px 30px rgba(0, 0, 0, 0.55);\n  border: 1px solid rgba(255, 255, 255, 0.08);\n  color: #f7f7f7;\n  white-space: normal;\n}\n.header-row {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  gap: 10px 12px;\n  flex-wrap: wrap;\n}\n.title-block {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n  flex: 1 1 220px;\n  min-width: 0;\n  padding-top: 54px;\n}\n.title {\n  margin: 0;\n  font-size: 32px;\n  font-weight: var(--font-weight-bold);\n  color: var(--color-white);\n  line-height: 1.05;\n  text-transform: uppercase;\n  letter-spacing: 0.4px;\n  word-break: break-word;\n  overflow-wrap: anywhere;\n}\n.subtitle {\n  margin: 0;\n  font-size: 18px;\n  font-weight: var(--font-weight-regular);\n  color: #e7e7e7;\n  line-height: 1.3;\n  display: inline-flex;\n  align-items: center;\n  gap: 6px;\n}\n.inline-icon {\n  font-size: 18px;\n  width: 18px;\n  height: 18px;\n  color: var(--color-accent);\n}\n.accent-date {\n  margin: 2px 0 6px;\n  font-size: 18px;\n  font-weight: var(--font-weight-bold);\n  color: var(--color-accent);\n  text-transform: lowercase;\n  display: inline-flex;\n  align-items: center;\n  gap: 6px;\n}\n.action-icons {\n  display: flex;\n  align-items: flex-start;\n  gap: 8px;\n  position: absolute;\n  top: 16px;\n  right: 16px;\n  flex-wrap: nowrap;\n  justify-content: flex-end;\n}\n.action-icon {\n  border: 1px solid rgba(255, 255, 255, 0.12);\n  background: rgba(255, 255, 255, 0.07);\n  border-radius: 14px;\n  width: 42px;\n  height: 42px;\n  display: grid;\n  place-items: center;\n  color: #d8d8d8;\n  cursor: pointer;\n  transition:\n    transform 0.15s ease,\n    box-shadow 0.15s ease,\n    border-color 0.15s ease,\n    background-color 0.15s ease;\n}\n.favorite-icon {\n  position: relative;\n}\n.favorite-count {\n  position: absolute;\n  top: 2px;\n  right: 2px;\n  min-width: 16px;\n  height: 16px;\n  padding: 0 4px;\n  border-radius: 999px;\n  background: rgba(12, 12, 12, 0.9);\n  border: 1px solid rgba(255, 255, 255, 0.22);\n  color: var(--color-accent);\n  font-size: 9px;\n  font-weight: var(--font-weight-bold);\n  display: grid;\n  place-items: center;\n  line-height: 1;\n}\n.action-icon:hover {\n  transform: translateY(-1px);\n  border-color: rgba(255, 255, 255, 0.2);\n  background: rgba(255, 255, 255, 0.1);\n}\n.favorite-icon.saved {\n  color: var(--color-accent);\n  border-color: rgba(252, 195, 36, 0.6);\n  box-shadow: 0 0 12px rgba(252, 195, 36, 0.28);\n}\n.action-icon mat-icon {\n  font-size: 22px;\n  width: 22px;\n  height: 22px;\n}\n.report-icon {\n  color: #ff8b8b;\n}\n.report-icon:hover {\n  border-color: rgba(255, 139, 139, 0.5);\n  background: rgba(255, 139, 139, 0.12);\n}\n.brand-pill {\n  align-self: flex-start;\n  padding: 6px 10px;\n  border-radius: 10px;\n  background: rgba(255, 255, 255, 0.08);\n  border: 1px solid rgba(255, 255, 255, 0.14);\n  color: var(--color-accent);\n  font-weight: var(--font-weight-bold);\n  font-size: 12px;\n  letter-spacing: 0.8px;\n}\n.chip-row {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 12px;\n  margin: 8px 0 6px;\n}\n.chip {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 6px 10px;\n  background: rgba(255, 255, 255, 0.08);\n  border: 1px solid rgba(255, 255, 255, 0.12);\n  border-radius: 999px;\n  color: #f5f5f5;\n  font-size: 11px;\n  line-height: 1.2;\n}\n.chip mat-icon {\n  font-size: 16px;\n  width: 16px;\n  height: 16px;\n  color: var(--color-accent);\n}\n.description {\n  margin: 6px 0 8px;\n  font-size: 15px;\n  font-weight: var(--font-weight-light);\n  color: #e6e6e6;\n  line-height: 1.6;\n}\n.eventer-section {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-top: 6px;\n}\n.eventer-info {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n.eventer-hit {\n  display: inline-flex;\n  align-items: center;\n  gap: 10px;\n  padding: 0;\n  border-radius: 0;\n  border: none;\n  background: transparent;\n  color: inherit;\n  cursor: pointer;\n  transition: opacity 0.15s ease;\n}\n.eventer-hit:hover {\n  opacity: 0.8;\n}\n.organizer-avatar {\n  width: 44px;\n  height: 44px;\n  border-radius: 50%;\n  object-fit: cover;\n  border: 1px solid rgba(255, 255, 255, 0.15);\n}\n.organizer-avatar.placeholder {\n  background: rgba(255, 255, 255, 0.1);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 16px;\n  font-weight: var(--font-weight-semibold);\n  color: var(--color-white);\n}\n.eventer-text {\n  display: flex;\n  flex-direction: column;\n  gap: 2px;\n  align-items: flex-start;\n  text-align: left;\n}\n.eventer-label {\n  font-size: 11px;\n  font-weight: var(--font-weight-regular);\n  color: #c7c7c7;\n  letter-spacing: 0.6px;\n  text-transform: uppercase;\n}\n.eventer-name {\n  font-size: 14px;\n  font-weight: var(--font-weight-semibold);\n  color: var(--color-white);\n}\n.is-organizer-badge {\n  padding: 8px 10px;\n  border-radius: 10px;\n  background: rgba(252, 195, 36, 0.18);\n  border: 1px solid rgba(252, 195, 36, 0.5);\n  color: #f8f1d2;\n  font-weight: var(--font-weight-semibold);\n  font-size: 12px;\n}\n.icon-circle {\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  background-color: rgba(255, 255, 255, 0.08);\n  border: 1px solid rgba(255, 255, 255, 0.12);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  cursor: pointer;\n  transition:\n    transform 0.15s ease,\n    background-color 0.15s ease,\n    border-color 0.15s ease;\n}\n.icon-circle:hover {\n  background-color: rgba(255, 255, 255, 0.14);\n  border-color: rgba(255, 255, 255, 0.2);\n}\n.icon-circle:active {\n  transform: scale(0.94);\n}\n.icon-circle mat-icon {\n  font-size: 18px;\n  width: 18px;\n  height: 18px;\n  color: #f0f0f0;\n}\n.follow-btn-popup.following {\n  background-color: var(--color-accent);\n  color: #0b0b0b;\n  border-color: var(--color-accent);\n}\n.partecipa-btn {\n  width: 100%;\n  margin-top: 16px;\n  background: var(--color-accent);\n  color: var(--color-white);\n  font-weight: var(--font-weight-bold);\n  border: none;\n  border-radius: 12px;\n  padding: 10px 16px;\n  font-size: 15px;\n  letter-spacing: 0.3px;\n  box-shadow: 0 8px 18px rgba(252, 195, 36, 0.25);\n  transition: filter 0.15s ease, transform 0.1s ease;\n}\n.partecipa-btn:hover {\n  filter: brightness(1.05);\n}\n.partecipa-btn:active {\n  transform: translateY(1px);\n}\n.partecipa-btn.pending {\n  background-color: #ffb84d;\n  color: #ffffff;\n  opacity: 0.95;\n}\n.partecipa-btn.accepted {\n  background-color: #4caf50;\n  color: #fff;\n  opacity: 0.95;\n}\n.partecipa-btn:disabled {\n  pointer-events: none;\n}\n.participation-actions {\n  display: flex;\n  gap: 10px;\n  margin-top: 16px;\n}\n.participation-actions .partecipa-btn {\n  width: auto;\n  margin-top: 0;\n  flex: 1 1 auto;\n}\n.chat-btn {\n  flex: 0 0 auto;\n  margin-top: 0;\n  padding: 10px 14px;\n  border-radius: 12px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  background: rgba(255, 255, 255, 0.08);\n  color: #f7f7f7;\n  font-weight: var(--font-weight-semibold);\n  letter-spacing: 0.2px;\n  transition:\n    background-color 0.15s ease,\n    border-color 0.15s ease,\n    transform 0.1s ease;\n}\n.chat-btn:hover {\n  background: rgba(255, 255, 255, 0.12);\n  border-color: rgba(255, 255, 255, 0.3);\n}\n.chat-btn:active {\n  transform: translateY(1px);\n}\n.leave-btn {\n  flex: 0 0 auto;\n  margin-top: 0;\n  padding: 10px 14px;\n  border-radius: 12px;\n  border: 1px solid rgba(255, 255, 255, 0.18);\n  background: transparent;\n  color: #f7f7f7;\n  font-weight: var(--font-weight-semibold);\n  letter-spacing: 0.2px;\n  transition:\n    background-color 0.15s ease,\n    border-color 0.15s ease,\n    transform 0.1s ease;\n}\n.leave-btn:hover {\n  background: rgba(255, 255, 255, 0.08);\n  border-color: rgba(255, 255, 255, 0.28);\n}\n.leave-btn:active {\n  transform: translateY(1px);\n}\n.owner-note {\n  margin-top: 16px;\n  padding: 12px 14px;\n  border-radius: 10px;\n  background: rgba(255, 255, 255, 0.08);\n  border: 1px solid rgba(255, 255, 255, 0.12);\n  color: #f0f0f0;\n  font-weight: var(--font-weight-semibold);\n  font-size: 14px;\n}\n.notify-toggle {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n}\n.bell-btn {\n  background: rgba(255, 255, 255, 0.08);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n}\n.bell-btn.active {\n  background: rgba(251, 188, 4, 0.16);\n  border-color: var(--color-accent);\n}\n.bell-btn:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n.notify-label {\n  font-size: 12px;\n  color: #cfcfcf;\n}\n.cancel-btn {\n  width: 100%;\n  margin-top: 10px;\n  background: #b61e1e;\n  color: #fff;\n  font-weight: var(--font-weight-semibold);\n  border: none;\n  border-radius: 12px;\n  padding: 10px 14px;\n  letter-spacing: 0.2px;\n  box-shadow: 0 8px 18px rgba(182, 30, 30, 0.35);\n  transition: filter 0.15s ease, transform 0.1s ease;\n}\n.cancel-btn:hover {\n  filter: brightness(1.05);\n}\n.cancel-btn:active {\n  transform: translateY(1px);\n}\n@media (max-width: 480px) {\n  .card-content {\n    width: calc(100vw - 24px);\n    padding: 18px;\n  }\n  .title-block {\n    padding-top: 0;\n    padding-right: 0;\n  }\n  .action-icons {\n    position: static;\n    flex-wrap: wrap;\n    justify-content: flex-start;\n  }\n  .title {\n    font-size: 26px;\n  }\n  .subtitle,\n  .accent-date {\n    font-size: 16px;\n  }\n}\n/*# sourceMappingURL=event-popup-card.css.map */\n", "<div class=\"report-backdrop\" (click)=\"onClose()\">\n    <div class=\"report-modal\" (click)=\"$event.stopPropagation()\">\n        <div class=\"report-header\">\n            <div>\n                <h3>Report {{ targetType === 'USER' ? 'user' : 'event' }}</h3>\n                @if (targetLabel) {\n                <p class=\"target-line\">You are reporting: <strong>{{ targetLabel }}</strong></p>\n                }\n            </div>\n            <button class=\"icon-btn\" type=\"button\" (click)=\"onClose()\">\n                <mat-icon>close</mat-icon>\n            </button>\n        </div>\n\n        <div class=\"report-body\">\n            <label class=\"field-label\">Main reason</label>\n            <input class=\"field-input\" type=\"text\" [(ngModel)]=\"reason\"\n                placeholder=\"E.g. Offensive language, scam, inappropriate behavior\">\n\n            <label class=\"field-label\">Details (optional)</label>\n            <textarea class=\"field-input field-textarea\" rows=\"4\" [(ngModel)]=\"details\"\n                placeholder=\"Add any other helpful details...\"></textarea>\n\n            <label class=\"field-label\">Image (optional)</label>\n            <div class=\"file-row\">\n                <input class=\"file-input\" type=\"file\" accept=\"image/*\" (change)=\"onFileSelected($event)\">\n                @if (imageName) {\n                <div class=\"file-chip\">\n                    <span>{{ imageName }}</span>\n                    <button type=\"button\" class=\"file-remove\" (click)=\"clearImage()\">\n                        <mat-icon>close</mat-icon>\n                    </button>\n                </div>\n                }\n            </div>\n        </div>\n\n        <div class=\"report-actions\">\n            <button class=\"button secondary\" type=\"button\" (click)=\"onClose()\">Cancel</button>\n            <button class=\"button\" type=\"button\" (click)=\"submitReport()\" [disabled]=\"isSubmitting || !reason.trim()\">\n                {{ isSubmitting ? 'Sending...' : 'Submit report' }}\n            </button>\n        </div>\n    </div>\n</div>\n", "/* src/components/report-modal/report-modal.component.css */\n.report-backdrop {\n  position: fixed;\n  inset: 0;\n  background: rgba(0, 0, 0, 0.7);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 2000;\n  padding: 24px;\n}\n.report-modal {\n  background: rgba(20, 20, 20, 0.95);\n  color: #fff;\n  border-radius: 20px;\n  width: min(520px, 100%);\n  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);\n  border: 1px solid rgba(252, 195, 36, 0.2);\n  padding: 20px 22px;\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n.report-header {\n  display: flex;\n  justify-content: space-between;\n  gap: 16px;\n  align-items: flex-start;\n}\n.report-header h3 {\n  margin: 0;\n  font-size: 20px;\n  color: #f4c12a;\n}\n.target-line {\n  margin: 4px 0 0;\n  color: rgba(255, 255, 255, 0.7);\n  font-size: 13px;\n}\n.icon-btn {\n  background: transparent;\n  border: none;\n  color: #fff;\n  cursor: pointer;\n}\n.report-body {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n}\n.field-label {\n  font-size: 13px;\n  color: rgba(255, 255, 255, 0.8);\n}\n.field-input {\n  width: 100%;\n  border-radius: 12px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  background: rgba(255, 255, 255, 0.08);\n  color: #fff;\n  padding: 10px 12px;\n  font-size: 14px;\n  outline: none;\n}\n.field-input:focus {\n  border-color: rgba(252, 195, 36, 0.6);\n}\n.field-textarea {\n  resize: vertical;\n  min-height: 96px;\n}\n.file-row {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n.file-input {\n  width: 100%;\n  color: rgba(255, 255, 255, 0.8);\n  background: rgba(255, 255, 255, 0.08);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 12px;\n  padding: 6px 8px;\n  font-size: 14px;\n  outline: none;\n}\n.file-input:focus {\n  border-color: rgba(252, 195, 36, 0.6);\n}\n.file-input::file-selector-button,\n.file-input::-webkit-file-upload-button {\n  margin-right: 12px;\n  border: none;\n  background-color: var(--color-accent, #f4c12a);\n  color: #fff;\n  padding: 8px 14px;\n  border-radius: 10px;\n  font-weight: 700;\n  font-family: inherit;\n  cursor: pointer;\n  transition: transform 0.2s, opacity 0.2s;\n}\n.file-input::file-selector-button:hover,\n.file-input::-webkit-file-upload-button:hover {\n  opacity: 0.9;\n  transform: translateY(-1px);\n}\n.file-input::file-selector-button:active,\n.file-input::-webkit-file-upload-button:active {\n  transform: translateY(0);\n}\n.file-chip {\n  display: inline-flex;\n  align-items: center;\n  gap: 6px;\n  background: rgba(252, 195, 36, 0.15);\n  border: 1px solid rgba(252, 195, 36, 0.4);\n  padding: 6px 10px;\n  border-radius: 999px;\n  font-size: 12px;\n  max-width: 100%;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.file-chip span {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  max-width: 280px;\n}\n.file-remove {\n  border: none;\n  background: transparent;\n  color: #f4c12a;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n}\n.report-actions {\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n}\n@media (max-width: 600px) {\n  .report-modal {\n    padding: 18px 16px;\n  }\n}\n/*# sourceMappingURL=report-modal.component.css.map */\n", "import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { ReportItem } from '../models/report';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class ReportService {\n    private baseUrl = 'http://localhost:8080/api';\n\n    constructor(private http: HttpClient) { }\n\n    createReport(payload: FormData): Observable<ReportItem> {\n        return this.http.post<ReportItem>(`${this.baseUrl}/reports`, payload);\n    }\n}\n", "import { Component, EventEmitter, Input, Output } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { MatIconModule } from '@angular/material/icon';\nimport { MatSnackBar, MatSnackBarModule } from '@angular/material/snack-bar';\nimport { ReportService } from '../../services/report.service';\nimport { ReportTargetType } from '../../models/report';\n\n@Component({\n    selector: 'app-report-modal',\n    standalone: true,\n    imports: [CommonModule, FormsModule, MatIconModule, MatSnackBarModule],\n    templateUrl: './report-modal.component.html',\n    styleUrl: './report-modal.component.css'\n})\nexport class ReportModalComponent {\n    @Input() reporterId: string | null = null;\n    @Input() targetType: ReportTargetType = 'USER';\n    @Input() targetId: string | null = null;\n    @Input() targetLabel = '';\n\n    @Output() close = new EventEmitter<void>();\n    @Output() submitted = new EventEmitter<void>();\n\n    reason = '';\n    details = '';\n    imageFile: File | null = null;\n    imageName = '';\n    isSubmitting = false;\n\n    constructor(private reportService: ReportService, private snackBar: MatSnackBar) { }\n\n    onClose() {\n        this.close.emit();\n    }\n\n    onFileSelected(event: Event) {\n        const input = event.target as HTMLInputElement;\n        if (!input.files || input.files.length === 0) {\n            return;\n        }\n        const file = input.files[0];\n        this.imageFile = file;\n        this.imageName = file.name;\n    }\n\n    clearImage() {\n        this.imageFile = null;\n        this.imageName = '';\n    }\n\n    submitReport() {\n        if (!this.reporterId || !this.targetId) {\n            this.showToast('You must be logged in to report.', 'error');\n            return;\n        }\n        if (!this.reason.trim()) {\n            this.showToast('Please enter the main reason.', 'error');\n            return;\n        }\n\n        const payload = new FormData();\n        payload.append('reporterId', this.reporterId);\n        payload.append('targetType', this.targetType);\n        payload.append('targetId', this.targetId);\n        payload.append('reason', this.reason.trim());\n        if (this.details.trim()) {\n            payload.append('details', this.details.trim());\n        }\n        if (this.imageFile) {\n            payload.append('image', this.imageFile, this.imageFile.name);\n        }\n\n        this.isSubmitting = true;\n        this.reportService.createReport(payload).subscribe({\n            next: () => {\n                this.showToast('Report submitted.');\n                this.isSubmitting = false;\n                this.submitted.emit();\n                this.onClose();\n            },\n            error: (err) => {\n                console.error('Error submitting report', err);\n                this.showToast('Unable to submit the report.', 'error');\n                this.isSubmitting = false;\n            }\n        });\n    }\n\n    private showToast(message: string, tone: 'default' | 'error' = 'default') {\n        this.snackBar.open(message, undefined, {\n            duration: tone === 'error' ? 1400 : 1000,\n            horizontalPosition: 'center',\n            verticalPosition: 'top',\n            panelClass: tone === 'error' ? ['toast-snackbar', 'toast-snackbar--error'] : ['toast-snackbar']\n        });\n    }\n}\n", "import { Component, Input, Output, EventEmitter, AfterViewInit, OnChanges, SimpleChanges, ElementRef, HostListener } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { Event } from '../../models/event';\n\nimport { MatIconModule } from '@angular/material/icon';\nimport { UserService } from '../../services/user-service/user-service';\nimport { ReportModalComponent } from '../report-modal/report-modal.component';\n\n@Component({\n    selector: 'event-popup-card',\n    standalone: true,\n    imports: [CommonModule, MatIconModule, ReportModalComponent],\n    templateUrl: './event-popup-card.html',\n    styleUrl: './event-popup-card.css'\n})\nexport class EventPopupCard implements AfterViewInit, OnChanges {\n    @Input() event!: Event;\n    @Input() organizerName: string = 'Eventer';\n    @Input() organizerImage?: string;\n    @Input() eventPosition?: { x: number, y: number };\n    @Input() currentUserId: string | null = null;\n    @Input() creatorId?: number;\n\n    @Output() close = new EventEmitter<void>();\n    @Output() participate = new EventEmitter<Event>();\n    @Output() toggleFavorite = new EventEmitter<void>();\n    @Output() openOrganizerProfile = new EventEmitter<string>();\n    @Output() leave = new EventEmitter<Event>();\n    @Output() deleteEvent = new EventEmitter<Event>();\n    @Output() shareEvent = new EventEmitter<Event>();\n    @Output() openChat = new EventEmitter<Event>();\n\n    isFollowing = false;\n    isLoadingFollowStatus = true;\n    notificationsEnabled = false;\n    notificationsLoading = false;\n    showReportModal = false;\n\n    constructor(private elementRef: ElementRef, private userService: UserService) { }\n\n    ngAfterViewInit(): void {\n        this.positionCard();\n    }\n\n    ngOnChanges(changes: SimpleChanges): void {\n        if (changes['eventPosition']) {\n            this.positionCard();\n        }\n        if (changes['event'] || changes['currentUserId'] || changes['creatorId']) {\n            this.checkIfFollowing();\n        }\n    }\n\n    checkIfFollowing() {\n        const targetCreatorId = this.creatorId || (this.event ? this.event.creatorId : null);\n\n        if (!this.currentUserId || !targetCreatorId || this.currentUserId === targetCreatorId.toString()) {\n            this.isFollowing = false;\n            this.isLoadingFollowStatus = false;\n            this.notificationsEnabled = false;\n            return;\n        }\n\n        this.isLoadingFollowStatus = true;\n        this.userService.isFollowing(this.currentUserId, targetCreatorId.toString()).subscribe({\n            next: (res) => {\n                this.isFollowing = res.isFollowing;\n                this.isLoadingFollowStatus = false;\n                if (this.isFollowing) {\n                    this.loadNotificationPreference(targetCreatorId.toString());\n                } else {\n                    this.notificationsEnabled = false;\n                }\n            },\n            error: (err) => {\n                console.error('Error checking follow status', err);\n                this.isLoadingFollowStatus = false;\n                this.notificationsEnabled = false;\n            }\n        });\n    }\n\n    @HostListener('click', ['$event'])\n    onClick(event: MouseEvent) {\n        event.stopPropagation();\n    }\n\n    @HostListener('window:resize')\n    onResize() {\n        this.positionCard();\n    }\n\n    private positionCard() {\n        if (!this.eventPosition) return;\n\n        const cardContainer = this.elementRef.nativeElement.querySelector('.card-container') as HTMLElement;\n        if (cardContainer) {\n            const sidebar = document.querySelector('.sidebar-container') as HTMLElement | null;\n            const sidebarRect = sidebar?.getBoundingClientRect();\n            const sidebarRight = sidebarRect && !sidebar?.classList.contains('collapsed')\n                ? sidebarRect.right\n                : 0;\n\n            const baseMargin = 12;\n            const leftSafeMargin = sidebarRight > 0 ? sidebarRight + baseMargin : baseMargin;\n            const margin = baseMargin;\n            const isMobile = window.innerWidth <= 768;\n            const topSafeMargin = isMobile ? 100 : margin;\n            const width = cardContainer.offsetWidth || 0;\n            const height = cardContainer.offsetHeight || 0;\n            const viewportW = window.innerWidth;\n            const viewportH = window.innerHeight;\n\n            const offsetY = -20;\n            let x = this.eventPosition.x;\n            let y = this.eventPosition.y + offsetY;\n\n            const leftAfter = x - width / 2;\n            const rightAfter = x + width / 2;\n            if (leftAfter < leftSafeMargin) {\n                x += leftSafeMargin - leftAfter;\n            } else if (rightAfter > viewportW - margin) {\n                x -= rightAfter - (viewportW - margin);\n            }\n\n            const topAfter = y - height;\n            if (topAfter < topSafeMargin) {\n                y += topSafeMargin - topAfter;\n            }\n\n            const actionBar = document.querySelector('.action-bar') as HTMLElement | null;\n            const actionBarRect = actionBar?.getBoundingClientRect();\n            if (actionBarRect) {\n                const cardLeft = x - width / 2;\n                const cardRight = x + width / 2;\n                const cardTop = y - height;\n                const cardBottom = y;\n                const overlapsX = cardRight > actionBarRect.left - margin && cardLeft < actionBarRect.right + margin;\n                const overlapsY = cardBottom > actionBarRect.top - margin && cardTop < actionBarRect.bottom + margin;\n\n                if (overlapsX && overlapsY) {\n                    const desiredTop = actionBarRect.bottom + margin;\n                    if (cardTop < desiredTop) {\n                        y += desiredTop - cardTop;\n                    }\n                }\n            }\n\n            if (y > viewportH - margin) {\n                y = viewportH - margin;\n            }\n\n            cardContainer.style.left = `${x}px`;\n            cardContainer.style.top = `${y}px`;\n            cardContainer.style.transform = 'translate(-50%, -100%)';\n        }\n    }\n\n    onClose() {\n        this.close.emit();\n    }\n\n    onParticipate() {\n        if (this.isOrganizer()) return;\n        this.participate.emit(this.event);\n    }\n\n    onLeave() {\n        this.leave.emit(this.event);\n    }\n\n    onOpenChat() {\n        this.openChat.emit(this.event);\n    }\n\n    onDeleteEvent() {\n        if (!this.isOrganizer()) return;\n        this.deleteEvent.emit(this.event);\n    }\n\n    toggleNotifications(event: MouseEvent) {\n        event.stopPropagation();\n        const targetCreatorId = this.creatorId || (this.event ? this.event.creatorId : null);\n        if (!this.currentUserId || !targetCreatorId || !this.isFollowing) return;\n\n        const nextValue = !this.notificationsEnabled;\n        this.notificationsLoading = true;\n        this.userService.setFollowNotifications(this.currentUserId, targetCreatorId.toString(), nextValue).subscribe({\n            next: (res) => {\n                this.notificationsEnabled = res.enabled;\n                this.notificationsLoading = false;\n            },\n            error: (err) => {\n                console.error('Error updating follow notifications', err);\n                this.notificationsLoading = false;\n            }\n        });\n    }\n\n    isOrganizer(): boolean {\n        const creatorId = this.creatorId ?? this.event?.creatorId;\n        return !!this.currentUserId && !!creatorId && this.currentUserId.toString() === creatorId.toString();\n    }\n\n    private getOrganizerId(): string | null {\n        const rawId =\n            this.creatorId ??\n            this.event?.creatorId ??\n            (this.event as any)?.creator?.id;\n        return rawId !== undefined && rawId !== null ? String(rawId) : null;\n    }\n\n    formatHeroDate(): string {\n        const date = this.event.date ? new Date(`${this.event.date}T00:00:00`) : null;\n        const start = this.event.startTime ? this.event.startTime.slice(0, 5) : null;\n        const weekday = date ? date.toLocaleDateString('en-US', { weekday: 'short' }) : '';\n        const dayMonth = date ? date.toLocaleDateString('en-US', { day: '2-digit', month: 'short' }) : '';\n\n        const datePart = [weekday, dayMonth].filter(Boolean).join(' ');\n        const timePart = start ? start : '';\n        return [datePart, timePart].filter(Boolean).join(', ');\n    }\n\n    getActualParticipants(): number {\n        if (this.event.occupiedSpots !== undefined && this.event.occupiedSpots !== null) {\n            return this.event.occupiedSpots;\n        }\n        return this.event.nPartecipants || 0;\n    }\n\n    getSubtitle(): string {\n        if (this.event.city) return this.event.city;\n        if (this.event.description) return this.event.description;\n        return 'Location TBD';\n    }\n\n    hasCoordinates(): boolean {\n        return !!this.event &&\n            Number.isFinite(this.event.latitude) &&\n            Number.isFinite(this.event.longitude);\n    }\n\n    openInMaps(event?: MouseEvent) {\n        event?.stopPropagation();\n        if (!this.hasCoordinates()) return;\n\n        const url = `https://www.google.com/maps/search/?api=1&query=${this.event.latitude},${this.event.longitude}`;\n        window.open(url, '_blank', 'noopener');\n    }\n\n    showDescription(): boolean {\n        return !!this.event.description && this.event.description !== this.getSubtitle();\n    }\n\n    formatDateTime(): string {\n        const date = this.event.date ? new Date(`${this.event.date}T00:00:00`) : null;\n        const start = this.event.startTime ? this.event.startTime.slice(0, 5) : null;\n        const end = this.event.endTime ? this.event.endTime.slice(0, 5) : null;\n\n        const datePart = date\n            ? date.toLocaleDateString('en-US', { day: '2-digit', month: 'short' })\n            : '';\n        const timePart = end ? `${start}  ${end}` : start;\n\n        return [datePart, timePart].filter(Boolean).join(' / ');\n    }\n\n    formatCost(): string {\n        if (this.event.costPerPerson !== undefined && this.event.costPerPerson !== null) {\n            return `${this.event.costPerPerson} per person`;\n        }\n        return 'Free';\n    }\n\n    getInitials(name: string): string {\n        if (!name) return 'OR';\n        return name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);\n    }\n\n    isSaved(): boolean | undefined {\n        return this.event.isSaved;\n    }\n\n    followOrganizer() {\n        const targetCreatorId = this.creatorId || (this.event ? this.event.creatorId : null);\n        if (!this.currentUserId || !targetCreatorId) return;\n\n        this.userService.followUser(this.currentUserId, targetCreatorId.toString()).subscribe({\n            next: () => {\n                this.isFollowing = true;\n                this.notificationsEnabled = true;\n                this.userService.notifyUserUpdate();\n            },\n            error: (err) => console.error('Error following', err)\n        });\n    }\n\n    unfollowOrganizer() {\n        const targetCreatorId = this.creatorId || (this.event ? this.event.creatorId : null);\n        if (!this.currentUserId || !targetCreatorId) return;\n\n        this.userService.unfollowUser(this.currentUserId, targetCreatorId.toString()).subscribe({\n            next: () => {\n                this.isFollowing = false;\n                this.notificationsEnabled = false;\n                this.userService.notifyUserUpdate();\n            },\n            error: (err) => console.error('Error unfollowing', err)\n        });\n    }\n\n    onOrganizerClick() {\n        const organizerId = this.getOrganizerId();\n        if (!organizerId) {\n            console.log('[EventPopupCard] eventer click with missing id', {\n                creatorIdInput: this.creatorId,\n                eventCreatorId: this.event?.creatorId,\n                event: this.event\n            });\n            return;\n        }\n        console.log('[EventPopupCard] open eventer', {\n            organizerId,\n            creatorIdInput: this.creatorId,\n            eventCreatorId: this.event?.creatorId,\n            event: this.event\n        });\n        this.openOrganizerProfile.emit(organizerId);\n    }\n\n    openReportModal() {\n        if (!this.currentUserId || this.isOrganizer()) return;\n        this.showReportModal = true;\n    }\n\n    closeReportModal() {\n        this.showReportModal = false;\n    }\n\n    private loadNotificationPreference(targetCreatorId: string) {\n        if (!this.currentUserId) return;\n        this.notificationsLoading = true;\n        this.userService.getFollowNotifications(this.currentUserId, targetCreatorId).subscribe({\n            next: (res) => {\n                this.notificationsEnabled = !!res.enabled;\n                this.notificationsLoading = false;\n            },\n            error: (err) => {\n                console.error('Error fetching follow notifications preference', err);\n                this.notificationsEnabled = false;\n                this.notificationsLoading = false;\n            }\n        });\n    }\n}\n", "<div class=\"backdrop\" (click)=\"onClose()\"></div>\n\n<div class=\"selector-container\">\n    <div class=\"instruction-text\">\n        \uD83D\uDCCD Select a location for your event\n    </div>\n\n    <div class=\"search-section\">\n        <div class=\"search-bar\">\n            <mat-icon>search</mat-icon>\n            <input type=\"text\" placeholder=\"Search city or place...\" [(ngModel)]=\"searchQuery\" (input)=\"onSearch()\">\n            @if (searchQuery) {\n            <mat-icon class=\"clear-icon\" (click)=\"searchQuery = ''; cityResults = []\">close</mat-icon>\n            }\n        </div>\n\n        @if (cityResults.length > 0) {\n        <div class=\"search-results\">\n            @for (city of cityResults; track city.name) {\n            <div class=\"result-item\" (click)=\"selectCity(city)\">\n                <mat-icon>location_on</mat-icon>\n                <span>{{ city.name }}</span>\n            </div>\n            }\n        </div>\n        }\n    </div>\n\n    <div id=\"location-map\" class=\"map\"></div>\n\n    <button class=\"button confirm-btn\" (click)=\"onConfirm()\" [disabled]=\"!selectedCoords\">\n        Confirm Location\n    </button>\n</div>", "/* src/components/map-location-selector/map-location-selector.css */\n.backdrop {\n  position: fixed;\n  inset: 0;\n  background: var(--modal-backdrop-color);\n  -webkit-backdrop-filter: blur(var(--modal-backdrop-blur));\n  backdrop-filter: blur(var(--modal-backdrop-blur));\n  z-index: var(--z-backdrop);\n}\n.selector-container {\n  position: fixed;\n  inset: 0;\n  z-index: var(--z-popup);\n  pointer-events: none;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 20px;\n  gap: 20px;\n  background-color: transparent;\n}\n.instruction-text {\n  pointer-events: all;\n  background: var(--color-dark-gray);\n  color: var(--color-white);\n  padding: 12px 24px;\n  border-radius: 12px;\n  font-size: 14px;\n  font-weight: var(--font-weight-semibold);\n  border: 1px solid var(--color-light-gray);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n  text-align: center;\n}\n.map {\n  flex: 1;\n  width: 100%;\n  border-radius: 20px;\n  overflow: hidden;\n  pointer-events: all;\n  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);\n}\n.confirm-btn {\n  pointer-events: all;\n  min-width: 250px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n}\n.confirm-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n  filter: grayscale(1);\n}\n.confirm-btn:disabled:hover {\n  filter: grayscale(1);\n  transform: none;\n}\n.search-section {\n  width: 100%;\n  max-width: 400px;\n  position: relative;\n  pointer-events: all;\n  z-index: 2100;\n}\n.search-bar {\n  display: flex;\n  align-items: center;\n  background: var(--color-dark-gray);\n  border: 1px solid var(--color-light-gray);\n  border-radius: 12px;\n  padding: 8px 16px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n}\n.search-bar mat-icon {\n  color: var(--color-gray);\n  margin-right: 8px;\n}\n.search-bar input {\n  flex: 1;\n  background: transparent;\n  border: none;\n  color: white;\n  font-size: 16px;\n  outline: none;\n}\n.search-bar input::placeholder {\n  color: var(--color-gray);\n}\n.clear-icon {\n  cursor: pointer;\n  color: var(--color-gray);\n  margin-left: 8px;\n}\n.clear-icon:hover {\n  color: white;\n}\n.search-results {\n  position: absolute;\n  top: 100%;\n  left: 0;\n  width: 100%;\n  background: var(--color-dark-gray);\n  border: 1px solid var(--color-light-gray);\n  border-radius: 12px;\n  margin-top: 8px;\n  max-height: 200px;\n  overflow-y: auto;\n  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);\n  z-index: 2200;\n}\n.result-item {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding: 12px 16px;\n  cursor: pointer;\n  transition: background 0.2s;\n  color: white;\n}\n.result-item:hover {\n  background: rgba(255, 255, 255, 0.1);\n}\n.result-item mat-icon {\n  color: var(--color-gray);\n  font-size: 20px;\n  width: 20px;\n  height: 20px;\n}\n/*# sourceMappingURL=map-location-selector.css.map */\n", "import { Component, AfterViewInit, OnDestroy, Output, EventEmitter } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { MatIconModule } from '@angular/material/icon';\nimport { Environment } from '../../environment/environment';\nimport * as mapboxgl from 'mapbox-gl';\nimport { MapboxService } from '../../services/mapbox.service';\n\n@Component({\n    selector: 'map-location-selector',\n    standalone: true,\n    imports: [CommonModule, FormsModule, MatIconModule],\n    templateUrl: './map-location-selector.html',\n    styleUrl: './map-location-selector.css'\n})\nexport class MapLocationSelector implements AfterViewInit, OnDestroy {\n    @Output() locationSelected = new EventEmitter<{ lat: number, lng: number }>();\n    @Output() close = new EventEmitter<void>();\n\n    private map!: mapboxgl.Map;\n    selectedMarker: mapboxgl.Marker | null = null;\n    selectedCoords: [number, number] | null = null;\n\n    searchQuery: string = '';\n    cityResults: { name: string, center: [number, number] }[] = [];\n\n    constructor(private mapboxService: MapboxService) { }\n\n    ngAfterViewInit(): void {\n        this.map = new mapboxgl.Map({\n            accessToken: Environment.mapboxToken,\n            container: 'location-map',\n            style: 'mapbox://styles/fnsbrl/cmhxy97pz004e01qx08c0gc44',\n            center: [12.4964, 41.9028],\n            zoom: 12,\n            pitch: 0,\n            bearing: 0,\n        });\n\n        if (navigator.geolocation) {\n            navigator.geolocation.getCurrentPosition(\n                (position) => {\n                    const coords: [number, number] = [\n                        position.coords.longitude,\n                        position.coords.latitude\n                    ];\n\n                    this.map.flyTo({\n                        center: coords,\n                        zoom: 17,\n                        duration: 1000\n                    });\n                },\n                (error) => console.warn('Geolocation error:', error)\n            );\n        }\n\n        this.map.on('click', (e) => {\n            this.selectedCoords = [e.lngLat.lng, e.lngLat.lat];\n\n            if (this.selectedMarker) {\n                this.selectedMarker.remove();\n            }\n\n            const markerEl = document.createElement('div');\n            markerEl.style.width = '30px';\n            markerEl.style.height = '30px';\n            markerEl.style.backgroundColor = '#FCC324';\n            markerEl.style.borderRadius = '50%';\n            markerEl.style.border = '3px solid white';\n            markerEl.style.boxShadow = '0 2px 8px rgba(0,0,0,0.3)';\n\n            this.selectedMarker = new mapboxgl.Marker({ element: markerEl })\n                .setLngLat(this.selectedCoords)\n                .addTo(this.map);\n        });\n    }\n\n    onSearch() {\n        if (!this.searchQuery || this.searchQuery.trim() === '') {\n            this.cityResults = [];\n            return;\n        }\n\n        this.mapboxService.searchCity(this.searchQuery).subscribe(features => {\n            this.cityResults = features.map(f => ({\n                name: f.place_name,\n                center: f.center\n            }));\n        });\n    }\n\n    selectCity(city: { name: string, center: [number, number] }) {\n        this.map.flyTo({\n            center: city.center,\n            zoom: 16,\n            essential: true\n        });\n        this.searchQuery = '';\n        this.cityResults = [];\n    }\n\n    ngOnDestroy(): void {\n        if (this.map) this.map.remove();\n    }\n\n    onConfirm() {\n        if (this.selectedCoords) {\n            this.locationSelected.emit({\n                lat: this.selectedCoords[1],\n                lng: this.selectedCoords[0]\n            });\n        }\n    }\n\n    onClose() {\n        this.close.emit();\n    }\n}\n", "<div class=\"modal-backdrop\" (click)=\"onClose()\">\n    <div class=\"modal-container\" [class.events-mode]=\"view === 'events'\" (click)=\"$event.stopPropagation()\">\n        <div class=\"modal-header\">\n            <button class=\"back-btn header-back-btn mobile-only\" (click)=\"onClose()\">\n                <mat-icon>arrow_back</mat-icon>\n            </button>\n            <h2 class=\"yellow-title\">{{ getViewTitle() }}</h2>\n            <button class=\"close-btn tablet-desktop-only\" (click)=\"onClose()\">\n                <mat-icon>close</mat-icon>\n            </button>\n        </div>\n\n        @if (loading) {\n        <div class=\"loading-spinner\">Loading...</div>\n        } @else if (user) {\n\n        <!-- PROFILE VIEW -->\n        @if (view === 'profile') {\n        <div class=\"profile-content\">\n            <div class=\"avatar-container\">\n                @if (user.profileImage) {\n                <img [src]=\"user.profileImage\" alt=\"Profile\" class=\"profile-image\">\n                } @else {\n                <div class=\"profile-placeholder\">{{ getInitials(user.name) }}</div>\n                }\n            </div>\n\n            <h3 class=\"user-name\">{{ user.name }}</h3>\n            <p class=\"user-email\" *ngIf=\"user.email && currentUserId && user.id.toString() === currentUserId\">\n                {{ user.email }}\n            </p>\n            <p class=\"user-description\" *ngIf=\"user.description\">{{ user.description }}</p>\n\n            <!-- FOLLOW ACTION -->\n            @if (currentUserId && user.id.toString() !== currentUserId) {\n            <div class=\"follow-actions\">\n                <button class=\"button follow-main-btn\" [class.following]=\"isFollowing\" (click)=\"toggleFollow()\">\n                    {{ isFollowing ? 'Following' : 'Follow' }}\n                </button>\n                @if (isFollowing) {\n                <button class=\"bell-btn\" [class.active]=\"notificationsEnabled\" [disabled]=\"notificationsLoading\"\n                    (click)=\"toggleNotifications($event)\">\n                    <mat-icon>{{ notificationsEnabled ? 'notifications' : 'notifications_off' }}</mat-icon>\n                </button>\n                }\n            </div>\n            <button class=\"report-btn\" type=\"button\" (click)=\"openReportModal()\">\n                <mat-icon>flag</mat-icon>\n                Segnala\n            </button>\n            }\n\n            <div class=\"stats-container\">\n                <div class=\"stat-item clickable\" (click)=\"showFollowers()\">\n                    <span class=\"stat-value\">{{ user.followersCount || 0 }}</span>\n                    <span class=\"stat-label\">Followers</span>\n                </div>\n                <div class=\"stat-divider\"></div>\n                <div class=\"stat-item clickable\" (click)=\"showFollowing()\">\n                    <span class=\"stat-value\">{{ user.followingCount || 0 }}</span>\n                    <span class=\"stat-label\">Following</span>\n                </div>\n                <div class=\"stat-divider\"></div>\n                <div class=\"stat-item clickable\" (click)=\"showEvents()\">\n                    <span class=\"stat-value\">{{ user.approvedEventsCount || 0 }}</span>\n                    <span class=\"stat-label\">Events</span>\n                </div>\n            </div>\n        </div>\n        }\n\n        <!-- LIST VIEW (Followers/Following) -->\n        @if (view === 'followers' || view === 'following') {\n        <div class=\"list-view\">\n            <div class=\"list-header\">\n                <button class=\"back-btn\" (click)=\"onClose()\"> <!-- onClose resets to profile if view != profile -->\n                    <mat-icon>arrow_back</mat-icon>\n                </button>\n                <h3>{{ view === 'followers' ? 'Followers' : 'Following' }}</h3>\n            </div>\n\n            <div class=\"user-list\" *ngIf=\"!loadingList; else loadingTemplate\">\n                @for (u of userList; track u.id) {\n                <div class=\"user-item\">\n                    <div class=\"user-info\" (click)=\"onOpenProfileFromList(u)\">\n                        @if (u.profileImage) {\n                        <img [src]=\"u.profileImage\" class=\"list-avatar\">\n                        } @else {\n                        <div class=\"list-avatar-placeholder\">{{ getInitials(u.name) }}</div>\n                        }\n                        <span class=\"list-username\">{{ u.name }}</span>\n                    </div>\n\n                    <!-- List Item Follow Logic (Only if logged in and not me) -->\n                    @if (currentUserId && u.id.toString() !== currentUserId) {\n                    @if (myFollowingIds.has(u.id.toString())) {\n                    <button class=\"unfollow-btn small-btn\" (click)=\"onListUnfollow(u)\">Unfollow</button>\n                    } @else {\n                    <button class=\"follow-btn small-btn\" (click)=\"onListFollow(u)\">Follow</button>\n                    }\n                    }\n                </div>\n                }\n                @if (userList.length === 0) {\n                <div class=\"empty-list\">No users found.</div>\n                }\n            </div>\n            <ng-template #loadingTemplate>\n                <div class=\"loading-spinner\">Loading list...</div>\n            </ng-template>\n        </div>\n        }\n\n        <!-- EVENTS VIEW -->\n        @if (view === 'events') {\n        <div class=\"events-view\">\n\n\n            <div class=\"events-section\">\n                <h4>Upcoming</h4>\n                @if (loadingEvents) {\n                <div class=\"loading-spinner\">Loading events...</div>\n                } @else if (upcomingEvents.length === 0) {\n                <div class=\"empty-list\">No upcoming events.</div>\n                } @else {\n                @for (ev of upcomingEvents; track ev.id) {\n                <div class=\"event-card clickable\" (click)=\"focusEventOnMap(ev)\">\n                    <div class=\"event-card-header\">\n                        <p class=\"event-title\">{{ ev.title }}</p>\n                        <p class=\"event-sub\">\n                            <mat-icon class=\"inline-icon\">event</mat-icon>\n                            <span>{{ formatEventDate(ev) }}</span>\n                            <mat-icon class=\"inline-icon\">place</mat-icon>\n                            <span>{{ ev.city }}</span>\n                        </p>\n                    </div>\n                    <div class=\"event-stats\">\n                        <span class=\"pill stat-pill\">\n                            <mat-icon>group</mat-icon>\n                            <span>{{ eventStats(ev).participants }} participants</span>\n                        </span>\n                        <span class=\"pill stat-pill\">\n                            <mat-icon>euro</mat-icon>\n                            <span>{{ eventStats(ev).cost }}</span>\n                        </span>\n                    </div>\n                </div>\n                }\n                }\n            </div>\n\n            <div class=\"events-section\">\n                <h4>Past</h4>\n                @if (loadingEvents) {\n                <div class=\"loading-spinner\">Loading events...</div>\n                } @else if (pastEvents.length === 0) {\n                <div class=\"empty-list\">No past events.</div>\n                } @else {\n                @for (ev of pastEvents; track ev.id) {\n                <div class=\"event-card past\">\n                    <div class=\"event-card-header\">\n                        <p class=\"event-title\">{{ ev.title }}</p>\n                        <p class=\"event-sub\">\n                            <mat-icon class=\"inline-icon\">event</mat-icon>\n                            <span>{{ formatEventDate(ev) }}</span>\n                            <mat-icon class=\"inline-icon\">place</mat-icon>\n                            <span>{{ ev.city }}</span>\n                        </p>\n                    </div>\n                    <div class=\"event-stats\">\n                        <span class=\"pill stat-pill\">\n                            <mat-icon>group</mat-icon>\n                            <span>{{ eventStats(ev).participants }} participants</span>\n                        </span>\n                        <span class=\"pill stat-pill\">\n                            <mat-icon>euro</mat-icon>\n                            <span>{{ eventStats(ev).cost }}</span>\n                        </span>\n                    </div>\n                </div>\n                }\n                }\n            </div>\n        </div>\n        }\n\n        } @else {\n        <div class=\"error-state\">Unable to load profile.</div>\n        }\n    </div>\n</div>\n\n@if (showReportModal && user) {\n<app-report-modal [reporterId]=\"currentUserId\" [targetType]=\"'USER'\" [targetId]=\"user.id.toString()\"\n    [targetLabel]=\"user.name\" (close)=\"closeReportModal()\" (submitted)=\"closeReportModal()\">\n</app-report-modal>\n}\n", "/* src/components/user-profile-modal/user-profile-modal.css */\n.modal-backdrop {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n  background: var(--modal-backdrop-color);\n  -webkit-backdrop-filter: blur(var(--modal-backdrop-blur));\n  backdrop-filter: blur(var(--modal-backdrop-blur));\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 2000;\n}\n.modal-container {\n  background: var(--modal-surface);\n  width: 90%;\n  max-width: 400px;\n  border-radius: var(--modal-radius);\n  padding: 24px;\n  color: white;\n  border: var(--modal-border);\n  box-shadow: var(--modal-shadow);\n  max-height: 85vh;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n}\n.modal-container.events-mode {\n  background: var(--modal-surface);\n}\n@media (max-width: 768px) {\n  .modal-container {\n    width: 100%;\n    max-width: 100%;\n    height: 100%;\n    max-height: 100vh;\n    border-radius: 0;\n    padding: 24px 32px 80px 32px;\n  }\n  .profile-content {\n    padding: 0 8px;\n  }\n}\n.modal-header {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin-bottom: 24px;\n  padding-top: 2px;\n  position: relative;\n}\n.modal-header h2 {\n  margin: 0;\n  font-size: 20px;\n  font-weight: 600;\n  line-height: 1.2;\n  text-align: center;\n}\n.yellow-title {\n  color: var(--color-accent) !important;\n}\n@media (max-width: 768px) {\n  .modal-header {\n    justify-content: center;\n    gap: 16px;\n  }\n  .modal-header h2 {\n    text-align: center;\n    flex: 0 1 auto;\n  }\n  .header-back-btn {\n    display: inline-flex !important;\n  }\n}\n.close-btn {\n  background: none;\n  border: none;\n  color: #fff;\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.close-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n}\n.profile-content {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 12px;\n}\n.avatar-container {\n  position: relative;\n  width: 100px;\n  height: 100px;\n}\n.profile-image,\n.profile-placeholder {\n  width: 100%;\n  height: 100%;\n  border-radius: 50%;\n  object-fit: cover;\n}\n.profile-placeholder {\n  background:\n    linear-gradient(\n      135deg,\n      #FFB800,\n      #FFDC73);\n  color: #1a1a1a;\n  font-size: 36px;\n  font-weight: bold;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.user-name {\n  margin: 0;\n  font-size: 22px;\n  font-weight: 600;\n}\n.user-email {\n  margin: 0;\n  color: #888;\n  font-size: 14px;\n}\n.user-description {\n  margin: 8px 0 0 0;\n  color: #e0e0e0;\n  font-size: 14px;\n  font-weight: 400;\n  line-height: 1.4;\n  max-width: 90%;\n  opacity: 0.9;\n  text-align: center;\n}\n.follow-actions {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 10px;\n  margin: 6px 0 12px;\n}\n.report-btn {\n  display: inline-flex;\n  align-items: center;\n  gap: 6px;\n  background: rgba(255, 255, 255, 0.06);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  color: #ff8b8b;\n  padding: 8px 14px;\n  border-radius: 18px;\n  cursor: pointer;\n  font-size: 13px;\n}\n.report-btn mat-icon {\n  font-size: 18px;\n  width: 18px;\n  height: 18px;\n}\n.report-btn:hover {\n  border-color: rgba(255, 139, 139, 0.6);\n}\n.stats-container {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 0;\n  margin-top: 16px;\n  background: rgba(255, 255, 255, 0.05);\n  padding: 16px 12px;\n  border-radius: 12px;\n  width: 100%;\n}\n.stat-item {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 4px;\n  flex: 1;\n}\n.stat-item.clickable {\n  cursor: pointer;\n}\n.stat-item.clickable:hover {\n  opacity: 0.8;\n}\n.stat-value {\n  font-size: 18px;\n  font-weight: 700;\n  color: #FFB800;\n}\n.stat-label {\n  font-size: 11px;\n  color: #888;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n.stat-divider {\n  width: 1px;\n  height: 30px;\n  background: rgba(255, 255, 255, 0.1);\n  flex-shrink: 0;\n}\n.follow-main-btn {\n  width: 100%;\n  max-width: 220px;\n  margin: 0 auto;\n  color: #ffffff !important;\n}\n.follow-main-btn:not(.following) {\n  background-color: var(--color-accent);\n}\n.follow-main-btn.following {\n  background: rgba(255, 255, 255, 0.1);\n  color: #ffffff;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n}\n.bell-btn {\n  width: 44px;\n  height: 44px;\n  border-radius: 12px;\n  border: 1px solid rgba(255, 255, 255, 0.15);\n  background: rgba(255, 255, 255, 0.06);\n  color: #f1f1f1;\n  display: grid;\n  place-items: center;\n  cursor: pointer;\n  transition:\n    background-color 0.2s ease,\n    border-color 0.2s ease,\n    transform 0.1s ease;\n}\n.bell-btn:hover {\n  background: rgba(255, 255, 255, 0.12);\n}\n.bell-btn:active {\n  transform: translateY(1px);\n}\n.bell-btn.active {\n  border-color: var(--color-accent);\n  background: rgba(251, 188, 4, 0.18);\n  color: var(--color-accent);\n}\n.bell-btn:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n.events-view {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n  overflow-y: auto;\n  padding-right: 4px;\n  scrollbar-width: thin;\n  scrollbar-color: var(--color-bit-gray) transparent;\n  max-height: 500px;\n}\n.events-section {\n  background: rgba(255, 255, 255, 0.04);\n  padding: 12px;\n  border-radius: 14px;\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n  border: 1px solid rgba(255, 255, 255, 0.08);\n  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);\n}\n.events-view::-webkit-scrollbar {\n  width: 6px;\n}\n.events-view::-webkit-scrollbar-track {\n  background: transparent;\n}\n.events-view::-webkit-scrollbar-thumb {\n  background-color: var(--color-bit-gray);\n  border-radius: 20px;\n}\n.events-section h4 {\n  margin: 0;\n  font-size: 14px;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n  color: #cfcfcf;\n}\n.event-card {\n  background: rgba(255, 255, 255, 0.06);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 14px;\n  padding: 12px;\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);\n}\n.event-card.clickable {\n  cursor: pointer;\n  transition:\n    border-color 0.2s ease,\n    background-color 0.2s ease,\n    transform 0.1s ease;\n}\n.event-card.clickable:hover {\n  border-color: rgba(252, 195, 36, 0.4);\n  background: rgba(255, 255, 255, 0.08);\n}\n.event-card.clickable:active {\n  transform: translateY(1px);\n}\n.event-card.past {\n  opacity: 0.85;\n}\n.event-card-header {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n.event-title {\n  margin: 0;\n  font-size: 18px;\n  font-weight: 800;\n  color: #fdfdfd;\n}\n.event-sub {\n  margin: 2px 0 0 0;\n  font-size: 13px;\n  color: #d6d6d6;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n.event-sub .inline-icon {\n  color: var(--color-accent);\n  font-size: 18px;\n  width: 18px;\n  height: 18px;\n  line-height: 18px;\n  flex-shrink: 0;\n}\n.event-stats {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 6px;\n  align-items: center;\n}\n.stat-pill {\n  border-color: rgba(255, 255, 255, 0.15);\n  background: rgba(255, 255, 255, 0.08);\n  color: #f5f5f5;\n  font-size: 12px;\n  padding: 7px 9px;\n  gap: 5px;\n  border-radius: 999px;\n  display: inline-flex;\n  align-items: center;\n}\n.stat-pill mat-icon {\n  font-size: 16px;\n  width: 16px;\n  height: 16px;\n  line-height: 16px;\n  color: var(--color-accent);\n  flex-shrink: 0;\n}\n.list-view {\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  overflow: hidden;\n}\n.list-header {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  margin-bottom: 16px;\n}\n.back-btn {\n  background: none;\n  border: none;\n  color: white;\n  cursor: pointer;\n  padding: 4px;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  width: 36px;\n  height: 36px;\n  line-height: 0;\n}\n.header-back-btn {\n  position: absolute;\n  left: 12px;\n  top: 50%;\n  transform: translateY(-50%);\n  z-index: 2;\n}\n.modal-header .close-btn {\n  position: absolute;\n  right: 0;\n  top: 50%;\n  transform: translateY(-50%);\n}\n.user-list {\n  flex: 1;\n  overflow-y: auto;\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n  padding-right: 4px;\n}\n.user-item {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 8px;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 8px;\n}\n.user-info {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  cursor: pointer;\n}\n.list-avatar,\n.list-avatar-placeholder {\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  object-fit: cover;\n}\n.list-avatar-placeholder {\n  background: #FFB800;\n  color: #1a1a1a;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-weight: bold;\n  font-size: 14px;\n}\n.list-username {\n  font-weight: 500;\n  font-size: 14px;\n}\n.small-btn {\n  padding: 6px 12px;\n  border-radius: 16px;\n  font-size: 12px;\n  font-weight: 600;\n  cursor: pointer;\n  border: none;\n}\n.small-btn.follow-btn {\n  background: #FFB800;\n  color: #1a1a1a;\n}\n.small-btn.unfollow-btn {\n  background: rgba(255, 255, 255, 0.1);\n  color: white;\n}\n.loading-spinner,\n.error-state,\n.empty-list {\n  text-align: center;\n  color: #888;\n  padding: 20px;\n}\n/*# sourceMappingURL=user-profile-modal.css.map */\n", "import { Component, EventEmitter, Input, Output, OnChanges, SimpleChanges } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MatIconModule } from '@angular/material/icon';\nimport { UserService } from '../../services/user-service/user-service';\nimport { ConfirmationService } from '../../services/confirmation.service';\nimport { User } from '../../models/user';\nimport { EventService } from '../../services/event.service';\nimport { Event } from '../../models/event';\nimport { ReportModalComponent } from '../report-modal/report-modal.component';\n\n@Component({\n    selector: 'app-user-profile-modal',\n    standalone: true,\n    imports: [CommonModule, MatIconModule, ReportModalComponent],\n    templateUrl: './user-profile-modal.html',\n    styleUrl: './user-profile-modal.css'\n})\nexport class UserProfileModalComponent implements OnChanges {\n    @Input() userId: string | null = null;\n    @Input() currentUserId: string | null = null;\n    @Output() close = new EventEmitter<void>();\n    @Output() openProfile = new EventEmitter<string>();\n    @Output() focusEvent = new EventEmitter<Event>();\n\n    user: User | null = null;\n    isFollowing: boolean = false;\n    loading: boolean = false;\n    notificationsEnabled: boolean = false;\n    notificationsLoading: boolean = false;\n\n    view: 'profile' | 'followers' | 'following' | 'events' = 'profile';\n    userList: User[] = [];\n    loadingList: boolean = false;\n    myFollowingIds: Set<string> = new Set();\n    loadingEvents: boolean = false;\n    upcomingEvents: Event[] = [];\n    pastEvents: Event[] = [];\n    showReportModal = false;\n\n    constructor(\n        private userService: UserService,\n        private eventService: EventService,\n        private confirmation: ConfirmationService\n    ) { }\n\n    ngOnChanges(changes: SimpleChanges): void {\n        if (changes['userId'] && this.userId) {\n            this.loadUser();\n            this.checkIfFollowing();\n        }\n    }\n\n    onClose() {\n        if (this.view !== 'profile') {\n            this.view = 'profile';\n        } else {\n            this.close.emit();\n        }\n    }\n\n    getViewTitle(): string {\n        switch (this.view) {\n            case 'followers': return 'Followers';\n            case 'following': return 'Following';\n            case 'events': return 'Events';\n            default: return 'Profile';\n        }\n    }\n\n    loadUser() {\n        if (!this.userId) return;\n        this.loading = true;\n        this.userService.getUserById(this.userId).subscribe({\n            next: (u) => {\n                this.user = u;\n                this.loading = false;\n            },\n            error: (err) => {\n                console.error('Error loading user profile', err);\n                this.loading = false;\n            }\n        });\n    }\n\n    checkIfFollowing() {\n        if (!this.userId || !this.currentUserId) return;\n        this.userService.isFollowing(this.currentUserId, this.userId).subscribe({\n            next: (res) => {\n                this.isFollowing = res.isFollowing;\n                if (this.isFollowing) {\n                    this.loadNotificationPreference();\n                } else {\n                    this.notificationsEnabled = false;\n                }\n            },\n            error: (err) => console.error(err)\n        });\n    }\n\n    async toggleFollow() {\n        if (!this.userId || !this.currentUserId) return;\n\n        if (this.isFollowing) {\n            const confirmed = await this.confirmation.confirm({\n                title: 'Unfollow user',\n                message: 'Are you sure you want to unfollow this user?',\n                confirmText: 'Unfollow',\n                cancelText: 'Cancel',\n                confirmClass: 'white-text'\n            });\n            if (!confirmed) return;\n\n            this.userService.unfollowUser(this.currentUserId, this.userId).subscribe({\n                next: () => {\n                    this.isFollowing = false;\n                    if (this.user) {\n                        this.user.followersCount = (this.user.followersCount || 1) - 1;\n                    }\n                    this.userService.notifyUserUpdate();\n                },\n                error: (err) => console.error(err)\n            });\n        } else {\n            this.userService.followUser(this.currentUserId, this.userId).subscribe({\n                next: () => {\n                    this.isFollowing = true;\n                    this.notificationsEnabled = true;\n                    if (this.user) {\n                        this.user.followersCount = (this.user.followersCount || 0) + 1;\n                    }\n                    this.userService.notifyUserUpdate();\n                },\n                error: (err) => console.error(err)\n            });\n        }\n    }\n\n    getInitials(name: string): string {\n        if (!name) return '';\n        return name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);\n    }\n\n    showFollowers() {\n        if (!this.userId) return;\n        this.view = 'followers';\n        this.loadingList = true;\n\n        this.userService.getFollowers(this.userId).subscribe({\n            next: (followers) => {\n                this.userList = followers;\n                this.fetchMyFollowing();\n            },\n            error: (err) => {\n                console.error(err);\n                this.loadingList = false;\n            }\n        });\n    }\n\n    showFollowing() {\n        if (!this.userId) return;\n        this.view = 'following';\n        this.loadingList = true;\n        this.userService.getFollowing(this.userId).subscribe({\n            next: (following) => {\n                this.userList = following;\n                this.fetchMyFollowing();\n            },\n            error: (err) => {\n                console.error(err);\n                this.loadingList = false;\n            }\n        });\n    }\n\n    fetchMyFollowing() {\n        if (!this.currentUserId) {\n            this.loadingList = false;\n            return;\n        }\n        this.userService.getFollowing(this.currentUserId).subscribe({\n            next: (following) => {\n                this.myFollowingIds = new Set(following.map(u => u.id.toString()));\n                this.loadingList = false;\n            },\n            error: (err) => {\n                console.error(err);\n                this.loadingList = false;\n            }\n        });\n    }\n\n    onListFollow(targetUser: User) {\n        if (!this.currentUserId) return;\n        this.userService.followUser(this.currentUserId, targetUser.id.toString()).subscribe({\n            next: () => {\n                this.myFollowingIds.add(targetUser.id.toString());\n                this.userService.notifyUserUpdate();\n            },\n            error: (err) => console.error(err)\n        });\n    }\n\n    onOpenProfileFromList(targetUser: User) {\n        if (!targetUser?.id) return;\n        this.view = 'profile';\n        this.openProfile.emit(targetUser.id.toString());\n    }\n\n    async onListUnfollow(targetUser: User) {\n        if (!this.currentUserId) return;\n        const confirmed = await this.confirmation.confirm({\n            title: 'Unfollow user',\n            message: `Are you sure you want to unfollow ${targetUser.name}?`,\n            confirmText: 'Unfollow',\n            cancelText: 'Cancel',\n            confirmClass: 'white-text'\n        });\n        if (!confirmed) return;\n\n        this.userService.unfollowUser(this.currentUserId, targetUser.id.toString()).subscribe({\n            next: () => {\n                this.myFollowingIds.delete(targetUser.id.toString());\n                this.userService.notifyUserUpdate();\n            },\n            error: (err) => console.error(err)\n        });\n    }\n\n    showEvents() {\n        if (!this.userId) return;\n        this.view = 'events';\n        if (this.upcomingEvents.length || this.pastEvents.length || this.loadingEvents) {\n            return;\n        }\n        this.loadingEvents = true;\n        this.eventService.getOrganizedEvents(this.userId).subscribe({\n            next: (events) => {\n                const now = new Date();\n                this.upcomingEvents = [];\n                this.pastEvents = [];\n                events.forEach(ev => {\n                    const eventDate = new Date(`${ev.date}T${ev.endTime || ev.startTime || '00:00'}`);\n                    if (eventDate.getTime() >= now.getTime()) {\n                        this.upcomingEvents.push(ev);\n                    } else {\n                        this.pastEvents.push(ev);\n                    }\n                });\n                this.upcomingEvents.sort((a, b) => new Date(`${a.date}T${a.startTime || '00:00'}`).getTime() - new Date(`${b.date}T${b.startTime || '00:00'}`).getTime());\n                this.pastEvents.sort((a, b) => new Date(`${b.date}T${b.startTime || '00:00'}`).getTime() - new Date(`${a.date}T${a.startTime || '00:00'}`).getTime());\n                this.loadingEvents = false;\n            },\n            error: (err) => {\n                console.error('Error loading events by user', err);\n                this.loadingEvents = false;\n            }\n        });\n    }\n\n    focusEventOnMap(event: Event) {\n        this.focusEvent.emit(event);\n    }\n\n    formatEventDate(ev: Event): string {\n        const date = ev.date ? new Date(`${ev.date}T00:00:00`) : null;\n        const start = ev.startTime ? ev.startTime.slice(0, 5) : '';\n        const end = ev.endTime ? ev.endTime.slice(0, 5) : '';\n        const datePart = date ? date.toLocaleDateString('en-US', { day: '2-digit', month: 'short' }) : '';\n        const timePart = start && end ? `${start} - ${end}` : start || end;\n        return [datePart, timePart].filter(Boolean).join('  ');\n    }\n\n    eventStats(ev: Event): { participants: string; freeSpots?: string; cost: string } {\n        const occupied = ev.occupiedSpots ?? 0;\n        const max = ev.nPartecipants ?? null;\n        let participants = `${occupied}${max ? `/${max}` : ''}`;\n        let freeSpots: string | undefined;\n        if (max != null) {\n            freeSpots = Math.max(max - occupied, 0).toString();\n        }\n        const cost = ev.costPerPerson == null || ev.costPerPerson === 0\n            ? 'Free'\n            : ev.costPerPerson.toString();\n        return { participants, freeSpots, cost };\n    }\n\n    toggleNotifications(event?: MouseEvent) {\n        event?.stopPropagation();\n        if (!this.currentUserId || !this.userId || !this.isFollowing) return;\n\n        const nextValue = !this.notificationsEnabled;\n        this.notificationsLoading = true;\n        this.userService.setFollowNotifications(this.currentUserId, this.userId, nextValue).subscribe({\n            next: (res) => {\n                this.notificationsEnabled = res.enabled;\n                this.notificationsLoading = false;\n            },\n            error: (err) => {\n                console.error('Error updating follow notifications', err);\n                this.notificationsLoading = false;\n            }\n        });\n    }\n\n    openReportModal() {\n        if (!this.user || !this.currentUserId) return;\n        if (this.user.id.toString() === this.currentUserId) return;\n        this.showReportModal = true;\n    }\n\n    closeReportModal() {\n        this.showReportModal = false;\n    }\n\n    private loadNotificationPreference() {\n        if (!this.currentUserId || !this.userId) return;\n        this.notificationsLoading = true;\n        this.userService.getFollowNotifications(this.currentUserId, this.userId).subscribe({\n            next: (res) => {\n                this.notificationsEnabled = !!res.enabled;\n                this.notificationsLoading = false;\n            },\n            error: (err) => {\n                console.error('Error loading follow notification preference', err);\n                this.notificationsEnabled = false;\n                this.notificationsLoading = false;\n            }\n        });\n    }\n}\n", "import { AfterViewInit, Component, OnInit, ViewChild } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { HttpClient } from '@angular/common/http';\nimport { AuthService } from '../../../services/auth.service';\nimport { MapView } from '../../../components/map-view/map-view';\nimport { SignUpPopup } from '../../../components/sign-up-popup/sign-up-popup';\nimport { SignInPopup } from '../../../components/sign-in-popup/sign-in-popup';\nimport { VerifyEmailPopup } from '../../../components/verify-email-popup/verify-email-popup';\n\nimport { ActionBarComponent } from '../../../components/action-bar/action-bar';\nimport { CropImagePopup } from '../../../components/crop-image-popup/crop-image-popup';\nimport { CreateEventPopup } from '../../../components/create-event-popup/create-event-popup';\nimport { EventPopupCard } from '../../../components/event-popup-card/event-popup-card';\nimport { EventChatModalComponent } from '../../../components/event-chat-modal/event-chat-modal';\nimport { MapLocationSelector } from '../../../components/map-location-selector/map-location-selector';\nimport { UserProfileModalComponent } from '../../../components/user-profile-modal/user-profile-modal.component';\nimport { Event as LumoEvent } from '../../../models/event';\nimport { EventService } from '../../../services/event.service';\nimport { UserService } from '../../../services/user-service/user-service';\nimport { ConfirmationService } from '../../../services/confirmation.service';\n\n@Component({\n  selector: 'Home',\n  standalone: true,\n  imports: [MapView, SignUpPopup, SignInPopup, VerifyEmailPopup, ActionBarComponent, CropImagePopup, CreateEventPopup, EventPopupCard, MapLocationSelector, UserProfileModalComponent, EventChatModalComponent],\n  templateUrl: './home.html',\n  styleUrl: './home.css',\n})\nexport class Home implements OnInit, AfterViewInit {\n\n  @ViewChild(MapView) mapView!: MapView;\n\n  showSignUp = false;\n  showSignIn = false;\n  showVerifyPopup = false;\n\n  showCropPopup = false;\n  selectedImageFile: File | null = null;\n\n  showCreateEventPopup = false;\n  showChatModal = false;\n  showLocationSelector = false;\n  selectedEvent: LumoEvent | null = null;\n  chatEvent: LumoEvent | null = null;\n  private previousSelectedEvent: LumoEvent | null = null;\n  eventScreenPosition: { x: number, y: number } | null = null;\n\n  showUserProfile = false;\n  selectedUserProfileId: string | null = null;\n\n  loggedUser: { id: string; name: string; email: string; profileImage?: string; isAdmin?: boolean } | null = null;\n\n  recentEmail = '';\n  recentToken = '';\n\n  emailVerified = false;\n  private pendingSharedEventId: number | null = null;\n  private sharedEventRetryCount = 0;\n  private sharedEventLoading = false;\n\n  constructor(\n    private route: ActivatedRoute,\n    private router: Router,\n    private authService: AuthService,\n    private http: HttpClient,\n    private eventService: EventService,\n    private userService: UserService,\n    private confirmation: ConfirmationService\n  ) { }\n\n  ngOnInit() {\n    this.refreshLocalUser();\n    this.checkAdminRedirect();\n\n    this.userService.userUpdates$.subscribe(() => {\n      this.refreshUserFromBackend();\n    });\n\n    this.route.queryParams.subscribe(params => {\n      const token = params['token'];\n      const email = params['email'];\n      const userId = params['user'];\n      const eventId = params['event'];\n\n      if (userId) {\n        this.openUserProfile(userId);\n\n        this.router.navigate([], {\n          relativeTo: this.route,\n          queryParams: { user: null },\n          queryParamsHandling: 'merge',\n          replaceUrl: true\n        });\n      }\n\n      if (eventId) {\n        const parsed = Number(eventId);\n        if (!Number.isNaN(parsed)) {\n          this.pendingSharedEventId = parsed;\n          this.loadSharedEvent();\n        }\n\n        this.router.navigate([], {\n          relativeTo: this.route,\n          queryParams: { event: null },\n          queryParamsHandling: 'merge',\n          replaceUrl: true\n        });\n      }\n\n      if (token) {\n        this.recentToken = token;\n        this.recentEmail = email || '';\n\n        this.openVerifyPopup();\n\n        this.authService.verifyEmail(token).subscribe({\n          next: (res) => {\n            this.emailVerified = true;\n          },\n          error: () => this.emailVerified = false\n        });\n      }\n    });\n  }\n\n  ngAfterViewInit() {\n    this.loadSharedEvent();\n  }\n\n  checkAdminRedirect() {\n    if (this.loggedUser && this.loggedUser.isAdmin) {\n      this.router.navigate(['/admin']);\n    }\n  }\n\n  refreshLocalUser() {\n    const storedUser = localStorage.getItem('user');\n    if (storedUser) {\n      try {\n        this.loggedUser = JSON.parse(storedUser);\n      } catch (e) {\n        console.error('Error parsing local user', e);\n        localStorage.removeItem('user');\n      }\n    }\n  }\n\n  refreshUserFromBackend() {\n    if (!this.loggedUser) return;\n\n    this.userService.getUserById(this.loggedUser.id).subscribe({\n      next: (user) => {\n        this.loggedUser = {\n          id: user.id || '',\n          name: user.name || user.email || 'User',\n          email: user.email || '',\n          description: user.description,\n          profileImage: (user as any).profileImage,\n          followersCount: user.followersCount,\n          followingCount: user.followingCount,\n          isAdmin: user.isAdmin\n        } as any;\n\n        if (this.loggedUser?.isAdmin) {\n          this.router.navigate(['/admin']);\n          return;\n        }\n\n        localStorage.setItem('user', JSON.stringify(this.loggedUser));\n        console.log('User refreshed:', this.loggedUser);\n      },\n      error: (err) => console.error('Error refreshing user', err)\n    });\n  }\n\n  private loadSharedEvent() {\n    if (!this.pendingSharedEventId || this.sharedEventLoading) return;\n\n    const eventId = this.pendingSharedEventId;\n    const currentUserId = this.loggedUser ? this.loggedUser.id : undefined;\n\n    this.sharedEventLoading = true;\n    this.eventService.getEventById(eventId, currentUserId).subscribe({\n      next: (event) => {\n        this.sharedEventLoading = false;\n        this.openSharedEventOnMap(event);\n      },\n      error: (err) => {\n        this.sharedEventLoading = false;\n        this.pendingSharedEventId = null;\n        console.error('Error loading shared event', err);\n      }\n    });\n  }\n\n  private openSharedEventOnMap(event: LumoEvent) {\n    if (!this.mapView?.map) {\n      if (this.sharedEventRetryCount < 12) {\n        this.sharedEventRetryCount += 1;\n        setTimeout(() => this.openSharedEventOnMap(event), 250);\n      }\n      return;\n    }\n\n    this.sharedEventRetryCount = 0;\n    this.pendingSharedEventId = null;\n    this.mapView.flyToEvent(event);\n  }\n\n\n  openVerifyPopup(email?: string, token?: string) {\n    if (email !== undefined) this.recentEmail = email;\n    if (token !== undefined) this.recentToken = token;\n\n    this.closeAll();\n    this.showVerifyPopup = true;\n  }\n\n  resendEmail() {\n    if (!this.recentToken && !this.recentEmail) {\n      return;\n    }\n\n    this.authService.resendEmail({ oldToken: this.recentToken, email: this.recentEmail }).subscribe({\n      next: (res) => {\n        if (res?.data?.token) {\n          this.recentToken = res.data.token;\n        }\n        this.emailVerified = false;\n      },\n      error: (err) => {\n        console.error('Error resending verification email', err);\n      }\n    });\n  }\n\n  openSignUp() {\n    this.closeAll();\n    this.showSignUp = true;\n  }\n\n  openSignIn() {\n    this.closeAll();\n    this.showSignIn = true;\n  }\n\n  closeAll() {\n    this.showSignUp = false;\n    this.showSignIn = false;\n    this.showVerifyPopup = false;\n    this.showCropPopup = false;\n    this.showCreateEventPopup = false;\n    this.showChatModal = false;\n    this.chatEvent = null;\n    this.previousSelectedEvent = null;\n    this.showLocationSelector = false;\n    this.closeEventPopup();\n    if (this.mapView) this.mapView.managedPopupType = null;\n    this.showUserProfile = false;\n    this.selectedUserProfileId = null;\n  }\n\n  openUserProfile(userId: string) {\n    console.log('[Home] openUserProfile', userId);\n    this.closeAll();\n    this.selectedUserProfileId = userId;\n    this.showUserProfile = true;\n  }\n\n  openEventPopup(event: LumoEvent) {\n    this.selectedEvent = event;\n\n    this.updateCardPosition();\n\n    if (this.mapView && this.mapView.map) {\n      this.mapView.map.off('move', this.updateCardPosition.bind(this));\n      this.mapView.map.on('move', this.updateCardPosition.bind(this));\n\n      this.mapView.map.off('click', this.onMapClick.bind(this));\n      this.mapView.map.on('click', this.onMapClick.bind(this));\n    }\n\n    const currentUserId = this.loggedUser ? this.loggedUser.id : undefined;\n\n    this.eventService.getEventById(event.id, currentUserId).subscribe({\n      next: (freshEvent) => {\n        this.selectedEvent = freshEvent;\n        this.updateCardPosition();\n      },\n      error: (err) => console.error('Error fetching fresh event data', err)\n    });\n\n    setTimeout(() => {\n      document.addEventListener('click', this.onDocumentClick);\n    }, 0);\n  }\n\n  openChat(event: LumoEvent) {\n    if (!this.loggedUser) {\n      this.openSignIn();\n      return;\n    }\n    if (this.selectedEvent) {\n      this.previousSelectedEvent = this.selectedEvent;\n      this.closeEventPopup();\n    }\n    this.chatEvent = event;\n    this.showChatModal = true;\n  }\n\n  onChatNotification(eventId: number) {\n    if (!this.loggedUser) {\n      this.openSignIn();\n      return;\n    }\n    this.eventService.getEventById(eventId, this.loggedUser.id).subscribe({\n      next: (event) => {\n        this.closeAll();\n        this.openChat(event);\n      },\n      error: (err) => console.error('Error opening chat from notification', err)\n    });\n  }\n\n  onUpcomingEventNotification(eventId: number) {\n    const currentUserId = this.loggedUser ? this.loggedUser.id : undefined;\n    this.eventService.getEventById(eventId, currentUserId).subscribe({\n      next: (event) => {\n        this.closeAll();\n        if (this.mapView) {\n          this.mapView.flyToEvent(event);\n        }\n      },\n      error: (err) => console.error('Error opening event from notification', err)\n    });\n  }\n\n  closeChat() {\n    this.showChatModal = false;\n    this.chatEvent = null;\n    if (this.previousSelectedEvent) {\n      const eventToRestore = this.previousSelectedEvent;\n      this.previousSelectedEvent = null;\n      this.openEventPopup(eventToRestore);\n    }\n  }\n\n  onEventsUpdated(newEvents: LumoEvent[]) {\n    if (this.selectedEvent) {\n      const updatedEvent = newEvents.find(e => e.id === this.selectedEvent!.id);\n      if (updatedEvent) {\n        this.selectedEvent = updatedEvent;\n      }\n    }\n  }\n\n  updateCardPosition() {\n    if (this.selectedEvent && this.mapView) {\n      this.eventScreenPosition = this.mapView.getEventScreenPosition(this.selectedEvent);\n    }\n  }\n\n  onMapClick(e: any) {\n    if (e.defaultPrevented) return;\n    this.closeEventPopup();\n  }\n\n  onDocumentClick = (event: MouseEvent) => {\n    this.closeEventPopup();\n  }\n\n  closeEventPopup() {\n    this.selectedEvent = null;\n    this.eventScreenPosition = null;\n\n    if (this.mapView && this.mapView.map) {\n      this.mapView.map.off('move', this.updateCardPosition.bind(this));\n      this.mapView.map.off('click', this.onMapClick.bind(this));\n    }\n\n    document.removeEventListener('click', this.onDocumentClick);\n  }\n\n  onParticipate(event: LumoEvent) {\n    console.log('onParticipate called for event:', event.id);\n    if (!this.loggedUser) {\n      console.log('User not logged in, opening sign in');\n      this.openSignIn();\n      return;\n    }\n\n    console.log('Sending request for user:', this.loggedUser.id, 'event:', event.id);\n    this.eventService.requestParticipation(event.id, this.loggedUser.id).subscribe({\n      next: () => {\n        console.log('Request success');\n        if (this.selectedEvent && this.selectedEvent.id === event.id) {\n          console.log('Updating local state to PENDING');\n          this.selectedEvent.participationStatus = 'PENDING';\n        }\n      },\n      error: (err) => console.error('Error requesting participation', err)\n    });\n  }\n\n  async onLeaveEvent(event: LumoEvent) {\n    if (!this.loggedUser) {\n      this.openSignIn();\n      return;\n    }\n\n    const confirmed = await this.confirmation.confirm({\n      title: 'Leave event',\n      message: 'Are you sure you want to leave the event?',\n      confirmText: 'Leave',\n      cancelText: 'Cancel'\n    });\n    if (!confirmed) return;\n\n    this.eventService.leaveEvent(event.id, this.loggedUser.id).subscribe({\n      next: () => {\n        if (this.selectedEvent && this.selectedEvent.id === event.id) {\n          this.selectedEvent.participationStatus = 'NONE';\n          this.selectedEvent.isParticipating = false;\n          if (typeof this.selectedEvent.occupiedSpots === 'number' && this.selectedEvent.occupiedSpots > 0) {\n            this.selectedEvent.occupiedSpots -= 1;\n          }\n        }\n\n        if (this.mapView) {\n          const target = this.mapView.events.find(e => e.id === event.id);\n          if (target) {\n            target.participationStatus = 'NONE';\n            target.isParticipating = false;\n            if (typeof target.occupiedSpots === 'number' && target.occupiedSpots > 0) {\n              target.occupiedSpots -= 1;\n            }\n          }\n        }\n      },\n      error: (err) => console.error('Error leaving event', err)\n    });\n  }\n\n  async onDeleteEvent(event: LumoEvent) {\n    if (!this.loggedUser) {\n      this.openSignIn();\n      return;\n    }\n\n    if (event.creatorId && event.creatorId.toString() !== this.loggedUser.id.toString()) {\n      console.warn('You are not the eventer of this event');\n      return;\n    }\n\n    const confirmed = await this.confirmation.confirm({\n      title: 'Delete event',\n      message: 'Are you sure you want to delete this event? This action cannot be undone.',\n      confirmText: 'Delete',\n      cancelText: 'Cancel',\n      tone: 'danger'\n    });\n    if (!confirmed) return;\n\n    this.eventService.deleteEvent(event.id).subscribe({\n      next: () => {\n        if (this.mapView) {\n          this.mapView.events = this.mapView.events.filter(e => e.id !== event.id);\n          this.mapView.loadEvents?.();\n        }\n        this.closeEventPopup();\n      },\n      error: (err) => console.error('Error deleting event', err)\n    });\n  }\n\n  onToggleFavorite() {\n    if (this.selectedEvent && this.mapView) {\n      this.mapView.onToggleFavorite(this.selectedEvent);\n    }\n  }\n\n  openShare(event: LumoEvent) {\n    if (!this.mapView) return;\n    this.mapView.openShare(event);\n  }\n\n  createEventPopupRef: any = null;\n\n  openLocationSelector() {\n    this.showLocationSelector = true;\n  }\n\n  onLocationSelected(location: { lat: number, lng: number }) {\n    if (this.createEventPopupRef) {\n      this.createEventPopupRef.setLocation(location.lat, location.lng);\n    }\n    this.showLocationSelector = false;\n  }\n\n  switchToSignUp() {\n    this.openSignUp();\n  }\n\n  switchToSignIn() {\n    this.openSignIn();\n  }\n\n  onSignInSuccess(user: { id: string; name: string; email: string; profileImage?: string }) {\n    console.log('User received on sign in:', user);\n    this.loggedUser = {\n      id: user?.id || '',\n      name: user?.name || user?.email || 'User',\n      email: user?.email || '',\n      profileImage: (user as any).profileImage,\n      isAdmin: (user as any).isAdmin\n    };\n\n    if (this.loggedUser.isAdmin) {\n      this.router.navigate(['/admin']);\n      return;\n    }\n\n    this.refreshUserFromBackend();\n\n    this.closeAll();\n  }\n\n  logout() {\n    this.loggedUser = null;\n    localStorage.removeItem('user');\n    this.closeAll();\n  }\n\n  onMenuAction(action: string) {\n    console.log('Menu action:', action);\n    if (action === 'logout') {\n      this.logout();\n    } else if (action === 'change-photo') {\n      const fileInput = document.getElementById('hiddenFileInput') as HTMLInputElement;\n      if (fileInput) {\n        fileInput.click();\n      }\n    } else if (action === 'account') {\n      console.log('Navigate to Account');\n    } else if (action === 'events') {\n      console.log('Navigate to Events');\n    } else if (action === 'add-event') {\n      console.log('Create Event clicked');\n      this.showCreateEventPopup = true;\n    }\n  }\n\n  onFileSelected(event: any) {\n    const file: File = event.target.files[0];\n    if (file) {\n      this.selectedImageFile = file;\n      this.showCropPopup = true;\n      event.target.value = '';\n    }\n  }\n\n  onImageCropped(blob: Blob) {\n    if (this.loggedUser) {\n      const formData = new FormData();\n      formData.append('file', blob, 'profile.jpg');\n\n      this.http.post<any>(`http://localhost:8080/api/users/${this.loggedUser.id}/image`, formData).subscribe({\n        next: (res) => {\n          if (this.loggedUser) {\n            // Aggiungiamo un timestamp per evitare il caching del browser\n            this.loggedUser.profileImage = res.imageUrl + '?t=' + new Date().getTime();\n            localStorage.setItem('user', JSON.stringify(this.loggedUser));\n            this.closeAll();\n          }\n        },\n        error: (err) => console.error('Error uploading image', err)\n      });\n    }\n  }\n\n  onFocusEventFromMenu(event: LumoEvent) {\n    if (this.mapView) {\n      this.mapView.flyToEvent(event);\n    }\n  }\n\n  onFocusEventFromProfile(event: LumoEvent) {\n    this.closeAll();\n    if (this.mapView) {\n      this.mapView.flyToEvent(event);\n    }\n  }\n}\n", "import { ComponentFixture, TestBed } from '@angular/core/testing';\n\nimport { Home } from './home';\n\ndescribe('Home', () => {\n  let component: Home;\n  let fixture: ComponentFixture<Home>;\n\n  beforeEach(async () => {\n    await TestBed.configureTestingModule({\n      imports: [Home]\n    })\n    .compileComponents();\n\n    fixture = TestBed.createComponent(Home);\n    component = fixture.componentInstance;\n    fixture.detectChanges();\n  });\n\n  it('should create', () => {\n    expect(component).toBeTruthy();\n  });\n});\n"],
  "mappings": "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",
  "names": ["home_default", "init_home", "action_bar_default", "init_action_bar", "user_menu_default", "init_user_menu", "UserMenu", "notification_menu_default", "init_notification_menu", "NotificationService", "NotificationMenuComponent", "my_events_modal_default", "init_my_events_modal", "event_chat_modal_default", "init_event_chat_modal", "ChatService", "EventChatModalComponent", "init_event_chat_modal", "MyEventsModal", "account_modal_default", "init_account_modal", "AccountModalComponent", "init_user_menu", "init_notification_menu", "ActionBarComponent", "crop_image_popup_default", "init_crop_image_popup", "CropImagePopup", "create_event_popup_default", "init_create_event_popup", "CreateEventPopup", "event_popup_card_default", "init_event_popup_card", "report_modal_component_default", "init_report_modal_component", "ReportService", "ReportModalComponent", "init_report_modal_component", "EventPopupCard", "map_location_selector_default", "init_map_location_selector", "MapLocationSelector", "user_profile_modal_default", "init_user_profile_modal", "init_report_modal_component", "UserProfileModalComponent", "init_action_bar", "init_crop_image_popup", "init_create_event_popup", "init_event_popup_card", "init_event_chat_modal", "init_map_location_selector", "Home", "init_home"]
}
