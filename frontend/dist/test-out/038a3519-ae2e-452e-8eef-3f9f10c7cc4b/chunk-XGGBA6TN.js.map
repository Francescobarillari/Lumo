{
  "version": 3,
  "sources": ["src/validators/validators.ts", "src/services/google-identity.service.ts"],
  "sourcesContent": ["import { AbstractControl, ValidationErrors } from '@angular/forms';\nexport function onlyLettersValidator(control: AbstractControl): ValidationErrors | null {\n  const value = control.value?.trim();\n  return /^[A-Za-zÀ-ÖØ-öø-ÿ\\s]+$/.test(value) ? null : { onlyLetters: true };\n}\n\nexport function adultValidator(control: AbstractControl) {\n  const value = control.value; // formato atteso: YYYY-MM-DD\n  if (!value) return { adult: true };\n\n  const birthDate = new Date(value);\n  const today = new Date();\n  const age = today.getFullYear() - birthDate.getFullYear();\n  if (age < 18) return { adult: true };\n  return null;\n}\n\n\nexport function emailFormatValidator(control: AbstractControl): ValidationErrors | null {\n  const value = control.value?.trim();\n  const regex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  return regex.test(value) ? null : { emailInvalid: true };\n}\n\nexport function strongPasswordValidator(control: AbstractControl): ValidationErrors | null {\n  const value = control.value;\n  const regex = /^(?=.*[A-Z])(?=.*\\d)(?=.*[\\W_]).{8,}$/;\n  return regex.test(value) ? null : { weakPassword: true };\n}\n", "import { Injectable } from '@angular/core';\nimport { Environment } from '../environment/environment';\n\ndeclare const google: any;\n\n@Injectable({ providedIn: 'root' })\nexport class GoogleIdentityService {\n  private scriptLoadingPromise: Promise<void> | null = null;\n\n  private loadScript(): Promise<void> {\n    if (this.scriptLoadingPromise) return this.scriptLoadingPromise;\n\n    this.scriptLoadingPromise = new Promise((resolve, reject) => {\n      if (document.getElementById('google-identity')) {\n        resolve();\n        return;\n      }\n\n      const script = document.createElement('script');\n      script.id = 'google-identity';\n      script.src = 'https://accounts.google.com/gsi/client';\n      script.async = true;\n      script.defer = true;\n      script.onload = () => resolve();\n      script.onerror = () => reject(new Error('Unable to load Google Identity Services'));\n      document.head.appendChild(script);\n    });\n\n    return this.scriptLoadingPromise;\n  }\n\n  async getAuthCode(): Promise<string> {\n    await this.loadScript();\n\n    if (!Environment.googleClientId) {\n        throw new Error('Configure the Google Client ID.');\n    }\n\n    const redirectUri = Environment.googleRedirectUri || window.location.origin;\n\n    return new Promise((resolve, reject) => {\n      const client = google.accounts.oauth2.initCodeClient({\n        client_id: Environment.googleClientId,\n        scope: 'openid email profile',\n        ux_mode: 'popup',\n        redirect_uri: redirectUri,\n        state: 'signin',\n        callback: (response: any) => {\n          if (response && response.code) {\n            resolve(response.code);\n          } else if (response && response.error) {\n            const err = new Error(response.error_description || response.error || 'Google sign-in cancelled.');\n            (err as any).code = response.error;\n            reject(err);\n          } else {\n            reject(new Error('Google sign-in cancelled.'));\n          }\n        }\n      });\n\n      client.requestCode();\n    });\n  }\n\n  async getIdToken(): Promise<string> {\n    await this.loadScript();\n\n    if (!Environment.googleClientId) {\n      throw new Error('Configure the Google Client ID.');\n    }\n\n    return new Promise((resolve, reject) => {\n      let handled = false;\n      const mapReason = (reason?: string) => {\n        const normalized = (reason || '').toLowerCase();\n        if (normalized.includes('invalid')) return { message: 'Configure the Google Client ID.', code: 'google_config' };\n        if (normalized.includes('missing')) return { message: 'Configure the Google Client ID.', code: 'google_config' };\n        if (normalized.includes('suppressed')) return { message: 'Google sign-in cancelled: Google suppressed the prompt (cookie).', code: 'google_cancelled' };\n        if (normalized.includes('user_cancel')) return { message: 'Google sign-in cancelled by the user.', code: 'google_cancelled' };\n        return { message: 'Google sign-in cancelled.', code: 'google_cancelled' };\n      };\n      const finish = (error?: { message: string; code?: string } | string, credential?: string) => {\n        if (handled) return;\n        handled = true;\n        if (credential) resolve(credential);\n        else {\n          const message = typeof error === 'string' ? error : error?.message;\n          const code = typeof error === 'string' ? undefined : error?.code;\n          const errObj: any = new Error(message || 'Google sign-in cancelled.');\n          if (code) errObj.code = code;\n          reject(errObj);\n        }\n      };\n\n      google.accounts.id.initialize({\n        client_id: Environment.googleClientId,\n        callback: (response: any) => {\n          if (response && response.credential) {\n            finish(undefined, response.credential);\n          } else {\n            finish({ message: 'Google sign-in cancelled.', code: 'google_cancelled' });\n          }\n        },\n        ux_mode: 'popup',\n        use_fedcm_for_prompt: true,\n        itp_support: true,\n        cancel_on_tap_outside: true,\n        auto_select: false\n      });\n\n      google.accounts.id.prompt((notification: any) => {\n        const notDisplayed = notification?.isNotDisplayed?.();\n        const skipped = notification?.isSkippedMoment?.();\n        if (notDisplayed || skipped) {\n          const reason =\n            notification?.getNotDisplayedReason?.() ||\n            notification?.getSkippedReason?.() ||\n            'Google sign-in cancelled.';\n          finish(mapReason(reason));\n        }\n      });\n    });\n  }\n}\n"],
  "mappings": "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",
  "names": ["GoogleIdentityService"]
}
